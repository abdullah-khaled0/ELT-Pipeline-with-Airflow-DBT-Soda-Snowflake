[0m12:29:03.548064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff802d233d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8030cd890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff804451710>]}


============================== 12:29:03.550687 | 97352a66-6c19-44f3-80c4-5aadec8c6b87 ==============================
[0m12:29:03.550687 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:29:03.552748 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt deps', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None'}
[0m12:29:03.677160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97352a66-6c19-44f3-80c4-5aadec8c6b87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff802b79310>]}
[0m12:29:03.681320 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w64gsygo'
[0m12:29:03.682700 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:29:04.047118 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:29:04.050674 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:29:04.259328 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:29:04.279629 [info ] [MainThread]: Updating lock file in file path: /usr/local/airflow/include/dbt/package-lock.yml
[0m12:29:04.289115 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8bobawsw'
[0m12:29:04.294551 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:29:07.593518 [info ] [MainThread]: Installed from version 1.1.1
[0m12:29:07.595000 [info ] [MainThread]: Up to date!
[0m12:29:07.596468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '97352a66-6c19-44f3-80c4-5aadec8c6b87', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff802b7ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff802b7a710>]}
[0m12:29:07.598436 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.111063, "process_user_time": 2.043776, "process_kernel_time": 0.257952, "process_mem_max_rss": "101104", "process_in_blocks": "17472", "process_out_blocks": "200"}
[0m12:29:07.599515 [debug] [MainThread]: Command `dbt deps` succeeded at 12:29:07.599338 after 4.11 seconds
[0m12:29:07.600410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80435a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8071a0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8070f71d0>]}
[0m12:29:07.601901 [debug] [MainThread]: Flushing usage events
[0m12:29:29.166341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4288759ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f428728f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f428728e5d0>]}


============================== 12:29:29.168831 | d8d3e725-47db-4c40-a4d7-01cb55347dd1 ==============================
[0m12:29:29.168831 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:29:29.171128 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m12:29:29.527271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d3e725-47db-4c40-a4d7-01cb55347dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42863eb990>]}
[0m12:29:29.611914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d3e725-47db-4c40-a4d7-01cb55347dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4288722590>]}
[0m12:29:29.613483 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:29:29.652277 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:29:29.663341 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:29:29.664761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8d3e725-47db-4c40-a4d7-01cb55347dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42863de0d0>]}
[0m12:29:29.741071 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading retail: sources/sources.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  | 
    7  |     tables:
    8  |       - name: raw_invoices
    9  | 			- name: country
    
    Raw Error:
    ------------------------------
    while scanning a plain scalar
      in "<unicode string>", line 8, column 15
    found a tab character that violates indentation
      in "<unicode string>", line 9, column 1
[0m12:29:29.743252 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6335385, "process_user_time": 2.248564, "process_kernel_time": 0.079948, "process_mem_max_rss": "117456", "process_in_blocks": "1704", "command_success": false, "process_out_blocks": "0"}
[0m12:29:29.745050 [debug] [MainThread]: Command `dbt run` failed at 12:29:29.744681 after 0.64 seconds
[0m12:29:29.746298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42872ef550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42872962d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f428b82f290>]}
[0m12:29:29.747408 [debug] [MainThread]: Flushing usage events
[0m12:30:31.310291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49738f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4976f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d498f1890>]}


============================== 12:30:31.312990 | b9321cd3-225b-4e07-a8c8-f90da87e4878 ==============================
[0m12:30:31.312990 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:30:31.315189 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m12:30:31.625938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d486b4650>]}
[0m12:30:31.709969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4975d990>]}
[0m12:30:31.711424 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:30:31.757672 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:30:31.768350 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:30:31.769640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a3ebf50>]}
[0m12:30:34.093044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4828f590>]}
[0m12:30:34.138614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d469fc5d0>]}
[0m12:30:34.141326 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m12:30:34.143332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49737a10>]}
[0m12:30:34.147829 [info ] [MainThread]: 
[0m12:30:34.150415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:30:34.154180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m12:30:34.173803 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m12:30:34.175449 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m12:30:34.177030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:36.471394 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m12:30:36.474200 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m12:30:36.653993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m12:30:36.664000 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m12:30:36.665358 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m12:30:36.666695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:37.333230 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:30:37.337291 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m12:30:37.512623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d48352010>]}
[0m12:30:37.514395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:37.515950 [info ] [MainThread]: 
[0m12:30:37.522383 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m12:30:37.523805 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m12:30:37.525975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m12:30:37.528019 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m12:30:37.542507 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m12:30:37.568917 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 12:30:37.529258 => 12:30:37.568496
[0m12:30:37.570232 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m12:30:37.605286 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m12:30:37.633963 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m12:30:37.635547 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM snowflake_default.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN snowflake_default.retail.country cm ON t.country = cm.nicename
        );
[0m12:30:37.637074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:38.146663 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e8e-0000-000f-0000-00000f492851
[0m12:30:38.149104 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
[0m12:30:38.151187 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 12:30:37.571313 => 12:30:38.150764
[0m12:30:38.152984 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m12:30:38.323964 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m12:30:38.325581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d44746b90>]}
[0m12:30:38.327254 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.80s]
[0m12:30:38.329317 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m12:30:38.330751 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:30:38.332671 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m12:30:38.334755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m12:30:38.336506 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:30:38.342767 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:30:38.355338 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:30:38.337918 => 12:30:38.354859
[0m12:30:38.357527 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:30:38.362095 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:30:38.375204 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m12:30:38.376776 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM snowflake_default.retail.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m12:30:38.378454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:38.862690 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e8e-0000-000a-0000-00000f493881
[0m12:30:38.864388 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m12:30:38.866050 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:30:38.358631 => 12:30:38.865722
[0m12:30:38.867481 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m12:30:39.052244 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:30:39.055886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d46936f90>]}
[0m12:30:39.059143 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.72s]
[0m12:30:39.062247 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:30:39.064658 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m12:30:39.066818 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m12:30:39.069260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m12:30:39.071249 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m12:30:39.082332 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m12:30:39.096954 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 12:30:39.073063 => 12:30:39.096457
[0m12:30:39.098326 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m12:30:39.103805 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m12:30:39.120979 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m12:30:39.123173 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM snowflake_default.retail.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m12:30:39.124754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:39.634713 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e8e-0000-000a-0000-00000f493885
[0m12:30:39.636375 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
[0m12:30:39.637970 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 12:30:39.099649 => 12:30:39.637674
[0m12:30:39.639365 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m12:30:39.814485 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m12:30:39.815907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9321cd3-225b-4e07-a8c8-f90da87e4878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d487c6910>]}
[0m12:30:39.817349 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.75s]
[0m12:30:39.819587 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m12:30:39.821601 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m12:30:39.822896 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m12:30:39.824920 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m12:30:39.829802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:39.831955 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m12:30:39.833227 [info ] [MainThread]: 
[0m12:30:39.834651 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m12:30:39.837759 [debug] [MainThread]: Command end result
[0m12:30:39.869866 [info ] [MainThread]: 
[0m12:30:39.871368 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:30:39.872819 [info ] [MainThread]: 
[0m12:30:39.874131 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m12:30:39.875400 [info ] [MainThread]: 
[0m12:30:39.876608 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:30:39.878102 [info ] [MainThread]: 
[0m12:30:39.879623 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m12:30:39.880922 [info ] [MainThread]: 
[0m12:30:39.882243 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:30:39.884191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.632701, "process_user_time": 4.507243, "process_kernel_time": 0.197253, "process_mem_max_rss": "134708", "process_in_blocks": "1128", "process_out_blocks": "872", "command_success": false}
[0m12:30:39.885757 [debug] [MainThread]: Command `dbt run` failed at 12:30:39.885559 after 8.63 seconds
[0m12:30:39.887272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d497378d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d4a3ebc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d49bd06d0>]}
[0m12:30:39.888757 [debug] [MainThread]: Flushing usage events
[0m12:32:49.895003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42519a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e424fac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e4251ae10>]}


============================== 12:32:49.898016 | 3bc7404d-942e-48af-a1cb-88873830fee4 ==============================
[0m12:32:49.898016 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:32:49.900392 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None'}
[0m12:32:50.226726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42ba8690>]}
[0m12:32:50.313518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42541950>]}
[0m12:32:50.315361 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:32:50.358991 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:32:51.104084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:51.105527 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m12:32:51.396233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e410b1810>]}
[0m12:32:51.433458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e41108750>]}
[0m12:32:51.434933 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m12:32:51.436254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e41117790>]}
[0m12:32:51.439052 [info ] [MainThread]: 
[0m12:32:51.440736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:51.443156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m12:32:51.460960 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m12:32:51.462539 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m12:32:51.463897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:52.391628 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:32:52.394215 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m12:32:52.577258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m12:32:52.594998 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m12:32:52.596380 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m12:32:52.597755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:53.160786 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:32:53.163668 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m12:32:53.332457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e41664b10>]}
[0m12:32:53.335267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:53.337181 [info ] [MainThread]: 
[0m12:32:53.341466 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m12:32:53.343290 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m12:32:53.345739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m12:32:53.347915 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m12:32:53.363029 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m12:32:53.375186 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 12:32:53.349523 => 12:32:53.374668
[0m12:32:53.376750 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m12:32:53.414328 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m12:32:53.426209 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m12:32:53.427619 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.retail.country cm ON t.country = cm.nicename
        );
[0m12:32:53.428807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:54.112726 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e90-0000-000f-0000-00000f492859
[0m12:32:54.114446 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m12:32:54.116342 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 12:32:53.377908 => 12:32:54.116013
[0m12:32:54.117915 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m12:32:54.299205 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m12:32:54.301015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e237f3110>]}
[0m12:32:54.302819 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.96s]
[0m12:32:54.305091 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m12:32:54.306894 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:32:54.309353 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m12:32:54.311548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m12:32:54.313169 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:32:54.320638 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:32:54.336076 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:32:54.314926 => 12:32:54.335293
[0m12:32:54.338274 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:32:54.347113 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:32:54.362828 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m12:32:54.364628 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.retail.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m12:32:54.366295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:54.862562 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e90-0000-000a-0000-00000f49388d
[0m12:32:54.868427 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m12:32:54.874836 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:32:54.339680 => 12:32:54.873477
[0m12:32:54.880204 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m12:32:55.068990 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:32:55.070553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e410a46d0>]}
[0m12:32:55.072172 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.76s]
[0m12:32:55.074309 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:32:55.075932 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m12:32:55.077380 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m12:32:55.079575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m12:32:55.081368 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m12:32:55.088421 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m12:32:55.102233 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 12:32:55.082568 => 12:32:55.101840
[0m12:32:55.103714 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m12:32:55.109225 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m12:32:55.124692 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m12:32:55.126362 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.retail.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m12:32:55.127692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:55.621133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e90-0000-000f-0000-00000f49285d
[0m12:32:55.622735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m12:32:55.624338 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 12:32:55.105215 => 12:32:55.623994
[0m12:32:55.625876 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m12:32:55.802589 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m12:32:55.804110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc7404d-942e-48af-a1cb-88873830fee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e414bff50>]}
[0m12:32:55.805557 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.73s]
[0m12:32:55.807738 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m12:32:55.809870 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m12:32:55.811208 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m12:32:55.813283 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m12:32:55.817213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:55.818476 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m12:32:55.819973 [info ] [MainThread]: 
[0m12:32:55.821593 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m12:32:55.825039 [debug] [MainThread]: Command end result
[0m12:32:55.859090 [info ] [MainThread]: 
[0m12:32:55.860924 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:32:55.862456 [info ] [MainThread]: 
[0m12:32:55.863891 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m12:32:55.865508 [info ] [MainThread]: 
[0m12:32:55.867197 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:32:55.868748 [info ] [MainThread]: 
[0m12:32:55.870190 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m12:32:55.871661 [info ] [MainThread]: 
[0m12:32:55.873315 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:32:55.875297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.048337, "process_user_time": 3.252985, "process_kernel_time": 0.12011, "process_mem_max_rss": "136080", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:32:55.877061 [debug] [MainThread]: Command `dbt run` failed at 12:32:55.876807 after 6.05 seconds
[0m12:32:55.878547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42556b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e42519f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e46a931d0>]}
[0m12:32:55.879814 [debug] [MainThread]: Flushing usage events
[0m12:34:00.153110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d69dc2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d7ac6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d6fce590>]}


============================== 12:34:00.156000 | be910184-9c40-442e-85cc-4916f1521582 ==============================
[0m12:34:00.156000 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:34:00.158206 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True'}
[0m12:34:00.472433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be910184-9c40-442e-85cc-4916f1521582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d5352ed0>]}
[0m12:34:00.560144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be910184-9c40-442e-85cc-4916f1521582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d69dc190>]}
[0m12:34:00.561711 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:34:00.603180 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:34:01.381633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:34:01.382769 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m12:34:01.525961 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.dim_product' (models/transform/dim_product.sql) depends on a source named 'ASTRO_SDK_DB.raw_invoices' which was not found
[0m12:34:01.528802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4309866, "process_user_time": 2.413516, "process_kernel_time": 0.181771, "process_mem_max_rss": "122024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:01.530223 [debug] [MainThread]: Command `dbt run` failed at 12:34:01.530043 after 1.43 seconds
[0m12:34:01.531530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d632cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d632e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d632fad0>]}
[0m12:34:01.532734 [debug] [MainThread]: Flushing usage events
[0m12:37:36.595540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50673d9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50674ea410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50673bb590>]}


============================== 12:37:36.598094 | 4bfe5787-bd98-4980-8603-358e52d813dd ==============================
[0m12:37:36.598094 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:37:36.600467 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m12:37:36.939751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50663e65d0>]}
[0m12:37:37.029054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50673c9110>]}
[0m12:37:37.030858 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:37:37.068406 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:37:37.889678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:37.891112 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m12:37:38.158253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5065f5bed0>]}
[0m12:37:38.193378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5065fc2710>]}
[0m12:37:38.194774 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m12:37:38.196441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5065fc5310>]}
[0m12:37:38.199135 [info ] [MainThread]: 
[0m12:37:38.201286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:38.203484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m12:37:38.222699 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m12:37:38.224817 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m12:37:38.226197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:39.189668 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:37:39.192076 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m12:37:39.383514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m12:37:39.394380 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m12:37:39.396020 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m12:37:39.397659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:39.929617 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m12:37:39.933580 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m12:37:40.108028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f506467a0d0>]}
[0m12:37:40.112440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:40.115686 [info ] [MainThread]: 
[0m12:37:40.123672 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m12:37:40.127356 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m12:37:40.131700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m12:37:40.135130 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m12:37:40.157603 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m12:37:40.171926 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 12:37:40.137756 => 12:37:40.171510
[0m12:37:40.173501 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m12:37:40.208812 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m12:37:40.222704 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m12:37:40.224216 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM snowflake_default.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN snowflake_default.retail.country cm ON t.country = cm.nicename
        );
[0m12:37:40.225665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:40.890577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e95-0000-000a-0000-00000f493895
[0m12:37:40.892670 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
[0m12:37:40.894872 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 12:37:40.174764 => 12:37:40.894438
[0m12:37:40.896796 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m12:37:41.073186 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m12:37:41.074669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5066140f10>]}
[0m12:37:41.076210 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.94s]
[0m12:37:41.077876 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m12:37:41.079445 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m12:37:41.081200 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m12:37:41.082858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m12:37:41.084085 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m12:37:41.088696 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m12:37:41.100693 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 12:37:41.085149 => 12:37:41.100260
[0m12:37:41.102057 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m12:37:41.106455 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m12:37:41.119413 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m12:37:41.120873 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM snowflake_default.retail.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m12:37:41.122336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:41.576203 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e95-0000-000a-0000-00000f493899
[0m12:37:41.578075 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m12:37:41.580220 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 12:37:41.102969 => 12:37:41.579841
[0m12:37:41.582087 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m12:37:41.767282 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:37:41.768869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50646d3050>]}
[0m12:37:41.770474 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.69s]
[0m12:37:41.772744 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m12:37:41.774313 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m12:37:41.775836 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m12:37:41.778262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m12:37:41.780645 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m12:37:41.788645 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m12:37:41.802737 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 12:37:41.782472 => 12:37:41.802342
[0m12:37:41.803997 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m12:37:41.809282 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m12:37:41.822325 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m12:37:41.823809 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM snowflake_default.retail.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m12:37:41.825140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:42.296511 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39e95-0000-000f-0000-00000f492865
[0m12:37:42.298642 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
[0m12:37:42.300872 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 12:37:41.805071 => 12:37:42.300414
[0m12:37:42.303011 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m12:37:42.495880 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m12:37:42.499501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bfe5787-bd98-4980-8603-358e52d813dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5065f9d290>]}
[0m12:37:42.502818 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.72s]
[0m12:37:42.506061 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m12:37:42.509286 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m12:37:42.511508 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m12:37:42.513748 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m12:37:42.517929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:42.519828 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m12:37:42.521598 [info ] [MainThread]: 
[0m12:37:42.523293 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m12:37:42.525947 [debug] [MainThread]: Command end result
[0m12:37:42.562234 [info ] [MainThread]: 
[0m12:37:42.563778 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:37:42.565197 [info ] [MainThread]: 
[0m12:37:42.566635 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m12:37:42.567966 [info ] [MainThread]: 
[0m12:37:42.569284 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m12:37:42.570731 [info ] [MainThread]: 
[0m12:37:42.572121 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'SNOWFLAKE_DEFAULT' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m12:37:42.573458 [info ] [MainThread]: 
[0m12:37:42.574756 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m12:37:42.576941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.038665, "process_user_time": 3.149428, "process_kernel_time": 0.132072, "process_mem_max_rss": "134184", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m12:37:42.578439 [debug] [MainThread]: Command `dbt run` failed at 12:37:42.578245 after 6.04 seconds
[0m12:37:42.579844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5066133b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f506ba9cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5065f91a10>]}
[0m12:37:42.581437 [debug] [MainThread]: Flushing usage events
[0m13:03:22.624754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d28ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d2e6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d2ad9d0>]}


============================== 13:03:22.627328 | 856aece0-a839-4743-af12-44959bbd3acf ==============================
[0m13:03:22.627328 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:03:22.629647 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None'}
[0m13:03:22.950502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d3100d0>]}
[0m13:03:23.037946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d2d5a10>]}
[0m13:03:23.039609 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:03:23.079819 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:03:23.856822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:03:23.858264 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m13:03:24.128415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782be15b90>]}
[0m13:03:24.169252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782c10f910>]}
[0m13:03:24.170785 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:03:24.172583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782bfa7d50>]}
[0m13:03:24.175554 [info ] [MainThread]: 
[0m13:03:24.177899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:03:24.180264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:03:24.198083 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:03:24.200060 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:03:24.201514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:25.158861 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:03:25.161468 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:03:25.352565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:03:25.362482 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:03:25.363788 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:03:25.365000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:25.945854 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:03:25.949078 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:03:26.169248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782c2573d0>]}
[0m13:03:26.170989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:03:26.172540 [info ] [MainThread]: 
[0m13:03:26.176201 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:03:26.177666 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:03:26.179767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:03:26.181395 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:03:26.194695 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:03:26.207347 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:03:26.182816 => 13:03:26.206932
[0m13:03:26.208763 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:03:26.243976 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:03:26.256192 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:03:26.257521 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.retail.country cm ON t.country = cm.nicename
        );
[0m13:03:26.258859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:26.941955 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eaf-0000-000f-0000-00000f49286d
[0m13:03:26.943608 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m13:03:26.945352 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:03:26.209892 => 13:03:26.945041
[0m13:03:26.946790 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:03:27.137455 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:03:27.139258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782c204090>]}
[0m13:03:27.140962 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.96s]
[0m13:03:27.143443 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:03:27.145133 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:03:27.147218 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:03:27.149870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:03:27.151585 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:03:27.156577 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:03:27.167723 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:03:27.152837 => 13:03:27.167163
[0m13:03:27.169377 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:03:27.173757 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:03:27.186572 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:03:27.188165 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.retail.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:03:27.189835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:27.701277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eaf-0000-000f-0000-00000f492871
[0m13:03:27.703494 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m13:03:27.705725 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:03:27.170324 => 13:03:27.705092
[0m13:03:27.707622 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:03:27.949976 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:03:27.953620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782c2bbf50>]}
[0m13:03:27.957063 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.80s]
[0m13:03:27.960323 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:03:27.962842 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:03:27.965131 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:03:27.967724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:03:27.969936 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:03:27.979406 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:03:27.995657 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:03:27.971607 => 13:03:27.995167
[0m13:03:27.997278 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:03:28.002103 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:03:28.015089 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:03:28.016731 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.retail.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:03:28.018151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:28.518851 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eaf-0000-000a-0000-00000f4938a1
[0m13:03:28.523900 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m13:03:28.529750 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:03:27.998534 => 13:03:28.528529
[0m13:03:28.534520 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:03:28.728249 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:03:28.729847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856aece0-a839-4743-af12-44959bbd3acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782a7682d0>]}
[0m13:03:28.731532 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.76s]
[0m13:03:28.734136 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:03:28.736583 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:03:28.738130 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:03:28.740085 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:03:28.744032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:28.745750 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:03:28.747467 [info ] [MainThread]: 
[0m13:03:28.749253 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m13:03:28.752615 [debug] [MainThread]: Command end result
[0m13:03:28.784178 [info ] [MainThread]: 
[0m13:03:28.785803 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:03:28.787198 [info ] [MainThread]: 
[0m13:03:28.788557 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:03:28.789822 [info ] [MainThread]: 
[0m13:03:28.791171 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:03:28.792820 [info ] [MainThread]: 
[0m13:03:28.794228 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:03:28.795452 [info ] [MainThread]: 
[0m13:03:28.796621 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:03:28.798492 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.235679, "process_user_time": 3.074944, "process_kernel_time": 0.199671, "process_mem_max_rss": "136276", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:03:28.800059 [debug] [MainThread]: Command `dbt run` failed at 13:03:28.799828 after 6.24 seconds
[0m13:03:28.801530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d74c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f782d2979d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78316d7190>]}
[0m13:03:28.802905 [debug] [MainThread]: Flushing usage events
[0m13:04:28.428958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214f1c3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214f1a36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214f8582d0>]}


============================== 13:04:28.432088 | 26bb2be6-1f88-49fb-9aac-6e336c896c35 ==============================
[0m13:04:28.432088 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:04:28.434581 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True'}
[0m13:04:28.750517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214e1dbad0>]}
[0m13:04:28.835622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214f1e5890>]}
[0m13:04:28.837293 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:04:28.881267 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:04:29.735816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:29.737520 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m13:04:30.003616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214dee7290>]}
[0m13:04:30.041875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214dd7c390>]}
[0m13:04:30.043186 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:04:30.044905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21528e4710>]}
[0m13:04:30.048433 [info ] [MainThread]: 
[0m13:04:30.050949 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:30.057801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:04:30.074765 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:04:30.076300 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:04:30.077577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:30.971872 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:04:30.974692 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:04:31.173666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:04:31.184090 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:04:31.185374 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:04:31.186560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:32.000973 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:04:32.011302 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:04:32.194800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214ddc8f50>]}
[0m13:04:32.196687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:04:32.198885 [info ] [MainThread]: 
[0m13:04:32.203497 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:04:32.205242 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:04:32.207841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:04:32.209441 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:04:32.222511 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:04:32.238438 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:04:32.210597 => 13:04:32.238026
[0m13:04:32.239977 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:04:32.278492 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:04:32.290893 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:04:32.292292 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_SCHEMA.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_SCHEMA.retail.country cm ON t.country = cm.nicename
        );
[0m13:04:32.293627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:33.246012 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb0-0000-000f-0000-00000f49287d
[0m13:04:33.248015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'ASTRO_SDK_SCHEMA' does not exist or not authorized.
[0m13:04:33.250092 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:04:32.241157 => 13:04:33.249713
[0m13:04:33.251909 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:04:33.433076 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_SCHEMA' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:04:33.435248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214c382850>]}
[0m13:04:33.437533 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.23s]
[0m13:04:33.439722 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:04:33.441690 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:04:33.444390 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:04:33.446848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:04:33.448760 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:04:33.454606 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:04:33.468617 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:04:33.450385 => 13:04:33.468179
[0m13:04:33.470391 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:04:33.475462 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:04:33.489654 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:04:33.491348 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_SCHEMA.retail.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:04:33.492858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:33.986477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb0-0000-000a-0000-00000f4938a5
[0m13:04:33.992643 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m13:04:33.999101 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:04:33.471675 => 13:04:33.997725
[0m13:04:34.004521 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:04:34.192815 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:04:34.194556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214df05f10>]}
[0m13:04:34.196304 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.75s]
[0m13:04:34.198588 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:04:34.200235 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:04:34.201820 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:04:34.203946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:04:34.205773 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:04:34.213822 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:04:34.228204 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:04:34.206986 => 13:04:34.227795
[0m13:04:34.229651 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:04:34.235068 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:04:34.250360 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:04:34.252138 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_SCHEMA.retail.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:04:34.253542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:34.712118 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb0-0000-000f-0000-00000f492881
[0m13:04:34.713861 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'ASTRO_SDK_SCHEMA' does not exist or not authorized.
[0m13:04:34.715683 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:04:34.230813 => 13:04:34.715356
[0m13:04:34.717177 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:04:34.901319 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_SCHEMA' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:04:34.905250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26bb2be6-1f88-49fb-9aac-6e336c896c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214dfc3e10>]}
[0m13:04:34.908822 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.70s]
[0m13:04:34.912054 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:04:34.915566 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:04:34.918208 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:04:34.921185 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:04:34.926695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:34.928897 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:04:34.930847 [info ] [MainThread]: 
[0m13:04:34.933082 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.88 seconds (4.88s).
[0m13:04:34.936453 [debug] [MainThread]: Command end result
[0m13:04:34.970153 [info ] [MainThread]: 
[0m13:04:34.971374 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:04:34.972435 [info ] [MainThread]: 
[0m13:04:34.973761 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_SCHEMA' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:04:34.975067 [info ] [MainThread]: 
[0m13:04:34.976357 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:04:34.977555 [info ] [MainThread]: 
[0m13:04:34.978729 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_SCHEMA' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:04:34.979880 [info ] [MainThread]: 
[0m13:04:34.981010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:04:34.982826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.6280694, "process_user_time": 3.161699, "process_kernel_time": 0.181822, "process_mem_max_rss": "134448", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:04:34.984120 [debug] [MainThread]: Command `dbt run` failed at 13:04:34.983916 after 6.63 seconds
[0m13:04:34.985432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214f1fb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214dff0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f214f1a2890>]}
[0m13:04:34.986712 [debug] [MainThread]: Flushing usage events
[0m13:05:05.164386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5acac86350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5acac2b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5acac4ad90>]}


============================== 13:05:05.167108 | ac8f1af4-9e40-42f6-aec7-5acd79a87931 ==============================
[0m13:05:05.167108 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:05:05.169511 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m13:05:05.477700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8f1af4-9e40-42f6-aec7-5acd79a87931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac9d81c50>]}
[0m13:05:05.562627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8f1af4-9e40-42f6-aec7-5acd79a87931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5acb2d8050>]}
[0m13:05:05.564351 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:05:05.616914 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:05:06.463407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:06.464836 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m13:05:06.707314 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.fct_invoices' (models/transform/fct_invoices.sql) depends on a source named 'retail.raw_invoices' which was not found
[0m13:05:06.710250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6020274, "process_user_time": 2.516431, "process_kernel_time": 0.130333, "process_mem_max_rss": "125520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:05:06.711909 [debug] [MainThread]: Command `dbt run` failed at 13:05:06.711733 after 1.60 seconds
[0m13:05:06.713484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5acac332d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac97f2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5acac33550>]}
[0m13:05:06.714941 [debug] [MainThread]: Flushing usage events
[0m13:07:04.178218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cee9cbf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cee9ca6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cee9c9d10>]}


============================== 13:07:04.181092 | 475ad732-2090-4cc3-973f-d03bc03d5c48 ==============================
[0m13:07:04.181092 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:07:04.183202 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m13:07:04.505803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '475ad732-2090-4cc3-973f-d03bc03d5c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ced9973d0>]}
[0m13:07:04.588915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '475ad732-2090-4cc3-973f-d03bc03d5c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cee9b5d50>]}
[0m13:07:04.590591 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:07:04.634809 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:07:05.505929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:07:05.507456 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m13:07:05.508449 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m13:07:05.753620 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.dim_customer' (models/transform/dim_customer.sql) depends on a source named 'retail.raw_invoices' which was not found
[0m13:07:05.756444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6371958, "process_user_time": 2.58539, "process_kernel_time": 0.110229, "process_mem_max_rss": "125512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:07:05.757965 [debug] [MainThread]: Command `dbt run` failed at 13:07:05.757785 after 1.64 seconds
[0m13:07:05.759318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cf060cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ceee30b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ced851c10>]}
[0m13:07:05.760641 [debug] [MainThread]: Flushing usage events
[0m13:07:40.766429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f00fadd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f00db3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f00c0d90>]}


============================== 13:07:40.770380 | e81e3e24-02a2-4b46-b596-a786f0edae64 ==============================
[0m13:07:40.770380 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:07:40.772960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager'}
[0m13:07:41.099501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f00c3e50>]}
[0m13:07:41.184653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ef029490>]}
[0m13:07:41.186301 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:07:41.233741 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:07:41.974743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:07:41.976223 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m13:07:41.977220 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m13:07:41.978197 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:07:41.979400 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m13:07:41.980521 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m13:07:42.255386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26eec6fe90>]}
[0m13:07:42.294589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26eef0c710>]}
[0m13:07:42.295842 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:07:42.297288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26eedfcb50>]}
[0m13:07:42.299881 [info ] [MainThread]: 
[0m13:07:42.301777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:07:42.304143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:07:42.321826 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:07:42.323557 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:07:42.325034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:43.309259 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:07:43.312004 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:07:43.511764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:07:43.529581 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:07:43.530993 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:07:43.532415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:44.057729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:07:44.061452 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:07:44.264527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26ef098510>]}
[0m13:07:44.271442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:44.276573 [info ] [MainThread]: 
[0m13:07:44.286802 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:07:44.288711 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:07:44.291506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:07:44.293019 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:07:44.306450 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:07:44.323162 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:07:44.294256 => 13:07:44.322657
[0m13:07:44.324782 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:07:44.360224 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:07:44.372847 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:07:44.374256 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:07:44.375663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:45.078161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb3-0000-000f-0000-00000f492889
[0m13:07:45.083552 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m13:07:45.088189 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:07:44.325953 => 13:07:45.087222
[0m13:07:45.091331 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:07:45.264112 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:07:45.265601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26eeff7a90>]}
[0m13:07:45.267122 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.97s]
[0m13:07:45.269180 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:07:45.270590 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:07:45.272313 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:07:45.274902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:07:45.276947 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:07:45.281875 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:07:45.293034 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:07:45.278127 => 13:07:45.292415
[0m13:07:45.294928 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:07:45.299192 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:07:45.312159 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:07:45.313841 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:07:45.315256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:45.817711 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb3-0000-000f-0000-00000f49288d
[0m13:07:45.819577 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m13:07:45.821318 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:07:45.295888 => 13:07:45.821017
[0m13:07:45.822853 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:07:45.989869 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:07:45.991465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26eef5ef90>]}
[0m13:07:45.993218 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.72s]
[0m13:07:45.995300 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:07:45.996953 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:07:45.998466 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:07:46.000649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:07:46.002218 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:07:46.009741 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:07:46.021216 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:07:46.003635 => 13:07:46.020711
[0m13:07:46.022885 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:07:46.028350 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:07:46.042201 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:07:46.044176 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:07:46.045777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:46.589205 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb3-0000-000a-0000-00000f4938ad
[0m13:07:46.590961 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m13:07:46.592655 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:07:46.024103 => 13:07:46.592350
[0m13:07:46.594087 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:07:46.766103 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:07:46.767680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81e3e24-02a2-4b46-b596-a786f0edae64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26eecfb050>]}
[0m13:07:46.769258 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.77s]
[0m13:07:46.771003 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:07:46.773356 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:07:46.774724 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:07:46.776715 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:07:46.781133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:46.782775 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:07:46.784147 [info ] [MainThread]: 
[0m13:07:46.786152 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m13:07:46.789494 [debug] [MainThread]: Command end result
[0m13:07:46.823304 [info ] [MainThread]: 
[0m13:07:46.824990 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:07:46.826949 [info ] [MainThread]: 
[0m13:07:46.829633 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:07:46.831579 [info ] [MainThread]: 
[0m13:07:46.833742 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:07:46.836060 [info ] [MainThread]: 
[0m13:07:46.838470 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:07:46.840923 [info ] [MainThread]: 
[0m13:07:46.843100 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:07:46.846276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.143189, "process_user_time": 3.143235, "process_kernel_time": 0.186048, "process_mem_max_rss": "134592", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:07:46.848191 [debug] [MainThread]: Command `dbt run` failed at 13:07:46.848009 after 6.15 seconds
[0m13:07:46.849650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f00fab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f00a6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f46371d0>]}
[0m13:07:46.851387 [debug] [MainThread]: Flushing usage events
[0m13:09:25.770821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b34e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b34e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b34d310>]}


============================== 13:09:25.773454 | c6d77e57-7e43-4820-9214-fe302f1031d6 ==============================
[0m13:09:25.773454 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:09:25.775774 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None'}
[0m13:09:26.126067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b32ec50>]}
[0m13:09:26.218947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b9dc910>]}
[0m13:09:26.220786 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:09:26.258677 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:09:27.043303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:27.044546 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m13:09:27.217082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b36acd0>]}
[0m13:09:27.254691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a39dc5b50>]}
[0m13:09:27.256129 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:09:27.257799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3a23bd50>]}
[0m13:09:27.260575 [info ] [MainThread]: 
[0m13:09:27.262687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:09:27.265449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:09:27.282290 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:09:27.283789 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:09:27.285219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:28.144864 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:09:28.148218 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:09:28.339626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:09:28.349994 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:09:28.351594 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:09:28.353057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:28.896848 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:09:28.906730 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:09:29.088797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3a21aa90>]}
[0m13:09:29.095645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:09:29.101268 [info ] [MainThread]: 
[0m13:09:29.113248 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:09:29.116508 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:09:29.119957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:09:29.122394 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:09:29.139461 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:09:29.152348 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:09:29.124391 => 13:09:29.151883
[0m13:09:29.153772 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:09:29.188637 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:09:29.202656 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:09:29.204137 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:09:29.205644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:29.745129 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb5-0000-000a-0000-00000f4938d1
[0m13:09:29.746769 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m13:09:29.748790 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:09:29.154804 => 13:09:29.748245
[0m13:09:29.750681 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:09:29.946201 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:09:29.947789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a39f0b510>]}
[0m13:09:29.949334 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.83s]
[0m13:09:29.951446 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:09:29.953287 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:09:29.955800 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:09:29.958562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:09:29.960662 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:09:29.967523 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:09:29.980915 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:09:29.962710 => 13:09:29.980483
[0m13:09:29.982594 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:09:29.989069 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:09:30.001947 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:09:30.003416 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:09:30.004832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:30.559477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb5-0000-000a-0000-00000f4938d5
[0m13:09:30.561147 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m13:09:30.563004 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:09:29.984277 => 13:09:30.562671
[0m13:09:30.564619 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:09:30.781401 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:09:30.782879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a39e58c10>]}
[0m13:09:30.784280 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.83s]
[0m13:09:30.786694 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:09:30.788065 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:09:30.789406 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:09:30.791637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:09:30.793734 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:09:30.803268 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:09:30.817439 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:09:30.795311 => 13:09:30.816900
[0m13:09:30.818749 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:09:30.823285 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:09:30.837901 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:09:30.839539 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:09:30.841132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:31.454068 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eb5-0000-000a-0000-00000f4938d9
[0m13:09:31.455732 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 28 unexpected 'as'.
[0m13:09:31.457473 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:09:30.819716 => 13:09:31.457130
[0m13:09:31.458982 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:09:31.673493 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 28 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:09:31.675206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6d77e57-7e43-4820-9214-fe302f1031d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3ca6fd90>]}
[0m13:09:31.676895 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.88s]
[0m13:09:31.679270 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:09:31.681132 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:09:31.682777 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:09:31.684937 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:09:31.688699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:31.690390 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:09:31.691955 [info ] [MainThread]: 
[0m13:09:31.693310 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.43 seconds (4.43s).
[0m13:09:31.695512 [debug] [MainThread]: Command end result
[0m13:09:31.729835 [info ] [MainThread]: 
[0m13:09:31.732121 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:09:31.734566 [info ] [MainThread]: 
[0m13:09:31.736672 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:09:31.738363 [info ] [MainThread]: 
[0m13:09:31.739699 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:09:31.741416 [info ] [MainThread]: 
[0m13:09:31.742725 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 28 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:09:31.743997 [info ] [MainThread]: 
[0m13:09:31.745317 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:09:31.747814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.039062, "process_user_time": 3.081291, "process_kernel_time": 0.168974, "process_mem_max_rss": "133236", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:09:31.750003 [debug] [MainThread]: Command `dbt run` failed at 13:09:31.749735 after 6.04 seconds
[0m13:09:31.751724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b955890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3c7dc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3b32ff90>]}
[0m13:09:31.753027 [debug] [MainThread]: Flushing usage events
[0m13:43:48.953056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e318d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e3538810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e2504250>]}


============================== 13:43:48.957269 | 7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27 ==============================
[0m13:43:48.957269 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:43:48.959798 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'introspect': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/'}
[0m13:43:49.527191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e1040c50>]}
[0m13:43:49.647094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e2552550>]}
[0m13:43:49.649326 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:43:49.704749 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:43:52.286262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:52.291940 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m13:43:52.616588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e115df90>]}
[0m13:43:52.669457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e0da35d0>]}
[0m13:43:52.671853 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:43:52.673914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e2221610>]}
[0m13:43:52.678426 [info ] [MainThread]: 
[0m13:43:52.681320 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:52.685249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:43:52.711361 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:43:52.713899 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:43:52.716086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:54.147241 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:43:54.151474 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:43:54.381622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:43:54.425333 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:43:54.429192 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:43:54.433100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:55.035975 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:43:55.043803 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:43:55.238584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e0ed3a90>]}
[0m13:43:55.246151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:55.251750 [info ] [MainThread]: 
[0m13:43:55.266366 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:43:55.272348 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:43:55.280899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:43:55.288532 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:43:55.350501 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:43:55.395428 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:43:55.292973 => 13:43:55.393728
[0m13:43:55.401195 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:43:55.519247 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:43:55.537065 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:43:55.539218 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:43:55.541588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:56.398299 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ed7-0000-000f-0000-00000f4928b1
[0m13:43:56.404100 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m13:43:56.410122 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:43:55.405939 => 13:43:56.408747
[0m13:43:56.415288 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:43:56.645365 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:43:56.651832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e0b60250>]}
[0m13:43:56.658287 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.37s]
[0m13:43:56.665483 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:43:56.671322 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:43:56.679574 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:43:56.686425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:43:56.691904 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:43:56.711817 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:43:56.755874 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:43:56.696372 => 13:43:56.754327
[0m13:43:56.761524 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:43:56.786422 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:43:56.837597 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:43:56.843516 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:43:56.849473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:57.549553 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ed7-0000-000f-0000-00000f4928b5
[0m13:43:57.554990 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m13:43:57.560934 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:43:56.766161 => 13:43:57.559567
[0m13:43:57.566033 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:43:57.777684 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:43:57.783030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e0b74c50>]}
[0m13:43:57.788775 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.10s]
[0m13:43:57.795391 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:43:57.801098 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:43:57.807129 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:43:57.814832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:43:57.820508 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:43:57.851163 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:43:57.889527 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:43:57.824444 => 13:43:57.888025
[0m13:43:57.894452 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:43:57.913360 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:43:57.952863 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:43:57.958176 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:43:57.963473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:58.577909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ed7-0000-000a-0000-00000f4938e1
[0m13:43:58.584292 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m13:43:58.590803 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:43:57.898479 => 13:43:58.589374
[0m13:43:58.596389 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:43:58.912510 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:43:58.918476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e4bb746-7ea3-4dc3-881f-3ebf3bf36c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e0b3ed90>]}
[0m13:43:58.924952 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.11s]
[0m13:43:58.932992 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:43:58.942964 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:43:58.949076 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:43:58.957908 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:43:58.970901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:58.976873 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:43:58.982027 [info ] [MainThread]: 
[0m13:43:58.987447 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m13:43:59.000461 [debug] [MainThread]: Command end result
[0m13:43:59.125689 [info ] [MainThread]: 
[0m13:43:59.131504 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:43:59.137839 [info ] [MainThread]: 
[0m13:43:59.144831 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:43:59.152026 [info ] [MainThread]: 
[0m13:43:59.158821 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:43:59.165836 [info ] [MainThread]: 
[0m13:43:59.172550 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:43:59.179111 [info ] [MainThread]: 
[0m13:43:59.186001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:43:59.195268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.336218, "process_user_time": 5.325519, "process_kernel_time": 0.490508, "process_mem_max_rss": "132696", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:43:59.203567 [debug] [MainThread]: Command `dbt run` failed at 13:43:59.202350 after 10.34 seconds
[0m13:43:59.210004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e648f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e648f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e2047f50>]}
[0m13:43:59.215428 [debug] [MainThread]: Flushing usage events
[0m13:52:14.976538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3348868b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3348891490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33488a6650>]}


============================== 13:52:14.980668 | f2a21e01-66e6-4273-b8d5-3209be0d6871 ==============================
[0m13:52:14.980668 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:52:14.982650 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'debug': 'False'}
[0m13:52:15.496164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334886c450>]}
[0m13:52:15.661430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3348891890>]}
[0m13:52:15.664108 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:52:15.727718 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:52:19.456175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:19.458038 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:52:19.726133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33477e0c90>]}
[0m13:52:19.819490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33476cdd90>]}
[0m13:52:19.822884 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:52:19.826166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334784a190>]}
[0m13:52:19.833258 [info ] [MainThread]: 
[0m13:52:19.837743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:19.843789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:52:19.908402 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:52:19.913772 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:52:19.918745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:21.004788 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:52:21.009864 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:52:21.194396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:52:21.218416 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:52:21.221760 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:52:21.224891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:22.016676 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:52:22.028141 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:52:22.215065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3347793490>]}
[0m13:52:22.217922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:22.219984 [info ] [MainThread]: 
[0m13:52:22.225585 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:52:22.227836 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:52:22.230832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:52:22.232973 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:52:22.270719 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:52:22.288309 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:52:22.234740 => 13:52:22.287602
[0m13:52:22.290639 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:52:22.347608 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:52:22.367105 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:52:22.369388 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:52:22.371756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:22.967497 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee0-0000-000f-0000-00000f4928c1
[0m13:52:22.973175 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m13:52:22.979721 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:52:22.292693 => 13:52:22.978317
[0m13:52:22.985311 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:52:23.198513 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:52:23.204245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33473fb7d0>]}
[0m13:52:23.210622 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.97s]
[0m13:52:23.217803 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:52:23.224205 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:52:23.231660 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:52:23.238693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:52:23.244488 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:52:23.263503 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:52:23.301112 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:52:23.248483 => 13:52:23.299510
[0m13:52:23.306315 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:52:23.325723 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:52:23.368610 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:52:23.374752 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
),
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:52:23.380438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:23.970156 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee0-0000-000f-0000-00000f4928c5
[0m13:52:23.976724 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 0 unexpected 'SELECT'.
syntax error line 21 at position 15 unexpected 'datetime'.
syntax error line 22 at position 15 unexpected 'FROM'.
syntax error line 23 at position 16 unexpected 'FROM'.
syntax error line 24 at position 14 unexpected 'FROM'.
syntax error line 25 at position 15 unexpected 'FROM'.
syntax error line 26 at position 17 unexpected 'FROM'.
syntax error line 27 at position 20 unexpected 'FROM'.
syntax error line 28 at position 0 unexpected 'FROM'.
[0m13:52:23.983287 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:52:23.310558 => 13:52:23.981913
[0m13:52:23.988763 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:52:24.212707 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 0 unexpected 'SELECT'.
  syntax error line 21 at position 15 unexpected 'datetime'.
  syntax error line 22 at position 15 unexpected 'FROM'.
  syntax error line 23 at position 16 unexpected 'FROM'.
  syntax error line 24 at position 14 unexpected 'FROM'.
  syntax error line 25 at position 15 unexpected 'FROM'.
  syntax error line 26 at position 17 unexpected 'FROM'.
  syntax error line 27 at position 20 unexpected 'FROM'.
  syntax error line 28 at position 0 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:52:24.218765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3344118290>]}
[0m13:52:24.224908 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.98s]
[0m13:52:24.232449 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:52:24.238652 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:52:24.244532 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:52:24.252027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:52:24.257721 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:52:24.406589 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:52:24.432689 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:52:24.262680 => 13:52:24.432038
[0m13:52:24.435437 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:52:24.446821 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:52:24.470890 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:52:24.473873 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:52:24.477552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:25.061534 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee0-0000-000f-0000-00000f4928c9
[0m13:52:25.068027 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m13:52:25.075386 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:52:24.437780 => 13:52:25.073526
[0m13:52:25.081325 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:52:25.296740 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:52:25.302289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a21e01-66e6-4273-b8d5-3209be0d6871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3347845850>]}
[0m13:52:25.308317 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.05s]
[0m13:52:25.315593 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:52:25.324152 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:52:25.329722 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:52:25.336166 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:52:25.349911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:25.354740 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:52:25.360006 [info ] [MainThread]: 
[0m13:52:25.365742 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m13:52:25.377682 [debug] [MainThread]: Command end result
[0m13:52:25.495470 [info ] [MainThread]: 
[0m13:52:25.501015 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:52:25.505938 [info ] [MainThread]: 
[0m13:52:25.511928 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:52:25.519816 [info ] [MainThread]: 
[0m13:52:25.526497 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 0 unexpected 'SELECT'.
  syntax error line 21 at position 15 unexpected 'datetime'.
  syntax error line 22 at position 15 unexpected 'FROM'.
  syntax error line 23 at position 16 unexpected 'FROM'.
  syntax error line 24 at position 14 unexpected 'FROM'.
  syntax error line 25 at position 15 unexpected 'FROM'.
  syntax error line 26 at position 17 unexpected 'FROM'.
  syntax error line 27 at position 20 unexpected 'FROM'.
  syntax error line 28 at position 0 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:52:25.532386 [info ] [MainThread]: 
[0m13:52:25.538279 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:52:25.545139 [info ] [MainThread]: 
[0m13:52:25.551262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:52:25.559892 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.667357, "process_user_time": 5.292751, "process_kernel_time": 0.356242, "process_mem_max_rss": "133444", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:52:25.565672 [debug] [MainThread]: Command `dbt run` failed at 13:52:25.564816 after 10.67 seconds
[0m13:52:25.571019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3348891a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334cdf3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f334a077250>]}
[0m13:52:25.576344 [debug] [MainThread]: Flushing usage events
[0m13:53:50.515320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e30e2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e30aa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e30a90d0>]}


============================== 13:53:50.522573 | 15c4b246-528a-4508-a96a-c236ff138706 ==============================
[0m13:53:50.522573 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:53:50.526502 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'write_json': 'True'}
[0m13:53:51.101583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e2587190>]}
[0m13:53:51.322185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e21de010>]}
[0m13:53:51.324828 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:53:51.386046 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:53:55.016458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:53:55.018801 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:53:55.257886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1c13550>]}
[0m13:53:55.313225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1f01010>]}
[0m13:53:55.315468 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:53:55.317454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1f90190>]}
[0m13:53:55.321680 [info ] [MainThread]: 
[0m13:53:55.324481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:53:55.328922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:53:55.358890 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:53:55.361217 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:53:55.363389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:56.589413 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:53:56.599577 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:53:56.832385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:53:56.878734 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:53:56.884304 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:53:56.889835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:57.605386 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:53:57.615509 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:53:57.839740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e1f47d10>]}
[0m13:53:57.846976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:57.852086 [info ] [MainThread]: 
[0m13:53:57.867905 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:53:57.874201 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:53:57.884605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:53:57.890557 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:53:57.980224 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:53:58.002572 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:53:57.895140 => 13:53:58.001981
[0m13:53:58.005528 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:53:58.105251 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:53:58.135960 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:53:58.140042 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:53:58.144510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:59.042137 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee1-0000-000a-0000-00000f4938e9
[0m13:53:59.048515 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m13:53:59.055396 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:53:58.008115 => 13:53:59.054025
[0m13:53:59.060826 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:53:59.283908 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:53:59.289478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e025edd0>]}
[0m13:53:59.295897 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.41s]
[0m13:53:59.303448 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:53:59.310621 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:53:59.321080 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:53:59.334856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:53:59.342072 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:53:59.367079 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:53:59.411681 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:53:59.346813 => 13:53:59.408996
[0m13:53:59.417582 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:53:59.440266 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:53:59.488887 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:53:59.494789 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (-- dim_datetime
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte;
[0m13:53:59.500631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:00.125346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee1-0000-000f-0000-00000f4928d1
[0m13:54:00.131894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 17 unexpected ';'.
[0m13:54:00.138028 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:53:59.422047 => 13:54:00.136644
[0m13:54:00.143359 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:54:00.361484 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 17 unexpected ';'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:54:00.367383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e0163690>]}
[0m13:54:00.374046 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.04s]
[0m13:54:00.381468 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:54:00.388052 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:54:00.393995 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:54:00.401219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:54:00.406713 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:54:00.562510 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:54:00.590382 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:54:00.411421 => 13:54:00.589378
[0m13:54:00.593994 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:54:00.607909 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:54:00.636516 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:54:00.640081 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:54:00.644136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:01.245702 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee2-0000-000a-0000-00000f4938ed
[0m13:54:01.252602 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m13:54:01.259648 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:54:00.596700 => 13:54:01.258133
[0m13:54:01.265352 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:54:01.472988 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:54:01.479097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c4b246-528a-4508-a96a-c236ff138706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e20b0210>]}
[0m13:54:01.485186 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.08s]
[0m13:54:01.492407 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:54:01.500856 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:54:01.506660 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:54:01.513444 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:54:01.526577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:01.531651 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:54:01.536775 [info ] [MainThread]: 
[0m13:54:01.542572 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m13:54:01.553517 [debug] [MainThread]: Command end result
[0m13:54:01.670979 [info ] [MainThread]: 
[0m13:54:01.676541 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:54:01.681699 [info ] [MainThread]: 
[0m13:54:01.687696 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:54:01.694193 [info ] [MainThread]: 
[0m13:54:01.700256 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 17 unexpected ';'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:54:01.706750 [info ] [MainThread]: 
[0m13:54:01.712407 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:54:01.718777 [info ] [MainThread]: 
[0m13:54:01.724553 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:54:01.732820 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.353613, "process_user_time": 5.717462, "process_kernel_time": 0.382506, "process_mem_max_rss": "134720", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:54:01.738956 [debug] [MainThread]: Command `dbt run` failed at 13:54:01.738003 after 11.36 seconds
[0m13:54:01.744403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e21687d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e761f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6e3087c50>]}
[0m13:54:01.750009 [debug] [MainThread]: Flushing usage events
[0m13:54:23.528880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d3302010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d3905650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d398c810>]}


============================== 13:54:23.532525 | c55dbc93-5fe9-4fdf-ab8d-5be13365cb84 ==============================
[0m13:54:23.532525 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:54:23.534624 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None'}
[0m13:54:24.099924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d398c950>]}
[0m13:54:24.256249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d2448610>]}
[0m13:54:24.258846 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:54:24.316129 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:54:26.948480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:26.950352 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m13:54:27.172506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d20fd350>]}
[0m13:54:27.263543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d2203290>]}
[0m13:54:27.267050 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:54:27.270384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d21eba90>]}
[0m13:54:27.277359 [info ] [MainThread]: 
[0m13:54:27.281995 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:54:27.289101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:54:27.333347 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:54:27.336692 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:54:27.339908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:28.398225 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:54:28.407534 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:54:28.601326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:54:28.649285 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:54:28.655504 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:54:28.660564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:29.311448 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m13:54:29.322740 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:54:29.519320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d32e7890>]}
[0m13:54:29.526846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:29.532150 [info ] [MainThread]: 
[0m13:54:29.547908 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:54:29.557693 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:54:29.568654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:54:29.575174 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:54:29.695038 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:54:29.729944 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:54:29.580250 => 13:54:29.728989
[0m13:54:29.733892 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:54:29.835348 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:54:29.862593 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:54:29.866329 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:54:29.870633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:30.518451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee2-0000-000a-0000-00000f4938f9
[0m13:54:30.524860 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m13:54:30.531565 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:54:29.736809 => 13:54:30.530186
[0m13:54:30.537052 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:54:30.748628 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:54:30.754347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d05f7490>]}
[0m13:54:30.761005 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.19s]
[0m13:54:30.768203 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:54:30.774387 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m13:54:30.782664 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m13:54:30.794019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m13:54:30.801686 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m13:54:30.824622 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m13:54:30.870042 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 13:54:30.806535 => 13:54:30.868102
[0m13:54:30.875392 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m13:54:30.895114 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m13:54:30.943828 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m13:54:30.949870 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (-- dim_datetime
WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m13:54:30.955612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:31.609583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee2-0000-000f-0000-00000f4928d5
[0m13:54:31.615698 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 4
invalid identifier 'INVOICEDATE'
[0m13:54:31.623004 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 13:54:30.879746 => 13:54:31.621464
[0m13:54:31.629102 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m13:54:31.861032 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'INVOICEDATE'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:54:31.867049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d03cc1d0>]}
[0m13:54:31.873203 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.08s]
[0m13:54:31.879711 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m13:54:31.885777 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m13:54:31.891679 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m13:54:31.899829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m13:54:31.906539 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m13:54:32.039272 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m13:54:32.066562 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 13:54:31.911182 => 13:54:32.065682
[0m13:54:32.069957 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m13:54:32.082620 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m13:54:32.126915 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m13:54:32.132467 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m13:54:32.138602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:32.709559 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ee2-0000-000a-0000-00000f4938fd
[0m13:54:32.715536 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m13:54:32.721756 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 13:54:32.072639 => 13:54:32.720387
[0m13:54:32.727430 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m13:54:32.939193 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:54:32.944885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55dbc93-5fe9-4fdf-ab8d-5be13365cb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d23ea590>]}
[0m13:54:32.951397 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.05s]
[0m13:54:32.958464 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m13:54:32.968741 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m13:54:32.975072 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m13:54:32.983041 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:54:32.996703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:33.001931 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m13:54:33.007156 [info ] [MainThread]: 
[0m13:54:33.012351 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m13:54:33.024874 [debug] [MainThread]: Command end result
[0m13:54:33.141946 [info ] [MainThread]: 
[0m13:54:33.147402 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:54:33.152857 [info ] [MainThread]: 
[0m13:54:33.158637 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m13:54:33.164318 [info ] [MainThread]: 
[0m13:54:33.170592 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  000904 (42000): SQL compilation error: error line 6 at position 4
  invalid identifier 'INVOICEDATE'
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m13:54:33.177151 [info ] [MainThread]: 
[0m13:54:33.183118 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m13:54:33.189717 [info ] [MainThread]: 
[0m13:54:33.196155 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m13:54:33.203444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.7600975, "process_user_time": 5.733371, "process_kernel_time": 0.262443, "process_mem_max_rss": "133024", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:54:33.209461 [debug] [MainThread]: Command `dbt run` failed at 13:54:33.208509 after 9.77 seconds
[0m13:54:33.214755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d78771d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d32de250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d2224dd0>]}
[0m13:54:33.220014 [debug] [MainThread]: Flushing usage events
[0m14:16:15.625782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc77a2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc842fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc779f7d0>]}


============================== 14:16:15.629483 | 36fbfc14-c2e4-4972-89a5-41acf0d0ada1 ==============================
[0m14:16:15.629483 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:16:15.631733 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False'}
[0m14:16:16.230168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36fbfc14-c2e4-4972-89a5-41acf0d0ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc678b110>]}
[0m14:16:16.351998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36fbfc14-c2e4-4972-89a5-41acf0d0ada1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc784f010>]}
[0m14:16:16.354316 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:16:16.425547 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:16:21.149439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:16:21.155638 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m14:16:21.160141 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:16:21.552541 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.fct_invoices' (models/transform/fct_invoices.sql) depends on a source named 'ASTRO_SDK_SCHEMA.raw_invoices' which was not found
[0m14:16:21.555188 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.012763, "process_user_time": 4.262092, "process_kernel_time": 0.351823, "process_mem_max_rss": "125692", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:16:21.557443 [debug] [MainThread]: Command `dbt run` failed at 14:16:21.557098 after 6.02 seconds
[0m14:16:21.559609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc77d6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc77d70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc77d7890>]}
[0m14:16:21.561775 [debug] [MainThread]: Flushing usage events
[0m14:17:01.269084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e28f6a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e28f6a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2a803b50>]}


============================== 14:17:01.273096 | b7dee9ba-195b-44a7-95c0-9aa5e22010dd ==============================
[0m14:17:01.273096 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:17:01.275191 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'write_json': 'True', 'debug': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m14:17:01.795794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e28f6b390>]}
[0m14:17:01.968998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2805e290>]}
[0m14:17:01.971209 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:17:02.048068 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:17:05.656453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:17:05.666285 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m14:17:05.670719 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m14:17:05.674930 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:17:05.679316 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:17:05.683813 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m14:17:06.222883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e261ddcd0>]}
[0m14:17:06.290386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e27b12090>]}
[0m14:17:06.293466 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:17:06.297143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e27e01750>]}
[0m14:17:06.306842 [info ] [MainThread]: 
[0m14:17:06.314887 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:06.326985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:17:06.402228 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:17:06.406116 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:17:06.410049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:07.693076 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:17:07.699132 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:17:07.893118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:17:07.917064 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:17:07.919975 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:17:07.922824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:08.778088 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:17:08.788550 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:17:09.005534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e27f88090>]}
[0m14:17:09.012725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:09.018062 [info ] [MainThread]: 
[0m14:17:09.036235 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:17:09.043243 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:17:09.050625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:17:09.056568 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:17:09.148289 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:17:09.191240 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:17:09.061134 => 14:17:09.189603
[0m14:17:09.196878 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:17:09.341158 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:17:09.366426 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:17:09.368824 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.retail.country cm ON t.country = cm.nicename
        );
[0m14:17:09.371190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:10.026073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ef9-0000-000a-0000-00000f493961
[0m14:17:10.031963 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m14:17:10.038197 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:17:09.201318 => 14:17:10.036827
[0m14:17:10.043711 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:17:10.280118 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:17:10.286242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e27adbf10>]}
[0m14:17:10.292606 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.24s]
[0m14:17:10.299912 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:17:10.305910 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:17:10.313484 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:17:10.322203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:17:10.332196 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:17:10.358574 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:17:10.403866 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:17:10.337383 => 14:17:10.402028
[0m14:17:10.409774 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:17:10.429226 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:17:10.476821 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:17:10.482828 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.retail.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:17:10.488676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:11.855690 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ef9-0000-000a-0000-00000f493965
[0m14:17:11.862062 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:17:11.868578 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:17:10.414266 => 14:17:11.867220
[0m14:17:11.874117 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:17:12.134452 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:17:12.140830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e27ae6950>]}
[0m14:17:12.147438 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.82s]
[0m14:17:12.154351 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:17:12.160231 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:17:12.165888 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:17:12.173132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:17:12.179136 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:17:12.209749 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:17:12.254434 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:17:12.183768 => 14:17:12.252818
[0m14:17:12.259914 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:17:12.279140 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:17:12.313724 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:17:12.317306 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.retail.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:17:12.320799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:12.944652 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39ef9-0000-000a-0000-00000f493969
[0m14:17:12.950748 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m14:17:12.957926 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:17:12.264236 => 14:17:12.956440
[0m14:17:12.964188 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:17:13.189902 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:17:13.195855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7dee9ba-195b-44a7-95c0-9aa5e22010dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e27e44b90>]}
[0m14:17:13.202051 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.02s]
[0m14:17:13.208871 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:17:13.218512 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:17:13.224141 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:17:13.230224 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:17:13.242471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:13.247729 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:17:13.254016 [info ] [MainThread]: 
[0m14:17:13.259698 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m14:17:13.269314 [debug] [MainThread]: Command end result
[0m14:17:13.389078 [info ] [MainThread]: 
[0m14:17:13.395255 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:17:13.400563 [info ] [MainThread]: 
[0m14:17:13.409743 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:17:13.424654 [info ] [MainThread]: 
[0m14:17:13.435241 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:17:13.443233 [info ] [MainThread]: 
[0m14:17:13.450920 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:17:13.466311 [info ] [MainThread]: 
[0m14:17:13.481447 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:17:13.491247 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.303451, "process_user_time": 5.843746, "process_kernel_time": 0.423167, "process_mem_max_rss": "134356", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:17:13.500196 [debug] [MainThread]: Command `dbt run` failed at 14:17:13.498095 after 12.31 seconds
[0m14:17:13.506325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e28f6b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2d5e1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e260d0050>]}
[0m14:17:13.511402 [debug] [MainThread]: Flushing usage events
[0m14:20:42.165438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3020428810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301ffc5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301ff88150>]}


============================== 14:20:42.172350 | cae85e8e-9403-41e3-8c13-e752dd81f39e ==============================
[0m14:20:42.172350 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:20:42.176882 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m14:20:42.748573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae85e8e-9403-41e3-8c13-e752dd81f39e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301ef61a90>]}
[0m14:20:42.922086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae85e8e-9403-41e3-8c13-e752dd81f39e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301f36b950>]}
[0m14:20:42.924804 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:20:43.024158 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:20:44.487626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:20:44.489943 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m14:20:44.491880 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:20:44.494113 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:20:44.496424 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m14:20:44.498187 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m14:20:44.967445 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.dim_customer' (models/transform/dim_customer.sql) depends on a source named 'retail.raw_invoices' which was not found
[0m14:20:44.971543 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9573603, "process_user_time": 4.34555, "process_kernel_time": 0.229237, "process_mem_max_rss": "123800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:20:44.974353 [debug] [MainThread]: Command `dbt run` failed at 14:20:44.973963 after 2.96 seconds
[0m14:20:44.977211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3020428dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301ffc5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f301eeedc10>]}
[0m14:20:44.980543 [debug] [MainThread]: Flushing usage events
[0m14:21:04.835172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb5fa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bbbfd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb5f4050>]}


============================== 14:21:04.842054 | cbefbd2a-a534-43b0-833a-9f99cb94d30a ==============================
[0m14:21:04.842054 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:21:04.846263 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'write_json': 'True', 'target_path': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m14:21:05.353935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba5ecdd0>]}
[0m14:21:05.549337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba6f33d0>]}
[0m14:21:05.552141 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:21:05.614045 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:21:09.423424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:21:09.429363 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m14:21:09.433609 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m14:21:09.437640 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:21:09.441667 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m14:21:09.445546 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:21:09.874707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba1af590>]}
[0m14:21:09.945606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba236150>]}
[0m14:21:09.949605 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:21:09.953686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba321ad0>]}
[0m14:21:09.963218 [info ] [MainThread]: 
[0m14:21:09.969858 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:09.978478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:21:10.046497 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:21:10.051411 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:21:10.056060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:11.314175 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:21:11.323442 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:21:11.775980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:21:11.821984 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:21:11.827329 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:21:11.832329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:12.536347 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:21:12.547575 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:21:12.784551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba321fd0>]}
[0m14:21:12.792306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:12.798707 [info ] [MainThread]: 
[0m14:21:12.813003 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:21:12.819136 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:21:12.826005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:21:12.831976 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:21:12.894936 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:21:12.938529 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:21:12.837459 => 14:21:12.937036
[0m14:21:12.944337 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:21:13.060012 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:21:13.079286 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:21:13.081736 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:21:13.083681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:13.710497 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39efd-0000-000f-0000-00000f492939
[0m14:21:13.716028 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:21:13.722569 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:21:12.948662 => 14:21:13.721099
[0m14:21:13.728111 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:21:13.945672 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:21:13.951566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba22b4d0>]}
[0m14:21:13.957868 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.13s]
[0m14:21:13.964637 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:21:13.970807 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:21:13.978577 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:21:13.985608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:21:13.992379 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:21:14.011920 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:21:14.056299 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:21:13.996838 => 14:21:14.054638
[0m14:21:14.061899 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:21:14.081850 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:21:14.133655 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:21:14.139857 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:21:14.145789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:14.873780 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39efd-0000-000a-0000-00000f493971
[0m14:21:14.879930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:21:14.886930 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:21:14.066274 => 14:21:14.885348
[0m14:21:14.892406 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:21:15.105096 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:21:15.110744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba236ed0>]}
[0m14:21:15.117218 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.13s]
[0m14:21:15.124548 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:21:15.130498 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:21:15.136517 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:21:15.144479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:21:15.150725 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:21:15.187881 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:21:15.232629 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:21:15.155753 => 14:21:15.230963
[0m14:21:15.237965 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:21:15.257395 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:21:15.303624 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:21:15.309579 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:21:15.315434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:16.227887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39efd-0000-000a-0000-00000f493975
[0m14:21:16.234652 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:21:16.241460 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:21:15.242376 => 14:21:16.239837
[0m14:21:16.247663 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:21:16.474270 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:21:16.480064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbefbd2a-a534-43b0-833a-9f99cb94d30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ba1da890>]}
[0m14:21:16.485693 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.34s]
[0m14:21:16.492875 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:21:16.503112 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:21:16.509721 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:21:16.516284 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:21:16.530816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:16.535927 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:21:16.541972 [info ] [MainThread]: 
[0m14:21:16.547586 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m14:21:16.557844 [debug] [MainThread]: Command end result
[0m14:21:16.683555 [info ] [MainThread]: 
[0m14:21:16.689112 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:21:16.694271 [info ] [MainThread]: 
[0m14:21:16.700292 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:21:16.707177 [info ] [MainThread]: 
[0m14:21:16.712901 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:21:16.718938 [info ] [MainThread]: 
[0m14:21:16.724539 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:21:16.730710 [info ] [MainThread]: 
[0m14:21:16.738358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:21:16.745830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.066931, "process_user_time": 5.953752, "process_kernel_time": 0.335279, "process_mem_max_rss": "134028", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:21:16.752510 [debug] [MainThread]: Command `dbt run` failed at 14:21:16.751672 after 12.07 seconds
[0m14:21:16.757941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb632b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bb5de350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29bfb6f1d0>]}
[0m14:21:16.763322 [debug] [MainThread]: Flushing usage events
[0m14:22:34.294433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd3ceab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd4364790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd4364950>]}


============================== 14:22:34.299211 | b57d4c08-a4e2-4dda-9690-1aa0fbc24e02 ==============================
[0m14:22:34.299211 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:22:34.302195 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m14:22:34.834654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2e097d0>]}
[0m14:22:35.027198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd3cf5cd0>]}
[0m14:22:35.029697 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:22:35.084756 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:22:39.600589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:39.605186 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:22:39.928822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2aec6d0>]}
[0m14:22:39.984339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2b9a3d0>]}
[0m14:22:39.987078 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:22:39.989174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2a28c10>]}
[0m14:22:39.992874 [info ] [MainThread]: 
[0m14:22:39.995001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:39.998628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:22:40.032543 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:22:40.035926 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:22:40.039316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:41.221509 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:22:41.230771 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:22:41.774648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:22:41.821857 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:22:41.827641 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:22:41.832715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:42.855679 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:22:42.866153 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:22:43.076814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2bfb150>]}
[0m14:22:43.083190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:43.088080 [info ] [MainThread]: 
[0m14:22:43.101315 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:22:43.107695 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:22:43.114925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:22:43.120860 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:22:43.182444 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:22:43.226855 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:22:43.125459 => 14:22:43.225203
[0m14:22:43.232381 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:22:43.337492 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:22:43.357702 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:22:43.360270 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    -- md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:22:43.362999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.171944 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39efe-0000-000f-0000-00000f492941
[0m14:22:44.178222 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 5
invalid identifier 'COUNTRY'
[0m14:22:44.184843 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:22:43.236936 => 14:22:44.183373
[0m14:22:44.190155 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:22:44.402174 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:22:44.407818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2b01450>]}
[0m14:22:44.414151 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.29s]
[0m14:22:44.421043 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:22:44.427024 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:22:44.434757 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:22:44.442281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:22:44.447997 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:22:44.468224 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:22:44.512260 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:22:44.452517 => 14:22:44.510739
[0m14:22:44.517653 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:22:44.542599 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:22:44.589713 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:22:44.595476 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:22:44.601306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:45.375497 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39efe-0000-000f-0000-00000f492945
[0m14:22:45.381930 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:22:45.388987 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:22:44.522003 => 14:22:45.387429
[0m14:22:45.395264 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:22:45.612362 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:22:45.618374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2804450>]}
[0m14:22:45.624469 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.18s]
[0m14:22:45.631701 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:22:45.637787 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:22:45.643445 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:22:45.651856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:22:45.657649 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:22:45.689764 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:22:45.733164 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:22:45.662074 => 14:22:45.731672
[0m14:22:45.738587 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:22:45.758068 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:22:45.803873 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:22:45.809425 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:22:45.815013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:46.525997 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39efe-0000-000a-0000-00000f49397d
[0m14:22:46.531768 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:22:46.538274 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:22:45.742965 => 14:22:46.536741
[0m14:22:46.543664 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:22:46.760679 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:22:46.766480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d4c08-a4e2-4dda-9690-1aa0fbc24e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd27e1510>]}
[0m14:22:46.772865 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.12s]
[0m14:22:46.780287 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:22:46.788586 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:22:46.794161 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:22:46.799899 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:22:46.813848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:46.818591 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:22:46.823398 [info ] [MainThread]: 
[0m14:22:46.828900 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.83 seconds (6.83s).
[0m14:22:46.839347 [debug] [MainThread]: Command end result
[0m14:22:46.957510 [info ] [MainThread]: 
[0m14:22:46.962861 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:22:46.967899 [info ] [MainThread]: 
[0m14:22:46.973769 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:22:46.979216 [info ] [MainThread]: 
[0m14:22:46.985180 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:22:46.991536 [info ] [MainThread]: 
[0m14:22:46.997804 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:22:47.003883 [info ] [MainThread]: 
[0m14:22:47.009811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:22:47.017347 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.865684, "process_user_time": 6.000341, "process_kernel_time": 0.395961, "process_mem_max_rss": "132732", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:22:47.023678 [debug] [MainThread]: Command `dbt run` failed at 14:22:47.022751 after 12.87 seconds
[0m14:22:47.028950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd4364e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd8253290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd27c9250>]}
[0m14:22:47.034049 [debug] [MainThread]: Flushing usage events
[0m14:23:21.019038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd144bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1448b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd143c7d0>]}


============================== 14:23:21.025808 | 574b0e05-c704-46aa-bc12-4affc02d6576 ==============================
[0m14:23:21.025808 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:23:21.029886 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'log_format': 'default'}
[0m14:23:21.623771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd04078d0>]}
[0m14:23:21.795164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1465950>]}
[0m14:23:21.798269 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:23:21.910154 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:23:25.473958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:25.479235 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:23:25.769426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd0407c90>]}
[0m14:23:25.871503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcfeb6290>]}
[0m14:23:25.875744 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:23:25.879955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2d42150>]}
[0m14:23:25.889165 [info ] [MainThread]: 
[0m14:23:25.892022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:25.896131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:23:25.953012 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:23:25.958021 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:23:25.962830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:26.952338 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:23:26.956018 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:23:27.176628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:23:27.198662 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:23:27.201573 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:23:27.203995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:28.009704 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:23:28.020236 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:23:28.248838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd14415d0>]}
[0m14:23:28.255264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:28.260039 [info ] [MainThread]: 
[0m14:23:28.272657 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:23:28.278997 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:23:28.287314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:23:28.293038 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:23:28.350765 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:23:28.393375 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:23:28.297635 => 14:23:28.391853
[0m14:23:28.399197 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:23:28.496581 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:23:28.514036 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:23:28.516125 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    -- md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:23:28.518210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:29.147189 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eff-0000-000f-0000-00000f492951
[0m14:23:29.152794 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 5
invalid identifier 'COUNTRY'
[0m14:23:29.159289 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:23:28.403604 => 14:23:29.157765
[0m14:23:29.164605 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:23:29.401799 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:23:29.407893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd0308990>]}
[0m14:23:29.414391 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.12s]
[0m14:23:29.421544 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:23:29.427466 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:23:29.435318 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:23:29.442932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:23:29.449120 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:23:29.469290 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:23:29.513938 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:23:29.453687 => 14:23:29.512173
[0m14:23:29.519953 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:23:29.546462 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:23:29.594998 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:23:29.600680 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:23:29.606744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:31.313334 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eff-0000-000f-0000-00000f492955
[0m14:23:31.319097 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:23:31.325412 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:23:29.524740 => 14:23:31.323871
[0m14:23:31.330870 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:23:31.544529 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:23:31.550584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dcdcf45d0>]}
[0m14:23:31.557071 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 2.11s]
[0m14:23:31.563835 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:23:31.569956 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:23:31.575984 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:23:31.584377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:23:31.589885 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:23:31.623107 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:23:31.666152 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:23:31.594356 => 14:23:31.664579
[0m14:23:31.671677 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:23:31.690918 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:23:31.736051 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:23:31.741794 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:23:31.747199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:32.388869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39eff-0000-000f-0000-00000f492959
[0m14:23:32.394367 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:23:32.400645 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:23:31.675953 => 14:23:32.399248
[0m14:23:32.406269 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:23:32.628863 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:23:32.634431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '574b0e05-c704-46aa-bc12-4affc02d6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd2b7c450>]}
[0m14:23:32.640719 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.05s]
[0m14:23:32.648514 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:23:32.657504 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:23:32.663145 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:23:32.669512 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:23:32.683306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:32.688109 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:23:32.692654 [info ] [MainThread]: 
[0m14:23:32.698288 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m14:23:32.710101 [debug] [MainThread]: Command end result
[0m14:23:32.831938 [info ] [MainThread]: 
[0m14:23:32.837032 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:23:32.841932 [info ] [MainThread]: 
[0m14:23:32.847281 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:23:32.853527 [info ] [MainThread]: 
[0m14:23:32.859033 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:23:32.865460 [info ] [MainThread]: 
[0m14:23:32.875500 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:23:32.882366 [info ] [MainThread]: 
[0m14:23:32.888808 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:23:32.897092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.030582, "process_user_time": 5.652952, "process_kernel_time": 0.436368, "process_mem_max_rss": "132576", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:23:32.903030 [debug] [MainThread]: Command `dbt run` failed at 14:23:32.902199 after 12.04 seconds
[0m14:23:32.908689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1427a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1426650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd5af9d10>]}
[0m14:23:32.913658 [debug] [MainThread]: Flushing usage events
[0m14:25:42.410080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba9186dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba914bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba9185810>]}


============================== 14:25:42.416766 | faf29c69-a18a-45f4-93bf-ac893eaffa46 ==============================
[0m14:25:42.416766 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:25:42.420705 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None'}
[0m14:25:42.992587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faf29c69-a18a-45f4-93bf-ac893eaffa46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba9188850>]}
[0m14:25:43.200173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faf29c69-a18a-45f4-93bf-ac893eaffa46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba97d8590>]}
[0m14:25:43.204351 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:25:43.302754 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:25:47.469205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:47.474443 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:25:47.740176 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.dim_customer' (models/transform/dim_customer.sql) depends on a source named 'ASTRO_SDK_SCHEMA.RAW_INVOICES' which was not found
[0m14:25:47.742601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.4857135, "process_user_time": 3.995136, "process_kernel_time": 0.228577, "process_mem_max_rss": "121816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:25:47.744749 [debug] [MainThread]: Command `dbt run` failed at 14:25:47.744473 after 5.49 seconds
[0m14:25:47.746563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba91323d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba913b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba913a9d0>]}
[0m14:25:47.748458 [debug] [MainThread]: Flushing usage events
[0m14:27:29.671695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63cc56f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ccb79b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63cd94fa10>]}


============================== 14:27:29.675720 | e8f4ceb6-b052-4e48-afcd-b0e8d156168c ==============================
[0m14:27:29.675720 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:27:29.677985 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'printer_width': '80', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'introspect': 'True', 'target_path': 'None'}
[0m14:27:30.365772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8f4ceb6-b052-4e48-afcd-b0e8d156168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63cc5aa610>]}
[0m14:27:30.594534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8f4ceb6-b052-4e48-afcd-b0e8d156168c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63cc595990>]}
[0m14:27:30.598937 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:27:30.701283 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:27:33.145543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:27:33.150124 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m14:27:33.153904 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:27:33.723765 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.fct_invoices' (models/transform/fct_invoices.sql) depends on a source named 'ASTRO_SDK_SCHEMA.raw_invoices' which was not found
[0m14:27:33.726297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1933827, "process_user_time": 4.574504, "process_kernel_time": 0.259122, "process_mem_max_rss": "123808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:33.728258 [debug] [MainThread]: Command `dbt run` failed at 14:27:33.727987 after 4.20 seconds
[0m14:27:33.730023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63cc595590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63cc556810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63ccaf1710>]}
[0m14:27:33.731741 [debug] [MainThread]: Flushing usage events
[0m14:28:36.304977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ac6fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223b2f43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223d585a90>]}


============================== 14:28:36.310961 | 76d38f61-dbac-4f00-9879-93460b7ff1af ==============================
[0m14:28:36.310961 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:28:36.315073 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/'}
[0m14:28:37.072834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2239c26250>]}
[0m14:28:37.315513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ac85910>]}
[0m14:28:37.319583 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:28:37.418212 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:28:39.916008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m14:28:39.918684 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m14:28:39.920635 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m14:28:39.922437 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m14:28:39.924468 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:28:39.926587 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m14:28:40.309849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22397de550>]}
[0m14:28:40.403264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223984d2d0>]}
[0m14:28:40.406728 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:28:40.409920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223985a150>]}
[0m14:28:40.416939 [info ] [MainThread]: 
[0m14:28:40.421103 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:40.427122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:28:40.470623 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:28:40.474210 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:28:40.477438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:43.111411 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m14:28:43.121752 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:28:43.358311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:28:43.399878 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:28:43.403355 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:28:43.407505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:44.201409 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:28:44.205162 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:28:44.379581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2239845e10>]}
[0m14:28:44.382491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:44.384558 [info ] [MainThread]: 
[0m14:28:44.389738 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:28:44.392311 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:28:44.395056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:28:44.397081 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:28:44.414053 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:28:44.429753 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:28:44.398574 => 14:28:44.429194
[0m14:28:44.431876 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:28:44.480973 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:28:44.497680 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:28:44.499677 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:28:44.501623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:45.013681 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f04-0000-000f-0000-00000f49295d
[0m14:28:45.017432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:28:45.021434 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:28:44.433485 => 14:28:45.020575
[0m14:28:45.024835 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:28:45.219598 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:28:45.225600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2239921990>]}
[0m14:28:45.231839 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.83s]
[0m14:28:45.238677 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:28:45.244862 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:28:45.254027 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:28:45.265724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:28:45.272450 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:28:45.297342 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:28:45.341227 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:28:45.277592 => 14:28:45.339521
[0m14:28:45.346662 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:28:45.368614 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:28:45.417275 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:28:45.423274 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:28:45.428672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:46.024009 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f04-0000-000a-0000-00000f493989
[0m14:28:46.029606 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:28:46.035826 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:28:45.351332 => 14:28:46.034456
[0m14:28:46.041546 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:28:46.229494 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:28:46.231594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2239a5de50>]}
[0m14:28:46.233998 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.97s]
[0m14:28:46.236498 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:28:46.238703 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:28:46.240753 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:28:46.243357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:28:46.245711 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:28:46.257510 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:28:46.282012 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:28:46.247522 => 14:28:46.280896
[0m14:28:46.285779 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:28:46.303726 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:28:46.349646 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:28:46.355270 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:28:46.361075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:46.967572 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f04-0000-000a-0000-00000f49398d
[0m14:28:46.973473 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:28:46.980032 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:28:46.289802 => 14:28:46.978523
[0m14:28:46.985668 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:28:47.214195 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:28:47.220036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d38f61-dbac-4f00-9879-93460b7ff1af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223982a290>]}
[0m14:28:47.226557 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.98s]
[0m14:28:47.234405 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:28:47.242884 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:28:47.248761 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:28:47.256473 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:28:47.271377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:47.276474 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:28:47.281840 [info ] [MainThread]: 
[0m14:28:47.287482 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m14:28:47.300710 [debug] [MainThread]: Command end result
[0m14:28:47.418482 [info ] [MainThread]: 
[0m14:28:47.423740 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:28:47.429095 [info ] [MainThread]: 
[0m14:28:47.434809 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:28:47.440551 [info ] [MainThread]: 
[0m14:28:47.446753 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:28:47.452229 [info ] [MainThread]: 
[0m14:28:47.457898 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:28:47.463583 [info ] [MainThread]: 
[0m14:28:47.469058 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:28:47.476432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.294811, "process_user_time": 5.753522, "process_kernel_time": 0.350824, "process_mem_max_rss": "136200", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:28:47.482563 [debug] [MainThread]: Command `dbt run` failed at 14:28:47.481709 after 11.30 seconds
[0m14:28:47.487787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ac47450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223ac46650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f223f1df150>]}
[0m14:28:47.497912 [debug] [MainThread]: Flushing usage events
[0m14:32:16.299382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dcbd7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68df7d7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dcc01f50>]}


============================== 14:32:16.303487 | 7988bd36-255c-4544-a545-cb945d7a8a0d ==============================
[0m14:32:16.303487 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:32:16.306033 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'quiet': 'False', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m14:32:16.880370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dcc01ad0>]}
[0m14:32:17.128000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dcbe98d0>]}
[0m14:32:17.131607 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:32:17.246350 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:32:21.864517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:21.869051 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:32:22.174921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dbaa8a50>]}
[0m14:32:22.264203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dbadd9d0>]}
[0m14:32:22.269225 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:32:22.274473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dbc2dd90>]}
[0m14:32:22.285426 [info ] [MainThread]: 
[0m14:32:22.291687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:22.300295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:32:22.345293 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:32:22.348609 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:32:22.351860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:23.612394 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:32:23.622755 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:32:23.830878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:32:23.876828 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:32:23.882031 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:32:23.887156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:24.580236 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:32:24.590422 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:32:24.792794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dba64250>]}
[0m14:32:24.798455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:24.802631 [info ] [MainThread]: 
[0m14:32:24.810715 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:32:24.814077 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:32:24.817218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:32:24.819839 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:32:24.840605 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:32:24.856144 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:32:24.822062 => 14:32:24.855585
[0m14:32:24.857943 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:32:24.906591 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:32:24.925377 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:32:24.927653 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	-- WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:32:24.929864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:25.659543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f08-0000-000f-0000-00000f492965
[0m14:32:25.663011 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:32:25.666881 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:32:24.859390 => 14:32:25.666043
[0m14:32:25.670246 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:32:25.847232 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:32:25.851003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68db82a950>]}
[0m14:32:25.855064 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.03s]
[0m14:32:25.859390 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:32:25.862236 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:32:25.865870 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:32:25.869556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:32:25.871800 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:32:25.883587 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:32:25.925157 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:32:25.874193 => 14:32:25.923653
[0m14:32:25.930606 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:32:25.955211 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:32:26.003203 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:32:26.014743 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:32:26.020723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:26.720884 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f08-0000-000a-0000-00000f493995
[0m14:32:26.726631 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:32:26.732739 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:32:25.935094 => 14:32:26.731366
[0m14:32:26.738043 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:32:26.942126 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:32:26.947753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dbc454d0>]}
[0m14:32:26.953924 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.08s]
[0m14:32:26.960791 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:32:26.966898 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:32:26.972449 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:32:26.979770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:32:26.985522 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:32:27.016940 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:32:27.060011 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:32:26.990067 => 14:32:27.058517
[0m14:32:27.065556 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:32:27.084862 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:32:27.131393 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:32:27.137139 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:32:27.142590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:27.735076 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f08-0000-000f-0000-00000f492969
[0m14:32:27.740557 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:32:27.747045 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:32:27.069869 => 14:32:27.745652
[0m14:32:27.752299 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:32:27.950158 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:32:27.953567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7988bd36-255c-4544-a545-cb945d7a8a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dd5c7310>]}
[0m14:32:27.957157 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.98s]
[0m14:32:27.960746 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:32:27.965885 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:32:27.969196 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:32:27.972663 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:32:27.979168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:27.981847 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:32:27.984561 [info ] [MainThread]: 
[0m14:32:27.987600 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m14:32:27.992646 [debug] [MainThread]: Command end result
[0m14:32:28.048934 [info ] [MainThread]: 
[0m14:32:28.051518 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:32:28.053651 [info ] [MainThread]: 
[0m14:32:28.056027 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:32:28.057998 [info ] [MainThread]: 
[0m14:32:28.060415 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:32:28.062751 [info ] [MainThread]: 
[0m14:32:28.064792 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:32:28.066834 [info ] [MainThread]: 
[0m14:32:28.068923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:32:28.071755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.898466, "process_user_time": 5.549883, "process_kernel_time": 0.516268, "process_mem_max_rss": "132580", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:32:28.074141 [debug] [MainThread]: Command `dbt run` failed at 14:32:28.073697 after 11.90 seconds
[0m14:32:28.076440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dd1d59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dd149850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68e1147290>]}
[0m14:32:28.078637 [debug] [MainThread]: Flushing usage events
[0m14:34:13.014662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224979ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224976f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2249d95850>]}


============================== 14:34:13.018975 | ab2ec840-8f24-4aba-9fc8-14302d8653d9 ==============================
[0m14:34:13.018975 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:34:13.021582 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'write_json': 'True', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'static_parser': 'True'}
[0m14:34:13.576574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2249777510>]}
[0m14:34:13.728835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22497b5810>]}
[0m14:34:13.731554 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:34:13.795308 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:34:17.349605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:17.353951 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:17.380452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22488af110>]}
[0m14:34:17.497684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22486c59d0>]}
[0m14:34:17.502304 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:34:17.506526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224cea8cd0>]}
[0m14:34:17.514824 [info ] [MainThread]: 
[0m14:34:17.522062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:17.529448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:34:17.586012 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:34:17.590167 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:34:17.594112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:18.900835 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:34:18.910975 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:34:19.249881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:34:19.296872 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:34:19.302034 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:34:19.306900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:21.252168 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.0 seconds
[0m14:34:21.255748 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:34:21.502139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2247a07fd0>]}
[0m14:34:21.510025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:21.515810 [info ] [MainThread]: 
[0m14:34:21.533925 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:34:21.540306 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:34:21.547508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:34:21.553444 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:34:21.645344 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:34:21.667646 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:34:21.559205 => 14:34:21.666952
[0m14:34:21.670181 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:34:21.764432 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:34:21.787756 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:34:21.789875 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	-- WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:34:21.792274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:23.522135 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0a-0000-000f-0000-00000f49296d
[0m14:34:23.527918 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:34:23.534423 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:34:21.672378 => 14:34:23.532983
[0m14:34:23.540197 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:34:24.014151 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:34:24.024313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2248711910>]}
[0m14:34:24.032688 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 2.48s]
[0m14:34:24.040271 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:34:24.046338 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:34:24.054349 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:34:24.062164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:34:24.068055 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:34:24.088633 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:34:24.132938 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:34:24.072370 => 14:34:24.131394
[0m14:34:24.138990 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:34:24.158913 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:34:24.197609 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:34:24.202061 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:34:24.206304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:25.008822 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0a-0000-000a-0000-00000f4939a1
[0m14:34:25.014959 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:34:25.021702 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:34:24.143588 => 14:34:25.020173
[0m14:34:25.027476 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:34:25.310946 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:34:25.317091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224a41f790>]}
[0m14:34:25.323588 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.26s]
[0m14:34:25.334252 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:34:25.340450 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:34:25.346502 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:34:25.353958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:34:25.360345 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:34:25.392008 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:34:25.436874 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:34:25.364988 => 14:34:25.435300
[0m14:34:25.442310 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:34:25.461778 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:34:25.508869 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:34:25.515001 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:34:25.520614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:26.872928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0a-0000-000a-0000-00000f4939a5
[0m14:34:26.879029 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:34:26.886281 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:34:25.446755 => 14:34:26.884493
[0m14:34:26.892381 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:34:27.153287 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:34:27.159743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2ec840-8f24-4aba-9fc8-14302d8653d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22485dc490>]}
[0m14:34:27.167463 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.81s]
[0m14:34:27.175606 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:34:27.184760 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:34:27.190590 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:34:27.197143 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:34:27.211904 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:27.217143 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:34:27.221698 [info ] [MainThread]: 
[0m14:34:27.230099 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.70 seconds (9.70s).
[0m14:34:27.248649 [debug] [MainThread]: Command end result
[0m14:34:27.378269 [info ] [MainThread]: 
[0m14:34:27.384008 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:34:27.388890 [info ] [MainThread]: 
[0m14:34:27.394562 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:34:27.399679 [info ] [MainThread]: 
[0m14:34:27.405267 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:34:27.411411 [info ] [MainThread]: 
[0m14:34:27.418057 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:34:27.423439 [info ] [MainThread]: 
[0m14:34:27.428802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:34:27.435939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.509564, "process_user_time": 5.47356, "process_kernel_time": 0.338981, "process_mem_max_rss": "130804", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:34:27.441968 [debug] [MainThread]: Command `dbt run` failed at 14:34:27.441168 after 14.52 seconds
[0m14:34:27.447216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2249e1c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224ddb1010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f224976ffd0>]}
[0m14:34:27.452394 [debug] [MainThread]: Flushing usage events
[0m14:38:37.064860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2f9602d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2f2cb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2f2f1d90>]}


============================== 14:38:37.075816 | 9655d86f-eaf0-442c-b448-718dac8ea33d ==============================
[0m14:38:37.075816 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:38:37.082256 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True'}
[0m14:38:37.653716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2e433c10>]}
[0m14:38:37.824308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2f2ca6d0>]}
[0m14:38:37.826936 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:38:37.885016 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:38:42.292267 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:38:42.296033 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:38:42.572409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2e138490>]}
[0m14:38:42.640815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2dd41b10>]}
[0m14:38:42.644028 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:38:42.646430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2e2ef390>]}
[0m14:38:42.653600 [info ] [MainThread]: 
[0m14:38:42.658816 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:38:42.665234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:38:42.735848 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:38:42.741207 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:38:42.746253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:47.004406 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m14:38:47.008392 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:38:47.717918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:38:47.765206 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:38:47.770539 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:38:47.775478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:48.988284 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:38:48.998982 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:38:49.476120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2dff6150>]}
[0m14:38:49.483242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:49.488789 [info ] [MainThread]: 
[0m14:38:49.504703 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:38:49.510954 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:38:49.519063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:38:49.524423 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:38:49.581123 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:38:49.623511 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:38:49.528867 => 14:38:49.622029
[0m14:38:49.628748 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:38:49.727347 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:38:49.744278 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:38:49.747128 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    -- md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	-- WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:38:49.750754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:50.589738 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0e-0000-000a-0000-00000f4939c9
[0m14:38:50.598677 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 5
invalid identifier 'COUNTRY'
[0m14:38:50.605369 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:38:49.632976 => 14:38:50.603971
[0m14:38:50.610985 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:38:50.823004 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:38:50.828766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2e10cc90>]}
[0m14:38:50.835103 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.31s]
[0m14:38:50.841843 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:38:50.847607 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:38:50.855181 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:38:50.864084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:38:50.871099 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:38:50.892749 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:38:50.935777 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:38:50.875596 => 14:38:50.934246
[0m14:38:50.941385 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:38:50.966744 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:38:51.014372 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:38:51.020620 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:38:51.026804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:52.432710 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0e-0000-000a-0000-00000f4939cd
[0m14:38:52.438628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:38:52.445707 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:38:50.945838 => 14:38:52.444162
[0m14:38:52.451653 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:38:53.193944 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:38:53.200374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2e36f510>]}
[0m14:38:53.207433 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 2.34s]
[0m14:38:53.215121 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:38:53.221255 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:38:53.226988 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:38:53.234356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:38:53.240265 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:38:53.273391 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:38:53.317073 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:38:53.244740 => 14:38:53.315487
[0m14:38:53.322765 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:38:53.342364 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:38:53.388555 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:38:53.394470 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:38:53.400110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:54.131346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0e-0000-000a-0000-00000f4939d1
[0m14:38:54.137534 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:38:54.144534 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:38:53.327080 => 14:38:54.143064
[0m14:38:54.150561 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:38:54.360102 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:38:54.364004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9655d86f-eaf0-442c-b448-718dac8ea33d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2e326650>]}
[0m14:38:54.368018 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.13s]
[0m14:38:54.372263 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:38:54.377947 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:38:54.381358 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:38:54.385498 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:38:54.393013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:54.396093 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:38:54.399343 [info ] [MainThread]: 
[0m14:38:54.402758 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.74 seconds (11.74s).
[0m14:38:54.409624 [debug] [MainThread]: Command end result
[0m14:38:54.488143 [info ] [MainThread]: 
[0m14:38:54.491701 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:38:54.495032 [info ] [MainThread]: 
[0m14:38:54.498557 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:38:54.502010 [info ] [MainThread]: 
[0m14:38:54.505709 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:38:54.508887 [info ] [MainThread]: 
[0m14:38:54.512616 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:38:54.516259 [info ] [MainThread]: 
[0m14:38:54.520057 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:38:54.524431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.655745, "process_user_time": 5.625638, "process_kernel_time": 0.515094, "process_mem_max_rss": "132964", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:38:54.528224 [debug] [MainThread]: Command `dbt run` failed at 14:38:54.527728 after 17.66 seconds
[0m14:38:54.531619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a33984f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a33985d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2f2abe50>]}
[0m14:38:54.535027 [debug] [MainThread]: Flushing usage events
[0m14:39:27.119359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37af34d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37af34e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37af36150>]}


============================== 14:39:27.126068 | 027a58df-d29e-4a2a-9664-9a0aab96000d ==============================
[0m14:39:27.126068 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:39:27.129957 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/'}
[0m14:39:27.723640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379e97490>]}
[0m14:39:27.886532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37af59910>]}
[0m14:39:27.889297 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:39:27.945673 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:39:31.931171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:31.934941 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:39:32.229223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379a7e050>]}
[0m14:39:32.296736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379abd3d0>]}
[0m14:39:32.300070 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:39:32.302775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37a035750>]}
[0m14:39:32.308915 [info ] [MainThread]: 
[0m14:39:32.312738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:32.320229 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:39:32.373085 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:39:32.376668 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:39:32.380040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:33.335044 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:39:33.342365 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:39:33.554089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:39:33.588512 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:39:33.593683 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:39:33.598587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:34.240107 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:39:34.250513 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:39:34.451159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379c6e610>]}
[0m14:39:34.455683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:34.458703 [info ] [MainThread]: 
[0m14:39:34.467426 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:39:34.471453 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:39:34.476363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:39:34.480037 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:39:34.512405 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:39:34.529217 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:39:34.483024 => 14:39:34.528592
[0m14:39:34.531394 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:39:34.596802 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:39:34.617579 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:39:34.619677 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    -- md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Contry AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	-- WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:39:34.621821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:35.598298 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0f-0000-000a-0000-00000f4939d9
[0m14:39:35.604342 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 5
invalid identifier 'CONTRY'
[0m14:39:35.610726 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:39:34.533258 => 14:39:35.609337
[0m14:39:35.616964 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:39:35.830352 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'CONTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:39:35.836205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379a0e2d0>]}
[0m14:39:35.842797 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.36s]
[0m14:39:35.850368 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:39:35.856705 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:39:35.866851 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:39:35.875637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:39:35.881415 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:39:35.903333 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:39:35.949563 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:39:35.885968 => 14:39:35.947948
[0m14:39:35.955130 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:39:35.976666 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:39:36.008401 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:39:36.012070 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:39:36.015624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:36.683583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0f-0000-000a-0000-00000f4939dd
[0m14:39:36.689670 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:39:36.696452 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:39:35.959599 => 14:39:36.695094
[0m14:39:36.700586 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:39:36.909764 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:39:36.915921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379d5d350>]}
[0m14:39:36.922284 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.04s]
[0m14:39:36.929962 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:39:36.938121 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:39:36.944062 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:39:36.954027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:39:36.961239 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:39:36.999922 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:39:37.044065 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:39:36.966444 => 14:39:37.042370
[0m14:39:37.049636 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:39:37.068945 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:39:37.115510 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:39:37.121707 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:39:37.127584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:37.740370 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f0f-0000-000a-0000-00000f4939e1
[0m14:39:37.746667 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:39:37.754852 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:39:37.054052 => 14:39:37.752406
[0m14:39:37.761401 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:39:37.972060 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:39:37.977803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '027a58df-d29e-4a2a-9664-9a0aab96000d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe379a97cd0>]}
[0m14:39:37.983905 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.03s]
[0m14:39:37.991203 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:39:37.999627 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:39:38.005183 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:39:38.013482 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:39:38.027013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:38.031417 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:39:38.036265 [info ] [MainThread]: 
[0m14:39:38.041952 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.72 seconds (5.72s).
[0m14:39:38.051617 [debug] [MainThread]: Command end result
[0m14:39:38.172579 [info ] [MainThread]: 
[0m14:39:38.178379 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:39:38.183374 [info ] [MainThread]: 
[0m14:39:38.189255 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier 'CONTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:39:38.195110 [info ] [MainThread]: 
[0m14:39:38.201210 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:39:38.206997 [info ] [MainThread]: 
[0m14:39:38.213421 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:39:38.219023 [info ] [MainThread]: 
[0m14:39:38.225091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:39:38.233011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.253671, "process_user_time": 5.407505, "process_kernel_time": 0.453988, "process_mem_max_rss": "132740", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:39:38.238407 [debug] [MainThread]: Command `dbt run` failed at 14:39:38.237570 after 11.26 seconds
[0m14:39:38.243124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37af32450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37c681cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe37f35b190>]}
[0m14:39:38.248333 [debug] [MainThread]: Flushing usage events
[0m14:42:59.851216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b0b0150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b0b3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b73c7d0>]}


============================== 14:42:59.854574 | 08a7e72e-f682-44e1-8d56-16b90e23569b ==============================
[0m14:42:59.854574 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:42:59.856746 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'target_path': 'None'}
[0m14:43:00.390561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b73c950>]}
[0m14:43:00.596101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4236d0>]}
[0m14:43:00.598731 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:43:00.683469 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:43:04.606047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:04.609606 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:43:04.960550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a0fb3d0>]}
[0m14:43:05.042641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2519b26890>]}
[0m14:43:05.045869 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:43:05.054231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251e7c8dd0>]}
[0m14:43:05.060501 [info ] [MainThread]: 
[0m14:43:05.064657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:05.070395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:43:05.114402 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:43:05.117942 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:43:05.121068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:06.893401 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m14:43:06.903624 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:43:07.146330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:43:07.192615 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:43:07.197449 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:43:07.202439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:08.147581 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:43:08.158476 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:43:08.394404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2519e3e650>]}
[0m14:43:08.401279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:08.406645 [info ] [MainThread]: 
[0m14:43:08.422770 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:43:08.428798 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:43:08.436850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:43:08.442817 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:43:08.498929 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:43:08.543431 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:43:08.447127 => 14:43:08.541884
[0m14:43:08.548702 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:43:08.661969 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:43:08.681015 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:43:08.683608 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustmerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:43:08.685974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:09.504134 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f13-0000-000a-0000-00000f4939f1
[0m14:43:09.510376 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTMERID'
[0m14:43:09.517404 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:43:08.552890 => 14:43:09.515784
[0m14:43:09.522694 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:43:09.875875 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:43:09.881766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2519c5b250>]}
[0m14:43:09.888057 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.45s]
[0m14:43:09.894665 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:43:09.901521 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:43:09.909583 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:43:09.917046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:43:09.922914 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:43:09.943617 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:43:09.987592 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:43:09.927451 => 14:43:09.986019
[0m14:43:09.993210 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:43:10.018173 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:43:10.066813 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:43:10.072864 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:43:10.078725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:10.939806 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f13-0000-000f-0000-00000f492995
[0m14:43:10.945908 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:43:10.953138 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:43:09.997743 => 14:43:10.951642
[0m14:43:10.959189 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:43:11.189928 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:43:11.195661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2518168350>]}
[0m14:43:11.201976 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.28s]
[0m14:43:11.209730 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:43:11.215905 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:43:11.221963 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:43:11.229141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:43:11.234746 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:43:11.267776 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:43:11.311778 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:43:11.239585 => 14:43:11.310250
[0m14:43:11.317191 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:43:11.336655 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:43:11.383390 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:43:11.389804 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:43:11.395234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:12.271414 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f13-0000-000a-0000-00000f4939f5
[0m14:43:12.275906 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:43:12.281096 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:43:11.321522 => 14:43:12.280052
[0m14:43:12.285260 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:43:12.521400 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:43:12.527078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a7e72e-f682-44e1-8d56-16b90e23569b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2519bcca50>]}
[0m14:43:12.533345 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.30s]
[0m14:43:12.543609 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:43:12.553881 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:43:12.560216 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:43:12.566880 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:43:12.581124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:12.585869 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:43:12.591084 [info ] [MainThread]: 
[0m14:43:12.596511 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m14:43:12.606616 [debug] [MainThread]: Command end result
[0m14:43:12.724565 [info ] [MainThread]: 
[0m14:43:12.729910 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:43:12.734940 [info ] [MainThread]: 
[0m14:43:12.741022 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:43:12.746839 [info ] [MainThread]: 
[0m14:43:12.753612 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:43:12.760476 [info ] [MainThread]: 
[0m14:43:12.767593 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:43:12.774249 [info ] [MainThread]: 
[0m14:43:12.780408 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:43:12.788703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.0189705, "process_user_time": 5.949814, "process_kernel_time": 0.373123, "process_mem_max_rss": "133120", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:43:12.794786 [debug] [MainThread]: Command `dbt run` failed at 14:43:12.793933 after 13.03 seconds
[0m14:43:12.800127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b6b5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251b0eb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2519c720d0>]}
[0m14:43:12.805368 [debug] [MainThread]: Flushing usage events
[0m14:43:45.043794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99882249d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9988ea1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9988224050>]}


============================== 14:43:45.049081 | 1b4f8a32-4cef-4be5-afe2-957ea2e19501 ==============================
[0m14:43:45.049081 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:43:45.052351 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m14:43:45.681328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9987316d10>]}
[0m14:43:45.801922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998823d750>]}
[0m14:43:45.804099 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:43:45.869242 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:43:48.826844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:48.828524 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:43:49.076254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9987190c10>]}
[0m14:43:49.149867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9986c92a50>]}
[0m14:43:49.154160 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:43:49.158916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998b934cd0>]}
[0m14:43:49.171320 [info ] [MainThread]: 
[0m14:43:49.178962 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:49.188346 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:43:49.263853 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:43:49.268067 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:43:49.271631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:50.251681 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:43:50.256461 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:43:50.479531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:43:50.507095 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:43:50.510238 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:43:50.513373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:43:51.068413 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:43:51.074080 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:43:51.256982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9987299710>]}
[0m14:43:51.261709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:51.264898 [info ] [MainThread]: 
[0m14:43:51.273447 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:43:51.276820 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:43:51.280451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:43:51.283182 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:43:51.310288 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:43:51.332285 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:43:51.285973 => 14:43:51.331526
[0m14:43:51.335014 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:43:51.404346 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:43:51.425894 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:43:51.428333 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.COUNTRY cm ON t.country = cm.nicename
        );
[0m14:43:51.430736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:51.995438 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f13-0000-000f-0000-00000f492999
[0m14:43:51.999300 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:43:52.003425 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:43:51.337300 => 14:43:52.002563
[0m14:43:52.007313 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:43:52.195403 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:43:52.199047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9986dc4410>]}
[0m14:43:52.203063 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.92s]
[0m14:43:52.207753 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:43:52.211843 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:43:52.217567 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:43:52.223889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:43:52.228230 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:43:52.240831 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:43:52.267485 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:43:52.231134 => 14:43:52.266444
[0m14:43:52.270898 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:43:52.286528 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:43:52.318964 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:43:52.323091 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:43:52.326840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:53.202310 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f13-0000-000a-0000-00000f493a01
[0m14:43:53.205922 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m14:43:53.210188 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:43:52.273384 => 14:43:53.209155
[0m14:43:53.213787 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:43:53.396896 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:43:53.400612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9986d26dd0>]}
[0m14:43:53.404525 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.18s]
[0m14:43:53.408451 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:43:53.411687 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:43:53.415261 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:43:53.419035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:43:53.421531 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:43:53.437613 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:43:53.466165 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:43:53.423659 => 14:43:53.465058
[0m14:43:53.469612 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:43:53.481870 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:43:53.513452 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:43:53.517051 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.RAW_INVOICES
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m14:43:53.520783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:54.134671 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b39f13-0000-000a-0000-00000f493a05
[0m14:43:54.138048 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m14:43:54.141938 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:43:53.472452 => 14:43:54.141047
[0m14:43:54.145096 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:43:54.330520 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:43:54.334286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4f8a32-4cef-4be5-afe2-957ea2e19501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9986d406d0>]}
[0m14:43:54.338137 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.92s]
[0m14:43:54.342540 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:43:54.348079 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:43:54.352990 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m14:43:54.357888 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:43:54.366768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:54.369817 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m14:43:54.372729 [info ] [MainThread]: 
[0m14:43:54.375770 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m14:43:54.383052 [debug] [MainThread]: Command end result
[0m14:43:54.453539 [info ] [MainThread]: 
[0m14:43:54.456754 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:43:54.460398 [info ] [MainThread]: 
[0m14:43:54.463965 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:43:54.467633 [info ] [MainThread]: 
[0m14:43:54.471277 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m14:43:54.475014 [info ] [MainThread]: 
[0m14:43:54.478779 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m14:43:54.481851 [info ] [MainThread]: 
[0m14:43:54.485325 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m14:43:54.489753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.60458, "process_user_time": 5.314799, "process_kernel_time": 0.2425, "process_mem_max_rss": "132356", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:43:54.493382 [debug] [MainThread]: Command `dbt run` failed at 14:43:54.492694 after 9.61 seconds
[0m14:43:54.496512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f998c7931d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9986d54ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99881fbf50>]}
[0m14:43:54.499828 [debug] [MainThread]: Flushing usage events
[0m05:57:58.430919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53890d57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53868047d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5386807550>]}


============================== 05:57:58.440764 | ee62789f-20f2-43d1-b7c9-d440ef64acdc ==============================
[0m05:57:58.440764 [info ] [MainThread]: Running with dbt=1.7.11
[0m05:57:58.443819 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False'}
[0m05:57:58.753624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee62789f-20f2-43d1-b7c9-d440ef64acdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53869e81d0>]}
[0m05:57:59.991730 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: 'dbt_utils'
[0m05:58:00.006524 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 492, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/deps.py", line 228, in run
    system.rmtree(self.project.packages_install_path)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/clients/system.py", line 570, in rmtree
    return shutil.rmtree(path, onerror=chmod_and_retry)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/shutil.py", line 752, in rmtree
    _rmtree_safe_fd(fd, path, onerror)
  File "/usr/local/lib/python3.11/shutil.py", line 683, in _rmtree_safe_fd
    onerror(os.rmdir, fullname, sys.exc_info())
  File "/usr/local/lib/python3.11/shutil.py", line 681, in _rmtree_safe_fd
    os.rmdir(entry.name, dir_fd=topfd)
PermissionError: [Errno 13] Permission denied: 'dbt_utils'

[0m05:58:00.013167 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 1.7176071, "process_user_time": 4.351382, "process_kernel_time": 0.306574, "process_mem_max_rss": "99168", "process_in_blocks": "41032", "command_success": false, "process_out_blocks": "0"}
[0m05:58:00.022357 [debug] [MainThread]: Command `dbt deps` failed at 05:58:00.021482 after 1.73 seconds
[0m05:58:00.026224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53869e8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53869ea590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5387aede50>]}
[0m05:58:00.031096 [debug] [MainThread]: Flushing usage events
[0m05:59:10.911769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0304613c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0304610fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0304612290>]}


============================== 05:59:10.916983 | 2ca10f2a-6e21-4c80-8855-e7c2ba969bc7 ==============================
[0m05:59:10.916983 [info ] [MainThread]: Running with dbt=1.7.11
[0m05:59:10.919931 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m05:59:12.038672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ca10f2a-6e21-4c80-8855-e7c2ba969bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03052c8b50>]}
[0m05:59:12.198313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ca10f2a-6e21-4c80-8855-e7c2ba969bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03052c8b50>]}
[0m05:59:12.201495 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m05:59:12.239722 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /usr/local/airflow/include/dbt/dbt_packages/dbt_utils/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /usr/local/airflow/include/dbt/dbt_packages/dbt_utils
[0m05:59:12.243189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4789389, "process_user_time": 4.210393, "process_kernel_time": 0.179165, "process_mem_max_rss": "117428", "process_in_blocks": "21528", "command_success": false, "process_out_blocks": "0"}
[0m05:59:12.245792 [debug] [MainThread]: Command `dbt run` failed at 05:59:12.245364 after 1.48 seconds
[0m05:59:12.248082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03045f4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03045f6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03034cda10>]}
[0m05:59:12.251197 [debug] [MainThread]: Flushing usage events
[0m06:02:38.285377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb48cc6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb478e05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb478e3950>]}


============================== 06:02:38.292225 | 47bd8068-92de-496a-855a-b57bdd587078 ==============================
[0m06:02:38.292225 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:02:38.296413 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'invocation_command': 'dbt deps', 'write_json': 'True', 'no_print': 'None'}
[0m06:02:38.491397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47bd8068-92de-496a-855a-b57bdd587078', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb47999150>]}
[0m06:02:38.535291 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2vixkcs5'
[0m06:02:38.538009 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:02:38.979205 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:02:38.985468 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:02:39.173869 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:02:39.191704 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:02:53.328071 [info ] [MainThread]: Installed from version 1.1.1
[0m06:02:53.333482 [info ] [MainThread]: Up to date!
[0m06:02:53.339807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '47bd8068-92de-496a-855a-b57bdd587078', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb47f78390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb47f783d0>]}
[0m06:02:53.349072 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 15.21077, "process_user_time": 3.255324, "process_kernel_time": 0.671097, "process_mem_max_rss": "101088", "process_out_blocks": "200", "process_in_blocks": "0"}
[0m06:02:53.356106 [debug] [MainThread]: Command `dbt deps` succeeded at 06:02:53.354716 after 15.22 seconds
[0m06:02:53.362137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4be77290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4be771d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb4bfb1d50>]}
[0m06:02:53.368052 [debug] [MainThread]: Flushing usage events
[0m06:03:10.284171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e722ec2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e71c91790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e71c36950>]}


============================== 06:03:10.291108 | 750c68ef-352f-49ef-a34b-079ccc8dcb8f ==============================
[0m06:03:10.291108 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:03:10.295316 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80'}
[0m06:03:10.831343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e70bcdd50>]}
[0m06:03:10.969209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e71c79890>]}
[0m06:03:10.971747 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m06:03:11.031683 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m06:03:14.551198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m06:03:14.556478 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m06:03:14.559605 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m06:03:14.562605 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m06:03:14.565528 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m06:03:14.568449 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m06:03:15.035260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e708a8bd0>]}
[0m06:03:15.097522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e70841610>]}
[0m06:03:15.100012 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m06:03:15.102537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7084ea10>]}
[0m06:03:15.107891 [info ] [MainThread]: 
[0m06:03:15.111212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:03:15.115408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m06:03:15.140952 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m06:03:15.142874 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m06:03:15.144540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:03:16.284364 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:03:16.294331 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m06:03:16.503061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m06:03:16.547750 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m06:03:16.552782 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m06:03:16.557762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:03:17.267667 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:03:17.277532 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m06:03:17.468909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e70a70f50>]}
[0m06:03:17.474913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:03:17.479815 [info ] [MainThread]: 
[0m06:03:17.493919 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m06:03:17.500120 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m06:03:17.511444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m06:03:17.518268 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m06:03:17.575289 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m06:03:17.614252 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 06:03:17.523733 => 06:03:17.612869
[0m06:03:17.619211 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m06:03:17.736959 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m06:03:17.756201 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m06:03:17.758220 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m06:03:17.760275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:18.289027 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2ab-0000-000a-0000-00000f493a39
[0m06:03:18.292755 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m06:03:18.296835 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 06:03:17.623833 => 06:03:18.295962
[0m06:03:18.300482 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m06:03:18.499153 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:03:18.504984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e701ad890>]}
[0m06:03:18.511845 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.00s]
[0m06:03:18.519325 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m06:03:18.525929 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m06:03:18.535884 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m06:03:18.544209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m06:03:18.551396 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m06:03:18.574550 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m06:03:18.618976 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 06:03:18.556544 => 06:03:18.617365
[0m06:03:18.624693 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m06:03:18.644490 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m06:03:18.693514 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m06:03:18.699524 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m06:03:18.705519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:19.384348 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2ab-0000-000a-0000-00000f493a3d
[0m06:03:19.389810 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m06:03:19.395771 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 06:03:18.629361 => 06:03:19.394520
[0m06:03:19.401138 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m06:03:19.602457 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:03:19.607721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e70d68790>]}
[0m06:03:19.613240 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.07s]
[0m06:03:19.619797 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m06:03:19.625136 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m06:03:19.631175 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m06:03:19.639225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m06:03:19.645179 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m06:03:19.680404 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m06:03:19.722042 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 06:03:19.649928 => 06:03:19.720563
[0m06:03:19.727062 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m06:03:19.745081 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m06:03:19.788573 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m06:03:19.793826 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m06:03:19.799122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:03:20.367566 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2ab-0000-000a-0000-00000f493a41
[0m06:03:20.371455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m06:03:20.375859 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 06:03:19.731216 => 06:03:20.374895
[0m06:03:20.379547 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m06:03:20.576597 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:03:20.582010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750c68ef-352f-49ef-a34b-079ccc8dcb8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e68e88c10>]}
[0m06:03:20.587717 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.94s]
[0m06:03:20.594810 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m06:03:20.602742 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m06:03:20.607799 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m06:03:20.613009 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m06:03:20.626635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:03:20.631175 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m06:03:20.635860 [info ] [MainThread]: 
[0m06:03:20.641132 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m06:03:20.652186 [debug] [MainThread]: Command end result
[0m06:03:20.770880 [info ] [MainThread]: 
[0m06:03:20.775935 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:03:20.781032 [info ] [MainThread]: 
[0m06:03:20.786964 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:03:20.793490 [info ] [MainThread]: 
[0m06:03:20.800527 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:03:20.807961 [info ] [MainThread]: 
[0m06:03:20.813368 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:03:20.819142 [info ] [MainThread]: 
[0m06:03:20.826344 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:03:20.834417 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.663519, "process_user_time": 5.639998, "process_kernel_time": 0.536197, "process_mem_max_rss": "136388", "process_in_blocks": "5344", "process_out_blocks": "8", "command_success": false}
[0m06:03:20.840184 [debug] [MainThread]: Command `dbt run` failed at 06:03:20.839246 after 10.67 seconds
[0m06:03:20.845149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e722ecad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e71c3e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e76311d10>]}
[0m06:03:20.849757 [debug] [MainThread]: Flushing usage events
[0m06:07:03.967774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d042250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d6d42d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d042690>]}


============================== 06:07:03.975462 | 315760e5-12c3-4261-8dd7-515d5c620f19 ==============================
[0m06:07:03.975462 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:07:03.979394 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m06:07:04.590604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c188450>]}
[0m06:07:04.774053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d065850>]}
[0m06:07:04.776459 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m06:07:04.844356 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m06:07:09.487859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:07:09.493266 [debug] [MainThread]: Partial parsing: added file: retail://models/transform/t_sources.yml
[0m06:07:09.694166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63bd95a90>]}
[0m06:07:09.760794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63bea07d0>]}
[0m06:07:09.764161 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m06:07:09.767844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63bf43c50>]}
[0m06:07:09.775445 [info ] [MainThread]: 
[0m06:07:09.781517 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:07:09.789704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m06:07:09.863483 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m06:07:09.868398 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m06:07:09.873088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:11.147499 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:07:11.158917 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m06:07:11.396350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m06:07:11.442354 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m06:07:11.447701 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m06:07:11.452840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:07:12.061228 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:07:12.071046 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m06:07:12.264685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c09ab50>]}
[0m06:07:12.272187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:07:12.277430 [info ] [MainThread]: 
[0m06:07:12.293329 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m06:07:12.300794 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m06:07:12.309820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m06:07:12.315491 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m06:07:12.415667 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m06:07:12.442509 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 06:07:12.321267 => 06:07:12.441553
[0m06:07:12.446148 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m06:07:12.553227 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m06:07:12.575971 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m06:07:12.578624 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m06:07:12.581070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:13.173843 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2af-0000-000a-0000-00000f493a45
[0m06:07:13.179737 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m06:07:13.186451 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 06:07:12.449137 => 06:07:13.184661
[0m06:07:13.192488 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m06:07:13.408258 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:07:13.414154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63be46910>]}
[0m06:07:13.420653 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.11s]
[0m06:07:13.428007 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m06:07:13.434290 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m06:07:13.442530 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m06:07:13.450337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m06:07:13.456926 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m06:07:13.479841 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m06:07:13.524883 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 06:07:13.461986 => 06:07:13.523310
[0m06:07:13.530283 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m06:07:13.555465 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m06:07:13.603244 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m06:07:13.609391 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m06:07:13.615261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:14.400053 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2af-0000-000a-0000-00000f493a49
[0m06:07:14.406145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m06:07:14.412463 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 06:07:13.534823 => 06:07:14.411066
[0m06:07:14.417995 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m06:07:14.620992 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:07:14.627279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63da63750>]}
[0m06:07:14.633803 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.18s]
[0m06:07:14.640493 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m06:07:14.646264 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m06:07:14.652355 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m06:07:14.660574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m06:07:14.666263 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m06:07:14.700284 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m06:07:14.745921 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 06:07:14.671639 => 06:07:14.744207
[0m06:07:14.751410 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m06:07:14.770838 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m06:07:14.816774 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m06:07:14.822636 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m06:07:14.828434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:07:15.419805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2af-0000-000a-0000-00000f493a4d
[0m06:07:15.424854 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m06:07:15.430852 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 06:07:14.755794 => 06:07:15.429334
[0m06:07:15.435725 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m06:07:15.640823 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:07:15.647066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '315760e5-12c3-4261-8dd7-515d5c620f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c03ad50>]}
[0m06:07:15.654054 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.99s]
[0m06:07:15.662060 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m06:07:15.670428 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m06:07:15.676109 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m06:07:15.682369 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m06:07:15.695480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:07:15.700532 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m06:07:15.705593 [info ] [MainThread]: 
[0m06:07:15.712046 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m06:07:15.724655 [debug] [MainThread]: Command end result
[0m06:07:15.844502 [info ] [MainThread]: 
[0m06:07:15.850263 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:07:15.856797 [info ] [MainThread]: 
[0m06:07:15.863669 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:07:15.871430 [info ] [MainThread]: 
[0m06:07:15.879329 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:07:15.885809 [info ] [MainThread]: 
[0m06:07:15.892604 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:07:15.899474 [info ] [MainThread]: 
[0m06:07:15.906224 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:07:15.921474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.132124, "process_user_time": 6.04649, "process_kernel_time": 0.423451, "process_mem_max_rss": "132288", "process_in_blocks": "3872", "process_out_blocks": "8", "command_success": false}
[0m06:07:15.928546 [debug] [MainThread]: Command `dbt run` failed at 06:07:15.927350 after 12.14 seconds
[0m06:07:15.934053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63d03dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6415bf150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63da46010>]}
[0m06:07:15.939894 [debug] [MainThread]: Flushing usage events
[0m06:07:55.936935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27faa1290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27faf3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd28073ad50>]}


============================== 06:07:55.943940 | fcf31db9-3778-47ce-83eb-ab65bf2e29f8 ==============================
[0m06:07:55.943940 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:07:55.948072 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m06:07:56.462282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27eadf190>]}
[0m06:07:56.619374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27ebd9fd0>]}
[0m06:07:56.622301 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m06:07:56.686501 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m06:07:58.334757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:07:58.337072 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m06:07:58.601927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27eadf090>]}
[0m06:07:58.654341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27e53c750>]}
[0m06:07:58.656437 [info ] [MainThread]: Found 4 models, 4 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m06:07:58.658432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27ebb7310>]}
[0m06:07:58.662177 [info ] [MainThread]: 
[0m06:07:58.664529 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:07:58.667825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m06:07:58.698687 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m06:07:58.701576 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m06:07:58.704555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:07:59.683723 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:07:59.694032 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m06:07:59.906086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m06:07:59.953058 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m06:07:59.959092 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m06:07:59.964531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:00.805182 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:08:00.816278 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m06:08:01.010162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27e9faad0>]}
[0m06:08:01.017128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:08:01.022251 [info ] [MainThread]: 
[0m06:08:01.038785 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m06:08:01.045415 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m06:08:01.053186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m06:08:01.059243 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m06:08:01.122864 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m06:08:01.169289 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 06:08:01.064968 => 06:08:01.167610
[0m06:08:01.174736 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m06:08:01.320784 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m06:08:01.360964 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m06:08:01.366909 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m06:08:01.372581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:02.099056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2b0-0000-000f-0000-00000f4929e1
[0m06:08:02.105263 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m06:08:02.111606 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 06:08:01.179244 => 06:08:02.110224
[0m06:08:02.117383 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m06:08:02.319848 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:08:02.325724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27ebb6d90>]}
[0m06:08:02.332270 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.27s]
[0m06:08:02.339798 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m06:08:02.345819 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m06:08:02.353605 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m06:08:02.361494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m06:08:02.367640 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m06:08:02.389240 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m06:08:02.435893 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 06:08:02.372459 => 06:08:02.434266
[0m06:08:02.441419 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m06:08:02.461098 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m06:08:02.512569 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m06:08:02.518897 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m06:08:02.524778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:03.140959 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2b0-0000-000a-0000-00000f493a55
[0m06:08:03.147307 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m06:08:03.154310 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 06:08:02.445955 => 06:08:03.152768
[0m06:08:03.160460 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m06:08:03.395140 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:08:03.401414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd281264410>]}
[0m06:08:03.408802 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.04s]
[0m06:08:03.415881 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m06:08:03.421683 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m06:08:03.427565 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m06:08:03.436979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m06:08:03.443854 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m06:08:03.475308 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m06:08:03.521508 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 06:08:03.448462 => 06:08:03.519999
[0m06:08:03.527048 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m06:08:03.546491 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m06:08:03.594038 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m06:08:03.599761 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m06:08:03.605872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:04.285270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2b0-0000-000f-0000-00000f4929e5
[0m06:08:04.293833 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m06:08:04.302072 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 06:08:03.531792 => 06:08:04.300246
[0m06:08:04.308623 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m06:08:04.528122 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:08:04.534029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf31db9-3778-47ce-83eb-ab65bf2e29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27eaa67d0>]}
[0m06:08:04.540154 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 1.10s]
[0m06:08:04.547903 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m06:08:04.556713 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m06:08:04.562429 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m06:08:04.569773 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m06:08:04.584480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:04.589980 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m06:08:04.595938 [info ] [MainThread]: 
[0m06:08:04.602562 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m06:08:04.613432 [debug] [MainThread]: Command end result
[0m06:08:04.735365 [info ] [MainThread]: 
[0m06:08:04.740885 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:08:04.746022 [info ] [MainThread]: 
[0m06:08:04.752115 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:08:04.759483 [info ] [MainThread]: 
[0m06:08:04.765797 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:08:04.771595 [info ] [MainThread]: 
[0m06:08:04.777651 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:08:04.784139 [info ] [MainThread]: 
[0m06:08:04.791247 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:08:04.798707 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.0297785, "process_user_time": 5.74426, "process_kernel_time": 0.368988, "process_mem_max_rss": "132936", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m06:08:04.805207 [debug] [MainThread]: Command `dbt run` failed at 06:08:04.804151 after 9.04 seconds
[0m06:08:04.810970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27faf3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2800c5ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27e5e07d0>]}
[0m06:08:04.817157 [debug] [MainThread]: Flushing usage events
[0m06:10:57.051481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ffc65950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6700763d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ffaaed90>]}


============================== 06:10:57.061972 | b42f0997-1f52-458a-bedb-1b565a4efbed ==============================
[0m06:10:57.061972 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:10:57.067875 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'introspect': 'True', 'warn_error': 'None'}
[0m06:10:57.729579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66feab3650>]}
[0m06:10:57.977011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ffad17d0>]}
[0m06:10:57.981297 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m06:10:58.083980 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m06:11:02.783118 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 5 files changed.
[0m06:11:02.788985 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m06:11:02.793535 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m06:11:02.797564 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m06:11:02.801800 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m06:11:02.805853 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m06:11:03.297497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66feab3650>]}
[0m06:11:03.396908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fe991dd0>]}
[0m06:11:03.401805 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m06:11:03.406642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fe6c1050>]}
[0m06:11:03.416191 [info ] [MainThread]: 
[0m06:11:03.422160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:11:03.430575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m06:11:03.504417 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m06:11:03.509401 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m06:11:03.513861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:11:04.613310 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:11:04.623138 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m06:11:04.814340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m06:11:04.864277 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m06:11:04.870071 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m06:11:04.875403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:11:05.761535 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m06:11:05.772185 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m06:11:05.981150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fe608d10>]}
[0m06:11:05.987764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:11:05.992667 [info ] [MainThread]: 
[0m06:11:06.009377 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m06:11:06.015674 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m06:11:06.024557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m06:11:06.031480 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m06:11:06.120395 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m06:11:06.164100 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 06:11:06.036477 => 06:11:06.162429
[0m06:11:06.170144 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m06:11:06.358212 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m06:11:06.405749 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m06:11:06.411767 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m06:11:06.418032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:07.081252 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2b3-0000-000a-0000-00000f493a5d
[0m06:11:07.085923 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m06:11:07.091797 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 06:11:06.174499 => 06:11:07.090322
[0m06:11:07.096344 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m06:11:07.309622 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:11:07.315033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fe8c2b50>]}
[0m06:11:07.320897 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.29s]
[0m06:11:07.327748 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m06:11:07.333233 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m06:11:07.341074 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m06:11:07.350040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m06:11:07.356781 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m06:11:07.381202 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m06:11:07.422978 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 06:11:07.362018 => 06:11:07.421422
[0m06:11:07.428411 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m06:11:07.447062 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m06:11:07.482862 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m06:11:07.485694 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m06:11:07.488323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:07.958552 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2b3-0000-000f-0000-00000f4929ed
[0m06:11:07.961888 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m06:11:07.965329 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 06:11:07.432641 => 06:11:07.964566
[0m06:11:07.967906 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m06:11:08.149414 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:11:08.155380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fcc0c410>]}
[0m06:11:08.162700 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.81s]
[0m06:11:08.172700 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m06:11:08.181262 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m06:11:08.190482 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m06:11:08.203134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m06:11:08.211944 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m06:11:08.254306 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m06:11:08.301573 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 06:11:08.220565 => 06:11:08.299717
[0m06:11:08.306931 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m06:11:08.326403 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m06:11:08.375160 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m06:11:08.381291 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m06:11:08.387287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:11:08.973155 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2b3-0000-000a-0000-00000f493a61
[0m06:11:08.978871 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m06:11:08.985576 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 06:11:08.311058 => 06:11:08.983922
[0m06:11:08.991016 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m06:11:09.180646 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:11:09.185051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b42f0997-1f52-458a-bedb-1b565a4efbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fe816dd0>]}
[0m06:11:09.189602 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.99s]
[0m06:11:09.194725 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m06:11:09.199996 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m06:11:09.204093 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m06:11:09.211136 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m06:11:09.222469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:11:09.226519 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m06:11:09.230713 [info ] [MainThread]: 
[0m06:11:09.235379 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m06:11:09.243508 [debug] [MainThread]: Command end result
[0m06:11:09.339865 [info ] [MainThread]: 
[0m06:11:09.343861 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:11:09.347677 [info ] [MainThread]: 
[0m06:11:09.351860 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m06:11:09.356827 [info ] [MainThread]: 
[0m06:11:09.361170 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m06:11:09.365364 [info ] [MainThread]: 
[0m06:11:09.369893 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m06:11:09.374651 [info ] [MainThread]: 
[0m06:11:09.380284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:11:09.387166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.5104885, "process_user_time": 6.10067, "process_kernel_time": 0.510845, "process_mem_max_rss": "134900", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m06:11:09.392617 [debug] [MainThread]: Command `dbt run` failed at 06:11:09.391570 after 12.52 seconds
[0m06:11:09.397111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ffc65850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66ffa96fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6703ed72d0>]}
[0m06:11:09.401333 [debug] [MainThread]: Flushing usage events
[0m07:23:00.947577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65be3dc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bdf75e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bdf55050>]}


============================== 07:23:00.950150 | aa87363a-60ba-4a27-bdec-5c5e2cf438b7 ==============================
[0m07:23:00.950150 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:23:00.952394 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'version_check': 'True', 'printer_width': '80'}
[0m07:23:01.292527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa87363a-60ba-4a27-bdec-5c5e2cf438b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bdfa1ed0>]}
[0m07:23:01.379109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa87363a-60ba-4a27-bdec-5c5e2cf438b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bdfa1d90>]}
[0m07:23:01.380980 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:23:01.419763 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:23:02.193902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:23:02.195310 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m07:23:02.438530 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.dim_customer' (models/transform/dim_customer.sql) depends on a source named 'retail.country' which was not found
[0m07:23:02.441559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.5469629, "process_user_time": 2.628904, "process_kernel_time": 0.223304, "process_mem_max_rss": "125708", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:23:02.443438 [debug] [MainThread]: Command `dbt run` failed at 07:23:02.443245 after 1.55 seconds
[0m07:23:02.445137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65be3dc5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bdf65b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bcea1c50>]}
[0m07:23:02.446614 [debug] [MainThread]: Flushing usage events
[0m07:23:40.803452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a354650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a3a6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a3a7290>]}


============================== 07:23:40.806018 | ab742a4a-936c-4998-9513-20d91f909d18 ==============================
[0m07:23:40.806018 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:23:40.808520 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m07:23:41.126285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8937a550>]}
[0m07:23:41.211280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8949e110>]}
[0m07:23:41.212981 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:23:41.251954 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:23:42.063030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:23:42.064637 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m07:23:42.328973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a893d4e50>]}
[0m07:23:42.361274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a88f24490>]}
[0m07:23:42.362511 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:23:42.363922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a88f661d0>]}
[0m07:23:42.367187 [info ] [MainThread]: 
[0m07:23:42.369542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:23:42.372477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:23:42.389350 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:23:42.390619 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:23:42.391810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:43.342049 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:23:43.344812 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:23:43.555318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:23:43.565692 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:23:43.567115 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:23:43.568586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:23:44.073145 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m07:23:44.075896 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:23:44.248596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a893ed710>]}
[0m07:23:44.252961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:23:44.256335 [info ] [MainThread]: 
[0m07:23:44.262547 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m07:23:44.264150 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m07:23:44.266582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m07:23:44.268302 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m07:23:44.281012 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m07:23:44.295048 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 07:23:44.269652 => 07:23:44.294571
[0m07:23:44.296886 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m07:23:44.335972 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m07:23:44.347837 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m07:23:44.349168 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_D.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_D.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m07:23:44.350459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:44.819740 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fb-0000-000f-0000-00000f4929f9
[0m07:23:44.821659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'ASTRO_SDK_D' does not exist or not authorized.
[0m07:23:44.823590 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 07:23:44.298112 => 07:23:44.823276
[0m07:23:44.825112 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m07:23:44.996614 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_D' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:23:44.998381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a891ad610>]}
[0m07:23:45.000111 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.73s]
[0m07:23:45.002308 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m07:23:45.003968 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m07:23:45.005900 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m07:23:45.008438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m07:23:45.010210 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m07:23:45.016825 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m07:23:45.028995 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 07:23:45.011889 => 07:23:45.028564
[0m07:23:45.030406 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m07:23:45.035496 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m07:23:45.047923 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m07:23:45.049328 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_D.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m07:23:45.050568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:45.528806 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fb-0000-000f-0000-00000f4929fd
[0m07:23:45.530403 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m07:23:45.532185 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 07:23:45.031572 => 07:23:45.531880
[0m07:23:45.533720 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m07:23:45.706391 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m07:23:45.708253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a89413350>]}
[0m07:23:45.710036 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.70s]
[0m07:23:45.712004 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m07:23:45.713795 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m07:23:45.715487 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m07:23:45.718715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m07:23:45.720989 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m07:23:45.729570 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m07:23:45.743337 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 07:23:45.722865 => 07:23:45.742860
[0m07:23:45.744679 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m07:23:45.749417 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m07:23:45.762710 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m07:23:45.764094 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_D.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m07:23:45.765435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:46.259133 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fb-0000-000f-0000-00000f492a01
[0m07:23:46.265827 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'ASTRO_SDK_D' does not exist or not authorized.
[0m07:23:46.273016 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 07:23:45.745717 => 07:23:46.271386
[0m07:23:46.278474 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m07:23:46.460684 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_D' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m07:23:46.462740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab742a4a-936c-4998-9513-20d91f909d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a88f529d0>]}
[0m07:23:46.464847 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.74s]
[0m07:23:46.466972 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m07:23:46.469708 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m07:23:46.471536 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m07:23:46.473510 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m07:23:46.477390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:46.478940 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m07:23:46.480313 [info ] [MainThread]: 
[0m07:23:46.481849 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m07:23:46.484781 [debug] [MainThread]: Command end result
[0m07:23:46.516165 [info ] [MainThread]: 
[0m07:23:46.518098 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:23:46.520175 [info ] [MainThread]: 
[0m07:23:46.522356 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_D' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:23:46.524449 [info ] [MainThread]: 
[0m07:23:46.526001 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m07:23:46.527585 [info ] [MainThread]: 
[0m07:23:46.529052 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  002003 (02000): SQL compilation error:
  Database 'ASTRO_SDK_D' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m07:23:46.530399 [info ] [MainThread]: 
[0m07:23:46.532045 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:23:46.533816 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.786972, "process_user_time": 3.150396, "process_kernel_time": 0.088328, "process_mem_max_rss": "136300", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:23:46.535267 [debug] [MainThread]: Command `dbt run` failed at 07:23:46.535057 after 5.79 seconds
[0m07:23:46.536686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a97dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8a35de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a8ea29d10>]}
[0m07:23:46.538070 [debug] [MainThread]: Flushing usage events
[0m07:24:04.978001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f27f88d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f2168e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f2169250>]}


============================== 07:24:04.980585 | 32756f0c-bf02-4fc1-b9cb-57fa163cc60a ==============================
[0m07:24:04.980585 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:24:04.982667 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'warn_error': 'None', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True'}
[0m07:24:05.336836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f12cec90>]}
[0m07:24:05.422237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f21899d0>]}
[0m07:24:05.423900 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:24:05.460439 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:24:06.236631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:24:06.238170 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m07:24:06.502407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93db335a50>]}
[0m07:24:06.538042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0d52b90>]}
[0m07:24:06.539238 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:24:06.540558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0d619d0>]}
[0m07:24:06.543306 [info ] [MainThread]: 
[0m07:24:06.545582 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:24:06.548462 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:24:06.567908 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:24:06.569589 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:24:06.571106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:24:07.292312 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:24:07.294938 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:24:07.458523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:24:07.469043 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:24:07.470447 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:24:07.471809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:24:07.949799 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:24:07.953238 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:24:08.116460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0dbd390>]}
[0m07:24:08.118371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:24:08.120012 [info ] [MainThread]: 
[0m07:24:08.123489 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m07:24:08.125007 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m07:24:08.126739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m07:24:08.128194 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m07:24:08.140478 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m07:24:08.150325 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 07:24:08.129447 => 07:24:08.149910
[0m07:24:08.151525 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m07:24:08.189749 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m07:24:08.202526 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m07:24:08.203988 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m07:24:08.205357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:08.715232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fc-0000-000f-0000-00000f492a0d
[0m07:24:08.716886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m07:24:08.718547 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 07:24:08.152396 => 07:24:08.718241
[0m07:24:08.720005 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m07:24:08.910957 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:24:08.914506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f0fa6050>]}
[0m07:24:08.917796 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.79s]
[0m07:24:08.921077 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m07:24:08.923631 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m07:24:08.926683 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m07:24:08.929162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m07:24:08.931054 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m07:24:08.937258 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m07:24:08.949480 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 07:24:08.932631 => 07:24:08.948863
[0m07:24:08.950934 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m07:24:08.957607 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m07:24:08.972427 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m07:24:08.974301 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m07:24:08.975892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:09.453957 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fc-0000-000f-0000-00000f492a11
[0m07:24:09.456277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m07:24:09.458642 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 07:24:08.952231 => 07:24:09.458329
[0m07:24:09.460143 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m07:24:09.649516 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m07:24:09.651270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f11b0390>]}
[0m07:24:09.652992 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.72s]
[0m07:24:09.655404 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m07:24:09.657134 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m07:24:09.658691 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m07:24:09.661114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m07:24:09.663148 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m07:24:09.671644 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m07:24:09.685005 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 07:24:09.664610 => 07:24:09.684526
[0m07:24:09.686670 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m07:24:09.691681 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m07:24:09.708478 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m07:24:09.710100 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m07:24:09.711824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:24:10.243408 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fc-0000-000a-0000-00000f493a65
[0m07:24:10.245202 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m07:24:10.247062 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 07:24:09.687797 => 07:24:10.246722
[0m07:24:10.248558 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m07:24:10.429302 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m07:24:10.433105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32756f0c-bf02-4fc1-b9cb-57fa163cc60a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f12bded0>]}
[0m07:24:10.436492 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.77s]
[0m07:24:10.439823 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m07:24:10.443291 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m07:24:10.445560 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m07:24:10.447875 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m07:24:10.452000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:24:10.453825 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m07:24:10.455534 [info ] [MainThread]: 
[0m07:24:10.457136 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m07:24:10.459749 [debug] [MainThread]: Command end result
[0m07:24:10.494103 [info ] [MainThread]: 
[0m07:24:10.496173 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:24:10.498382 [info ] [MainThread]: 
[0m07:24:10.500318 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:24:10.501930 [info ] [MainThread]: 
[0m07:24:10.504283 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m07:24:10.506353 [info ] [MainThread]: 
[0m07:24:10.508810 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m07:24:10.510868 [info ] [MainThread]: 
[0m07:24:10.513422 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:24:10.516059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.594304, "process_user_time": 3.282975, "process_kernel_time": 0.200793, "process_mem_max_rss": "136472", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:24:10.518279 [debug] [MainThread]: Command `dbt run` failed at 07:24:10.518034 after 5.60 seconds
[0m07:24:10.520060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f27f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f21a3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f122c250>]}
[0m07:24:10.522167 [debug] [MainThread]: Flushing usage events
[0m07:25:23.987275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9a718d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9a53550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9a58790>]}


============================== 07:25:23.989660 | e215cebf-80bf-467b-ba6a-c39342c17e64 ==============================
[0m07:25:23.989660 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:25:23.991828 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:25:24.309749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e215cebf-80bf-467b-ba6a-c39342c17e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9ab3950>]}
[0m07:25:24.397667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e215cebf-80bf-467b-ba6a-c39342c17e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9a95810>]}
[0m07:25:24.399249 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:25:24.436199 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:25:24.464417 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:25:24.466218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e215cebf-80bf-467b-ba6a-c39342c17e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d8903a50>]}
[0m07:25:26.861559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e215cebf-80bf-467b-ba6a-c39342c17e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d88c3fd0>]}
[0m07:25:26.898838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e215cebf-80bf-467b-ba6a-c39342c17e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d2ca2850>]}
[0m07:25:26.900200 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:25:26.902294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e215cebf-80bf-467b-ba6a-c39342c17e64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d88b5510>]}
[0m07:25:26.905504 [info ] [MainThread]: 
[0m07:25:26.908148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:25:26.911485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_D'
[0m07:25:26.930540 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_D"
[0m07:25:26.932294 [debug] [ThreadPool]: On list_ASTRO_SDK_D: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_D"} */
show terse schemas in database ASTRO_SDK_D
    limit 10000
[0m07:25:26.934130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:27.769261 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b3a2fd-0000-000f-0000-00000f492a15
[0m07:25:27.771044 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m07:25:27.772888 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m07:25:27.774355 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m07:25:27.775937 [debug] [ThreadPool]: On list_ASTRO_SDK_D: Close
[0m07:25:27.977342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:25:27.978905 [debug] [MainThread]: Connection 'list_ASTRO_SDK_D' was properly closed.
[0m07:25:27.980410 [info ] [MainThread]: 
[0m07:25:27.982094 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m07:25:27.983884 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ASTRO_SDK_D"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m07:25:27.986142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.056764, "process_user_time": 4.01425, "process_kernel_time": 0.129814, "process_mem_max_rss": "134536", "process_in_blocks": "96", "process_out_blocks": "8", "command_success": false}
[0m07:25:27.987807 [debug] [MainThread]: Command `dbt run` failed at 07:25:27.987632 after 4.06 seconds
[0m07:25:27.989201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9aaf650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d9a583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37de095010>]}
[0m07:25:27.990640 [debug] [MainThread]: Flushing usage events
[0m07:25:56.544162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cde47cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cddeac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cde18c50>]}


============================== 07:25:56.546854 | 1f2672d7-b3d2-4564-9168-7c2c7b676afb ==============================
[0m07:25:56.546854 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:25:56.549332 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager'}
[0m07:25:56.857994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ce498950>]}
[0m07:25:56.944669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cde6d310>]}
[0m07:25:56.946496 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:25:56.993753 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:25:57.026586 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:25:57.028198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccc8a310>]}
[0m07:25:59.487920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccc065d0>]}
[0m07:25:59.522906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c70ac1d0>]}
[0m07:25:59.524073 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:25:59.525664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccd08650>]}
[0m07:25:59.528268 [info ] [MainThread]: 
[0m07:25:59.530577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:25:59.533487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:25:59.553077 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:25:59.555308 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:25:59.556831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:26:00.413673 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:26:00.416674 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:26:00.595742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:26:00.612841 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:26:00.614153 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:26:00.615390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:26:01.099471 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:26:01.103622 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:26:01.271665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccceecd0>]}
[0m07:26:01.273870 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:26:01.275480 [info ] [MainThread]: 
[0m07:26:01.279483 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m07:26:01.281282 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m07:26:01.283228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m07:26:01.284754 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m07:26:01.298987 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m07:26:01.310906 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 07:26:01.286023 => 07:26:01.310164
[0m07:26:01.312297 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m07:26:01.348249 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m07:26:01.361079 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m07:26:01.362304 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m07:26:01.363525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:02.039764 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fe-0000-000f-0000-00000f492a1d
[0m07:26:02.041473 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m07:26:02.043192 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 07:26:01.313595 => 07:26:02.042888
[0m07:26:02.044655 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m07:26:02.212040 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:26:02.213774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccc1af10>]}
[0m07:26:02.215415 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.93s]
[0m07:26:02.217981 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m07:26:02.219709 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m07:26:02.221592 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m07:26:02.223990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m07:26:02.225766 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m07:26:02.230687 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m07:26:02.241845 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 07:26:02.227134 => 07:26:02.241434
[0m07:26:02.243485 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m07:26:02.247997 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m07:26:02.260662 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m07:26:02.262743 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m07:26:02.264667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:02.751947 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fe-0000-000a-0000-00000f493a6d
[0m07:26:02.758114 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m07:26:02.764812 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 07:26:02.244522 => 07:26:02.763294
[0m07:26:02.770413 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m07:26:02.961186 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m07:26:02.963109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ccaa8950>]}
[0m07:26:02.965203 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.74s]
[0m07:26:02.967350 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m07:26:02.969331 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m07:26:02.971183 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m07:26:02.973349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m07:26:02.975524 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m07:26:02.982733 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m07:26:02.996639 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 07:26:02.977100 => 07:26:02.996239
[0m07:26:02.997929 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m07:26:03.003157 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m07:26:03.018504 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m07:26:03.020468 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		StockCode AS stock_code,
    Description AS description,
    UnitPrice AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE StockCode IS NOT NULL
AND UnitPrice > 0
        );
[0m07:26:03.022185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:26:03.502378 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a2fe-0000-000a-0000-00000f493a71
[0m07:26:03.504086 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'STOCKCODE'
[0m07:26:03.505998 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 07:26:02.999106 => 07:26:03.505656
[0m07:26:03.507754 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m07:26:03.680430 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m07:26:03.682130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f2672d7-b3d2-4564-9168-7c2c7b676afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c6fc5210>]}
[0m07:26:03.683818 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_product ............. [[31mERROR[0m in 0.71s]
[0m07:26:03.686307 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m07:26:03.688243 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m07:26:03.689745 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m07:26:03.691989 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m07:26:03.696460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:03.697919 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m07:26:03.699678 [info ] [MainThread]: 
[0m07:26:03.702002 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m07:26:03.704690 [debug] [MainThread]: Command end result
[0m07:26:03.737035 [info ] [MainThread]: 
[0m07:26:03.738402 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:26:03.739654 [info ] [MainThread]: 
[0m07:26:03.740755 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:26:03.741936 [info ] [MainThread]: 
[0m07:26:03.743274 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m07:26:03.744612 [info ] [MainThread]: 
[0m07:26:03.745779 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m07:26:03.746839 [info ] [MainThread]: 
[0m07:26:03.748041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m07:26:03.749631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.266605, "process_user_time": 4.416019, "process_kernel_time": 0.180245, "process_mem_max_rss": "137140", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:26:03.750971 [debug] [MainThread]: Command `dbt run` failed at 07:26:03.750771 after 7.27 seconds
[0m07:26:03.752040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ce498a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cddf2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94cddf0110>]}
[0m07:26:03.753361 [debug] [MainThread]: Flushing usage events
[0m07:28:45.717547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe01e7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe01c3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe15c5fd0>]}


============================== 07:28:45.720336 | 26e85987-1140-49a2-8956-ebdf4a01416e ==============================
[0m07:28:45.720336 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:28:45.722177 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s fct_invoices', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False'}
[0m07:28:46.037717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdf3112d0>]}
[0m07:28:46.122394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe02097d0>]}
[0m07:28:46.123920 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:28:46.157125 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:28:46.917647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:28:46.918541 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:28:46.926263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdf02ef50>]}
[0m07:28:46.960406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdf121dd0>]}
[0m07:28:46.961673 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:28:46.963077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdf119d90>]}
[0m07:28:46.965639 [info ] [MainThread]: 
[0m07:28:46.968068 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:28:46.971318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:28:46.988257 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:28:46.990108 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:28:46.991702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:47.853695 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:28:47.856230 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:28:48.053264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:28:48.063723 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:28:48.065226 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:28:48.066642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:48.571818 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m07:28:48.574695 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:28:48.749097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdf0801d0>]}
[0m07:28:48.751045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:28:48.752846 [info ] [MainThread]: 
[0m07:28:48.756813 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m07:28:48.758396 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m07:28:48.760131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m07:28:48.761703 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m07:28:48.790951 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m07:28:48.802610 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 07:28:48.763092 => 07:28:48.802195
[0m07:28:48.803818 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m07:28:48.838309 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m07:28:48.850452 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m07:28:48.851870 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        InvoiceNo AS invoice_id,
        InvoiceDate AS datetime_id,
        md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        Quantity AS quantity,
        Quantity * UnitPrice AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE Quantity > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
        );
[0m07:28:48.853362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:49.348280 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a300-0000-000a-0000-00000f493a7d
[0m07:28:49.349898 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.DIM_DATETIME' does not exist or not authorized.
[0m07:28:49.351633 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 07:28:48.804787 => 07:28:49.351331
[0m07:28:49.353093 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m07:28:49.540461 [debug] [Thread-1 (]: Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  002003 (42S02): SQL compilation error:
  Object 'ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.DIM_DATETIME' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m07:28:49.543845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26e85987-1140-49a2-8956-ebdf4a01416e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfdf0ec790>]}
[0m07:28:49.547073 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.fct_invoices ............ [[31mERROR[0m in 0.78s]
[0m07:28:49.550185 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m07:28:49.555788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:28:49.557601 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m07:28:49.559502 [info ] [MainThread]: 
[0m07:28:49.561309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m07:28:49.563763 [debug] [MainThread]: Command end result
[0m07:28:49.602376 [info ] [MainThread]: 
[0m07:28:49.604474 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:28:49.606276 [info ] [MainThread]: 
[0m07:28:49.608271 [error] [MainThread]:   Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  002003 (42S02): SQL compilation error:
  Object 'ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.DIM_DATETIME' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m07:28:49.610739 [info ] [MainThread]: 
[0m07:28:49.612456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:28:49.615486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.957724, "process_user_time": 2.665876, "process_kernel_time": 0.147015, "process_mem_max_rss": "131168", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:28:49.617990 [debug] [MainThread]: Command `dbt run` failed at 07:28:49.617529 after 3.96 seconds
[0m07:28:49.620135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe15c5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe021fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfe47632d0>]}
[0m07:28:49.622154 [debug] [MainThread]: Flushing usage events
[0m07:29:52.786242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab0f6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab0a3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ac3a4cd0>]}


============================== 07:29:52.788953 | b88bb57a-ec3c-4579-add4-7e157b58cb71 ==============================
[0m07:29:52.788953 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:29:52.791626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -s dim_customer', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None'}
[0m07:29:53.123657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94aa030f10>]}
[0m07:29:53.210000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab0dd390>]}
[0m07:29:53.211860 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:29:53.251816 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:29:53.994025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:53.995134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:54.001977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab11ed90>]}
[0m07:29:54.039383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94a9ff1ad0>]}
[0m07:29:54.040748 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:29:54.042324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94a9fe3e10>]}
[0m07:29:54.045073 [info ] [MainThread]: 
[0m07:29:54.047037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:29:54.049474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:29:54.066603 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:29:54.068339 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:29:54.070008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:54.902341 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:29:54.906222 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:29:55.094862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:29:55.105155 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:29:55.106648 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:29:55.108137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:55.765929 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m07:29:55.769516 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:29:55.959845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab989310>]}
[0m07:29:55.962730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:29:55.964781 [info ] [MainThread]: 
[0m07:29:55.968995 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m07:29:55.970589 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m07:29:55.972558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m07:29:55.974471 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m07:29:56.001665 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m07:29:56.016395 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 07:29:55.975832 => 07:29:56.015754
[0m07:29:56.018239 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m07:29:56.054535 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m07:29:56.067914 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m07:29:56.069336 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m07:29:56.070763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:56.611611 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a301-0000-000f-0000-00000f492a25
[0m07:29:56.617564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m07:29:56.622403 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 07:29:56.019254 => 07:29:56.621412
[0m07:29:56.625879 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m07:29:56.806618 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:29:56.808267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88bb57a-ec3c-4579-add4-7e157b58cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94a9c63f90>]}
[0m07:29:56.809904 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.84s]
[0m07:29:56.811968 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m07:29:56.815695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:29:56.817023 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m07:29:56.818350 [info ] [MainThread]: 
[0m07:29:56.820063 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m07:29:56.822603 [debug] [MainThread]: Command end result
[0m07:29:56.852827 [info ] [MainThread]: 
[0m07:29:56.854680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:29:56.856213 [info ] [MainThread]: 
[0m07:29:56.858059 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:29:56.859766 [info ] [MainThread]: 
[0m07:29:56.861838 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:29:56.864698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.137411, "process_user_time": 2.659399, "process_kernel_time": 0.131453, "process_mem_max_rss": "130828", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:29:56.866642 [debug] [MainThread]: Command `dbt run` failed at 07:29:56.866439 after 4.14 seconds
[0m07:29:56.868554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab0a2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab0f7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ab0f61d0>]}
[0m07:29:56.870227 [debug] [MainThread]: Flushing usage events
[0m07:43:48.183662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b981d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b9ea8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59bc428090>]}


============================== 07:43:48.186419 | 494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c ==============================
[0m07:43:48.186419 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:43:48.188775 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'invocation_command': 'dbt run -s dim_customer', 'fail_fast': 'False', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m07:43:48.516543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b883f8d0>]}
[0m07:43:48.627537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b9841650>]}
[0m07:43:48.629259 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:43:48.664384 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:43:49.454653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:43:49.456152 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m07:43:49.735486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b8424790>]}
[0m07:43:49.771185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b83d1f50>]}
[0m07:43:49.772378 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:43:49.773822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b83b7890>]}
[0m07:43:49.776253 [info ] [MainThread]: 
[0m07:43:49.778172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:43:49.780184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:43:49.796519 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:43:49.798646 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:43:49.800667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:50.750370 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:43:50.753132 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:43:50.952678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:43:50.967171 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:43:50.968669 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:43:50.970058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:51.833780 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m07:43:51.837770 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:43:51.995622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b8632410>]}
[0m07:43:51.997341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:51.999329 [info ] [MainThread]: 
[0m07:43:52.003625 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m07:43:52.005369 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m07:43:52.007558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m07:43:52.009329 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m07:43:52.022873 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m07:43:52.034597 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 07:43:52.010671 => 07:43:52.034171
[0m07:43:52.035956 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m07:43:52.073983 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m07:43:52.086939 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m07:43:52.088445 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.retail.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.retail.country cm ON t.country = cm.nicename
        );
[0m07:43:52.090074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:52.559460 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a30f-0000-000a-0000-00000f493a89
[0m07:43:52.564648 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
[0m07:43:52.568919 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 07:43:52.037101 => 07:43:52.568159
[0m07:43:52.572136 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m07:43:52.767559 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:43:52.771008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494bf8ef-4b57-48b5-bf58-8f2f1e6cc97c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b88c80d0>]}
[0m07:43:52.774362 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.76s]
[0m07:43:52.777722 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m07:43:52.783106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:52.784998 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m07:43:52.786965 [info ] [MainThread]: 
[0m07:43:52.788822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m07:43:52.791385 [debug] [MainThread]: Command end result
[0m07:43:52.831019 [info ] [MainThread]: 
[0m07:43:52.832523 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:43:52.833857 [info ] [MainThread]: 
[0m07:43:52.835357 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002003 (02000): SQL compilation error:
  Schema 'ASTRO_SDK_DB.RETAIL' does not exist or not authorized.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:43:52.836920 [info ] [MainThread]: 
[0m07:43:52.838261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:43:52.840047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.708348, "process_user_time": 3.18463, "process_kernel_time": 0.1927, "process_mem_max_rss": "133828", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:43:52.841762 [debug] [MainThread]: Command `dbt run` failed at 07:43:52.841573 after 4.71 seconds
[0m07:43:52.843203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b9800110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b98025d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ba4cc690>]}
[0m07:43:52.844657 [debug] [MainThread]: Flushing usage events
[0m07:58:00.126574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda2e13fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda41408d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda2dfd350>]}


============================== 07:58:00.129107 | 6baa6d21-b745-49fa-be06-3a1019de6f6b ==============================
[0m07:58:00.129107 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:58:00.131349 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s dim_customer', 'target_path': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m07:58:00.484302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6baa6d21-b745-49fa-be06-3a1019de6f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda1dd48d0>]}
[0m07:58:00.571966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6baa6d21-b745-49fa-be06-3a1019de6f6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda1edb0d0>]}
[0m07:58:00.573865 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:58:00.614229 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:58:01.413281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:58:01.414740 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m07:58:01.415790 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m07:58:01.701374 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.retail.dim_customer' (models/transform/dim_customer.sql) depends on a node named 'raw_invoices' in package or project 'retail' which was not found
[0m07:58:01.703511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6353475, "process_user_time": 2.819782, "process_kernel_time": 0.127725, "process_mem_max_rss": "123872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:58:01.705195 [debug] [MainThread]: Command `dbt run` failed at 07:58:01.704998 after 1.64 seconds
[0m07:58:01.706738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda2debc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda2e36490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feda2e37950>]}
[0m07:58:01.708215 [debug] [MainThread]: Flushing usage events
[0m07:58:29.857178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9ae1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9ac33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9ac2c50>]}


============================== 07:58:29.860001 | f283a0b7-f2b2-4046-b1e9-533169c3540e ==============================
[0m07:58:29.860001 [info ] [MainThread]: Running with dbt=1.7.11
[0m07:58:29.862400 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run -s dim_customer', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None'}
[0m07:58:30.176928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f8c1cc10>]}
[0m07:58:30.261167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f91594d0>]}
[0m07:58:30.262986 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m07:58:30.306934 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m07:58:31.110650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:58:31.112040 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m07:58:31.374326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f8661dd0>]}
[0m07:58:31.411061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f86c5d10>]}
[0m07:58:31.412509 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m07:58:31.414363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f86c9e90>]}
[0m07:58:31.417104 [info ] [MainThread]: 
[0m07:58:31.419146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:58:31.421339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m07:58:31.438012 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m07:58:31.440342 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m07:58:31.442312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:58:32.481508 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:58:32.484185 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m07:58:32.693438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m07:58:32.704085 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m07:58:32.705639 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m07:58:32.707110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:58:33.230479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m07:58:33.234063 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m07:58:33.463012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f9b448d0>]}
[0m07:58:33.470300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:58:33.473985 [info ] [MainThread]: 
[0m07:58:33.477796 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m07:58:33.479529 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m07:58:33.481528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m07:58:33.483119 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m07:58:33.497001 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m07:58:33.512238 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 07:58:33.484516 => 07:58:33.511195
[0m07:58:33.513992 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m07:58:33.551415 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m07:58:33.563616 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m07:58:33.564911 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    Country AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m07:58:33.566379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:58:34.086063 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a31e-0000-000a-0000-00000f493a95
[0m07:58:34.087703 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m07:58:34.089532 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 07:58:33.515148 => 07:58:34.089224
[0m07:58:34.091121 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m07:58:34.266268 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:58:34.268112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f283a0b7-f2b2-4046-b1e9-533169c3540e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f890e350>]}
[0m07:58:34.270105 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.79s]
[0m07:58:34.272092 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m07:58:34.275860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:58:34.277350 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m07:58:34.278974 [info ] [MainThread]: 
[0m07:58:34.280571 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m07:58:34.282435 [debug] [MainThread]: Command end result
[0m07:58:34.317858 [info ] [MainThread]: 
[0m07:58:34.319470 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:58:34.320927 [info ] [MainThread]: 
[0m07:58:34.322105 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m07:58:34.323281 [info ] [MainThread]: 
[0m07:58:34.324556 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:58:34.326308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5307555, "process_user_time": 2.883524, "process_kernel_time": 0.21875, "process_mem_max_rss": "136312", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m07:58:34.327824 [debug] [MainThread]: Command `dbt run` failed at 07:58:34.327611 after 4.53 seconds
[0m07:58:34.329035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84fe05b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84fe05b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84f869a990>]}
[0m07:58:34.330292 [debug] [MainThread]: Flushing usage events
[0m08:02:09.172903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc27a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc5fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc25190>]}


============================== 08:02:09.175469 | bcdfebea-6895-415e-b8e4-ab4c49b04724 ==============================
[0m08:02:09.175469 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:02:09.177882 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run -s dim_customer', 'printer_width': '80', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True'}
[0m08:02:09.510234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc03750>]}
[0m08:02:09.595980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc499d0>]}
[0m08:02:09.597808 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:02:09.639847 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:02:10.505859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:02:10.507160 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:02:10.676441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47bba67d0>]}
[0m08:02:10.716573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47b78a9d0>]}
[0m08:02:10.718138 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:02:10.719907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47b9873d0>]}
[0m08:02:10.722681 [info ] [MainThread]: 
[0m08:02:10.725050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:02:10.727348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:02:10.746399 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:02:10.748045 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:02:10.749933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:11.651788 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:02:11.661828 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:02:11.877731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:02:11.888451 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:02:11.889986 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:02:11.891410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:12.573077 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:02:12.579526 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:02:12.775692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47b9873d0>]}
[0m08:02:12.777666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:02:12.779539 [info ] [MainThread]: 
[0m08:02:12.783507 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:02:12.785279 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:02:12.787158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:02:12.788615 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:02:12.802032 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:02:12.816999 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:02:12.789957 => 08:02:12.816540
[0m08:02:12.818507 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:02:12.855485 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:02:12.869754 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:02:12.871269 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT * FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:02:12.872731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:34.480867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 22.0 seconds
[0m08:02:34.503216 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:02:12.819687 => 08:02:34.502917
[0m08:02:34.504802 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:02:34.712247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcdfebea-6895-415e-b8e4-ab4c49b04724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47b7749d0>]}
[0m08:02:34.714172 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 21.93s]
[0m08:02:34.716633 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:02:34.720456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:34.721904 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:02:34.723383 [info ] [MainThread]: 
[0m08:02:34.725225 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 24.00 seconds (24.00s).
[0m08:02:34.728079 [debug] [MainThread]: Command end result
[0m08:02:34.815447 [info ] [MainThread]: 
[0m08:02:34.816842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:34.818078 [info ] [MainThread]: 
[0m08:02:34.819399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:02:34.821004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.704512, "process_user_time": 2.778015, "process_kernel_time": 0.269807, "process_mem_max_rss": "131972", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:02:34.822201 [debug] [MainThread]: Command `dbt run` succeeded at 08:02:34.822021 after 25.71 seconds
[0m08:02:34.823210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe48119b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe48122f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47cc106d0>]}
[0m08:02:34.824292 [debug] [MainThread]: Flushing usage events
[0m08:04:13.494656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5079b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5079bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5079bd90>]}


============================== 08:04:13.497194 | 03f346bb-95bd-41b2-b5f4-e60a3fc80d7b ==============================
[0m08:04:13.497194 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:04:13.499694 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_customer', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m08:04:13.831747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4ec6e010>]}
[0m08:04:13.921622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4ec5dc10>]}
[0m08:04:13.923471 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:04:13.972661 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:04:14.710961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:04:14.712130 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:04:14.877742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4ec16110>]}
[0m08:04:14.914015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4e921b50>]}
[0m08:04:14.915266 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:04:14.916842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4eac2d50>]}
[0m08:04:14.919317 [info ] [MainThread]: 
[0m08:04:14.921669 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:04:14.923834 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:04:14.942387 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:04:14.944081 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:04:14.945746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:15.849758 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:04:15.859835 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:04:16.065947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:04:16.076435 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:04:16.077919 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:04:16.079389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:16.547653 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m08:04:16.550871 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:04:16.721116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4eb12e10>]}
[0m08:04:16.723158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:16.724967 [info ] [MainThread]: 
[0m08:04:16.728744 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:04:16.730730 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:04:16.733520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:04:16.735148 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:04:16.752004 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:04:16.769609 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:04:16.736694 => 08:04:16.768978
[0m08:04:16.772073 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:04:16.806066 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:04:16.818279 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:04:16.819633 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT SELECT DISTINCT md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:04:16.821005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:17.320501 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a324-0000-000f-0000-00000f492b21
[0m08:04:17.322151 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 7 unexpected 'SELECT'.
syntax error line 16 at position 65 unexpected ','.
[0m08:04:17.323847 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:04:16.773492 => 08:04:17.323543
[0m08:04:17.325411 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:04:17.493026 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 7 unexpected 'SELECT'.
  syntax error line 16 at position 65 unexpected ','.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:04:17.494552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03f346bb-95bd-41b2-b5f4-e60a3fc80d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4e682d10>]}
[0m08:04:17.496262 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.76s]
[0m08:04:17.498507 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:04:17.501936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:17.503302 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:04:17.504522 [info ] [MainThread]: 
[0m08:04:17.506124 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m08:04:17.508805 [debug] [MainThread]: Command end result
[0m08:04:17.592624 [info ] [MainThread]: 
[0m08:04:17.594030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:04:17.595810 [info ] [MainThread]: 
[0m08:04:17.597218 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 7 unexpected 'SELECT'.
  syntax error line 16 at position 65 unexpected ','.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:04:17.598660 [info ] [MainThread]: 
[0m08:04:17.600188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:04:17.602432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.165077, "process_user_time": 2.80809, "process_kernel_time": 0.196369, "process_mem_max_rss": "132464", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:04:17.603984 [debug] [MainThread]: Command `dbt run` failed at 08:04:17.603792 after 4.17 seconds
[0m08:04:17.605483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4fb3fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4fb3fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4e8dc2d0>]}
[0m08:04:17.606830 [debug] [MainThread]: Flushing usage events
[0m08:04:33.655181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ee036290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55eece5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55f0961b50>]}


============================== 08:04:33.658093 | c3acbb35-1b44-4f90-a83f-0fb6584e402f ==============================
[0m08:04:33.658093 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:04:33.659874 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_customer', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m08:04:33.994032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ed042b50>]}
[0m08:04:34.088563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55f0c58d50>]}
[0m08:04:34.090214 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:04:34.125714 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:04:34.942008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:04:34.943214 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:04:35.138131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ecfda910>]}
[0m08:04:35.172393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ecbf4f50>]}
[0m08:04:35.173660 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:04:35.174927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55f17608d0>]}
[0m08:04:35.177165 [info ] [MainThread]: 
[0m08:04:35.178703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:04:35.180761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:04:35.198798 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:04:35.200267 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:04:35.201690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:35.862524 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:04:35.866470 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:04:36.047340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:04:36.062584 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:04:36.064131 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:04:36.065497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:04:36.732456 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:04:36.735009 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:04:36.911389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ee04e310>]}
[0m08:04:36.913725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:36.915485 [info ] [MainThread]: 
[0m08:04:36.919788 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:04:36.921494 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:04:36.923844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:04:36.926799 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:04:36.948081 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:04:36.963887 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:04:36.928454 => 08:04:36.963080
[0m08:04:36.965889 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:04:37.010698 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:04:37.021798 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:04:37.022992 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT DISTINCT md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:04:37.024277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:04:37.534419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a324-0000-000a-0000-00000f493b65
[0m08:04:37.536041 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 39
invalid identifier 'CUSTOMERID'
[0m08:04:37.537721 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:04:36.967316 => 08:04:37.537415
[0m08:04:37.539144 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:04:37.703386 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 39
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:04:37.705136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3acbb35-1b44-4f90-a83f-0fb6584e402f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ecf0ae50>]}
[0m08:04:37.706960 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.78s]
[0m08:04:37.709390 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:04:37.713172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:37.714498 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:04:37.715938 [info ] [MainThread]: 
[0m08:04:37.717845 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m08:04:37.720233 [debug] [MainThread]: Command end result
[0m08:04:37.804927 [info ] [MainThread]: 
[0m08:04:37.806281 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:04:37.808059 [info ] [MainThread]: 
[0m08:04:37.809713 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 39
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:04:37.811755 [info ] [MainThread]: 
[0m08:04:37.813545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:04:37.815734 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.218287, "process_user_time": 3.101949, "process_kernel_time": 0.167939, "process_mem_max_rss": "132784", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:04:37.817174 [debug] [MainThread]: Command `dbt run` failed at 08:04:37.816945 after 4.22 seconds
[0m08:04:37.818682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ee6c0ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ecdd8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ecddba90>]}
[0m08:04:37.820168 [debug] [MainThread]: Flushing usage events
[0m08:07:42.762860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae5dbfb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae719df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae5dbff10>]}


============================== 08:07:42.765579 | 0e82a4f5-3422-45fa-88db-8297b04d3263 ==============================
[0m08:07:42.765579 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:07:42.768009 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run -s dim_customer', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'introspect': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_format': 'default'}
[0m08:07:43.086927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae5dab310>]}
[0m08:07:43.174328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae5dab310>]}
[0m08:07:43.176017 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:07:43.210937 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:07:43.845065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:07:43.846135 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:07:44.025494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae76bfb50>]}
[0m08:07:44.061864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae4962910>]}
[0m08:07:44.063243 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:07:44.064524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae94dce50>]}
[0m08:07:44.066884 [info ] [MainThread]: 
[0m08:07:44.068542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:07:44.070535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:07:44.087495 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:07:44.089181 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:07:44.090809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:44.998573 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:07:45.001255 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:07:45.318498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:07:45.332485 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:07:45.334425 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:07:45.336257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:45.880191 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:07:45.884458 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:07:46.053447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae49343d0>]}
[0m08:07:46.056025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:07:46.058072 [info ] [MainThread]: 
[0m08:07:46.062490 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:07:46.064273 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:07:46.066286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:07:46.067856 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:07:46.084257 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:07:46.099154 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:07:46.069297 => 08:07:46.098674
[0m08:07:46.100878 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:07:46.137569 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:07:46.148583 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:07:46.149920 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT DISTINCT md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:07:46.151279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:46.636336 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a327-0000-000a-0000-00000f493b71
[0m08:07:46.638035 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 39
invalid identifier 'CUSTOMERID'
[0m08:07:46.639761 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:07:46.101988 => 08:07:46.639457
[0m08:07:46.641332 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:07:46.832419 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 39
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:07:46.834018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e82a4f5-3422-45fa-88db-8297b04d3263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae48fffd0>]}
[0m08:07:46.835544 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.77s]
[0m08:07:46.837741 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:07:46.841303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:46.842745 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:07:46.844198 [info ] [MainThread]: 
[0m08:07:46.846016 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m08:07:46.848844 [debug] [MainThread]: Command end result
[0m08:07:46.933964 [info ] [MainThread]: 
[0m08:07:46.935209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:07:46.936319 [info ] [MainThread]: 
[0m08:07:46.937312 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 39
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:07:46.938372 [info ] [MainThread]: 
[0m08:07:46.939542 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:07:46.941020 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2416415, "process_user_time": 2.80174, "process_kernel_time": 0.151718, "process_mem_max_rss": "132400", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:07:46.942208 [debug] [MainThread]: Command `dbt run` failed at 08:07:46.942016 after 4.24 seconds
[0m08:07:46.943196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaea33b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbaea33b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbae5da3f10>]}
[0m08:07:46.944353 [debug] [MainThread]: Flushing usage events
[0m08:09:42.764391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdb1fb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdb21b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdb219e50>]}


============================== 08:09:42.766850 | 3abfb163-d915-47fc-ad8d-ad0670ccb69f ==============================
[0m08:09:42.766850 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:09:42.768907 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s dim_customer', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m08:09:43.088997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbda310090>]}
[0m08:09:43.176632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdbe94510>]}
[0m08:09:43.178301 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:09:43.217778 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:09:43.922997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:09:43.924114 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:09:44.091397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbda062d90>]}
[0m08:09:44.125046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd9c684d0>]}
[0m08:09:44.126347 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:09:44.128070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbde8fcd50>]}
[0m08:09:44.130655 [info ] [MainThread]: 
[0m08:09:44.133243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:09:44.136050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:09:44.154503 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:09:44.156129 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:09:44.157901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:45.186117 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:09:45.189114 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:09:45.357302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:09:45.367951 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:09:45.369382 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:09:45.370880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:09:46.056211 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:09:46.058956 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:09:46.225374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbda072950>]}
[0m08:09:46.227313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:09:46.229096 [info ] [MainThread]: 
[0m08:09:46.233318 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:09:46.235029 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:09:46.237501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:09:46.239684 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:09:46.256097 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:09:46.268591 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:09:46.241439 => 08:09:46.268138
[0m08:09:46.269727 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:09:46.309192 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:09:46.321822 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:09:46.323144 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT DISTINCT md5(cast(coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:09:46.324402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:09:46.849068 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a329-0000-000f-0000-00000f492b2d
[0m08:09:46.850703 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 39
invalid identifier 'COUNTRY'
[0m08:09:46.852437 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:09:46.270811 => 08:09:46.852118
[0m08:09:46.853944 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:09:47.034977 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 39
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:09:47.036758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3abfb163-d915-47fc-ad8d-ad0670ccb69f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd9b64810>]}
[0m08:09:47.038532 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.80s]
[0m08:09:47.040595 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:09:47.044664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:09:47.045903 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:09:47.047167 [info ] [MainThread]: 
[0m08:09:47.048846 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m08:09:47.051519 [debug] [MainThread]: Command end result
[0m08:09:47.139324 [info ] [MainThread]: 
[0m08:09:47.140477 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:09:47.141571 [info ] [MainThread]: 
[0m08:09:47.142630 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 39
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:09:47.143716 [info ] [MainThread]: 
[0m08:09:47.144982 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:09:47.146718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.436279, "process_user_time": 2.870623, "process_kernel_time": 0.184887, "process_mem_max_rss": "133220", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:09:47.148000 [debug] [MainThread]: Command `dbt run` failed at 08:09:47.147781 after 4.44 seconds
[0m08:09:47.149229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdf801050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbdf7ef290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd9fc7c90>]}
[0m08:09:47.150418 [debug] [MainThread]: Flushing usage events
[0m08:10:18.816424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f72dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033fc75750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f6f4950>]}


============================== 08:10:18.819168 | 7c1f2b08-9360-4a5e-8452-499049deeed7 ==============================
[0m08:10:18.819168 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:10:18.821358 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt run -s dim_customer', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m08:10:19.143661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f6f8a50>]}
[0m08:10:19.233430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f733990>]}
[0m08:10:19.235266 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:10:19.272613 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:10:20.087056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:10:20.088282 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:10:20.252216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033e3d7d50>]}
[0m08:10:20.292423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033e2bd550>]}
[0m08:10:20.293957 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:10:20.295743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033e71a350>]}
[0m08:10:20.298138 [info ] [MainThread]: 
[0m08:10:20.300841 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:10:20.303668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:10:20.320518 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:10:20.322403 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:10:20.324096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:21.126082 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:10:21.128709 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:10:21.313186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:10:21.323688 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:10:21.325170 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:10:21.326568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:10:21.973863 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:10:21.977116 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:10:22.150398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033e637d90>]}
[0m08:10:22.152389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:10:22.154134 [info ] [MainThread]: 
[0m08:10:22.158048 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:10:22.159765 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:10:22.161983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:10:22.163949 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:10:22.178973 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:10:22.191596 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:10:22.165538 => 08:10:22.190976
[0m08:10:22.193320 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:10:22.229193 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:10:22.240222 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:10:22.241452 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT md5(cast(coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:10:22.242647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:10:22.735544 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a32a-0000-000a-0000-00000f493b7d
[0m08:10:22.738015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 30
invalid identifier 'COUNTRY'
[0m08:10:22.740787 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:10:22.194142 => 08:10:22.740251
[0m08:10:22.743172 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:10:22.915212 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 30
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:10:22.916793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1f2b08-9360-4a5e-8452-499049deeed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033e4fdc10>]}
[0m08:10:22.918332 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.76s]
[0m08:10:22.920611 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:10:22.924276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:22.925556 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:10:22.926772 [info ] [MainThread]: 
[0m08:10:22.928289 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m08:10:22.931008 [debug] [MainThread]: Command end result
[0m08:10:23.019350 [info ] [MainThread]: 
[0m08:10:23.020758 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:10:23.021907 [info ] [MainThread]: 
[0m08:10:23.023246 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 30
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:10:23.024390 [info ] [MainThread]: 
[0m08:10:23.025518 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:10:23.027370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2688556, "process_user_time": 2.77643, "process_kernel_time": 0.225646, "process_mem_max_rss": "132388", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:10:23.028939 [debug] [MainThread]: Command `dbt run` failed at 08:10:23.028731 after 4.27 seconds
[0m08:10:23.030308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f72ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f72f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f033f72dc10>]}
[0m08:10:23.031946 [debug] [MainThread]: Flushing usage events
[0m08:12:18.189263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1e57a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1fe79f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1e5b7d90>]}


============================== 08:12:18.192465 | c735ff41-9766-449a-abeb-cd6f6a04cf09 ==============================
[0m08:12:18.192465 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:12:18.194821 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run -s dim_customer', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m08:12:18.509944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d577490>]}
[0m08:12:18.594282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d59ffd0>]}
[0m08:12:18.595969 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:12:18.637352 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:12:19.399704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:12:19.400945 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:12:19.579353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d10fc10>]}
[0m08:12:19.612223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d121d90>]}
[0m08:12:19.613393 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:12:19.614704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d25b810>]}
[0m08:12:19.617269 [info ] [MainThread]: 
[0m08:12:19.619037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:12:19.621131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:12:19.638031 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:12:19.639622 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:12:19.641042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:20.516379 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:12:20.522505 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:12:20.722510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:12:20.733433 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:12:20.734933 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:12:20.736329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:12:21.256271 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:12:21.265541 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:12:21.447035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d4af450>]}
[0m08:12:21.448830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:21.450764 [info ] [MainThread]: 
[0m08:12:21.455232 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:12:21.456869 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:12:21.459666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:12:21.461682 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:12:21.479066 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:12:21.494703 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:12:21.463302 => 08:12:21.494287
[0m08:12:21.496083 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:12:21.532352 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:12:21.545150 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:12:21.546822 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT md5(cast(coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as id
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:12:21.548358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:22.018504 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a32c-0000-000a-0000-00000f493b85
[0m08:12:22.020212 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 30
invalid identifier 'COUNTRY'
[0m08:12:22.021978 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:12:21.497406 => 08:12:22.021666
[0m08:12:22.023422 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:12:22.193266 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 30
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:12:22.194981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c735ff41-9766-449a-abeb-cd6f6a04cf09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d089c90>]}
[0m08:12:22.196742 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.74s]
[0m08:12:22.199069 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:12:22.202894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:22.204170 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:12:22.205885 [info ] [MainThread]: 
[0m08:12:22.208003 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m08:12:22.210866 [debug] [MainThread]: Command end result
[0m08:12:22.295438 [info ] [MainThread]: 
[0m08:12:22.296646 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:12:22.298135 [info ] [MainThread]: 
[0m08:12:22.299492 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 30
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:12:22.300896 [info ] [MainThread]: 
[0m08:12:22.302395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:12:22.304489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.179286, "process_user_time": 2.897191, "process_kernel_time": 0.190472, "process_mem_max_rss": "132908", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:12:22.305884 [debug] [MainThread]: Command `dbt run` failed at 08:12:22.305698 after 4.18 seconds
[0m08:12:22.306976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1ec08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf22b03310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf1d3d9410>]}
[0m08:12:22.308054 [debug] [MainThread]: Flushing usage events
[0m08:13:27.551742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cacda690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6caca10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6caca11d0>]}


============================== 08:13:27.554325 | fd77e8c5-14e7-4631-a526-58f77a48c04c ==============================
[0m08:13:27.554325 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:13:27.556898 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s dim_customer', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True'}
[0m08:13:27.873318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c9c8aa10>]}
[0m08:13:27.960565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cacc5ad0>]}
[0m08:13:27.962344 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:13:28.007707 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:13:28.832131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:13:28.833235 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:13:29.009835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c9caa250>]}
[0m08:13:29.045270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c9b8d950>]}
[0m08:13:29.046638 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:13:29.048245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6ce258c10>]}
[0m08:13:29.050617 [info ] [MainThread]: 
[0m08:13:29.052349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:13:29.054486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:13:29.071453 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:13:29.073070 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:13:29.074867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:29.931136 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:13:29.933783 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:13:30.144442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:13:30.154603 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:13:30.156069 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:13:30.157461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:30.868535 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:13:30.871287 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:13:31.067559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c9b5e810>]}
[0m08:13:31.069592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:13:31.071099 [info ] [MainThread]: 
[0m08:13:31.074579 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:13:31.076106 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:13:31.077913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:13:31.079326 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:13:31.092084 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:13:31.104961 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:13:31.080528 => 08:13:31.104526
[0m08:13:31.106240 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:13:31.141833 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:13:31.155210 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:13:31.156746 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT Country
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:13:31.158461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:31.688651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a32d-0000-000f-0000-00000f492b39
[0m08:13:31.690387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'COUNTRY'
[0m08:13:31.692237 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:13:31.107267 => 08:13:31.691896
[0m08:13:31.693896 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:13:31.878131 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:13:31.879697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd77e8c5-14e7-4631-a526-58f77a48c04c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c99db290>]}
[0m08:13:31.881225 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.80s]
[0m08:13:31.883608 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:13:31.887014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:31.888365 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:13:31.889568 [info ] [MainThread]: 
[0m08:13:31.891440 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m08:13:31.893761 [debug] [MainThread]: Command end result
[0m08:13:31.979138 [info ] [MainThread]: 
[0m08:13:31.980571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:13:31.982187 [info ] [MainThread]: 
[0m08:13:31.983759 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:13:31.985215 [info ] [MainThread]: 
[0m08:13:31.986891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:13:31.989263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.497988, "process_user_time": 2.826921, "process_kernel_time": 0.160963, "process_mem_max_rss": "132808", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:13:31.991031 [debug] [MainThread]: Command `dbt run` failed at 08:13:31.990832 after 4.50 seconds
[0m08:13:31.992835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c9ca32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cf0c7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6c9a5c410>]}
[0m08:13:31.994890 [debug] [MainThread]: Flushing usage events
[0m08:15:14.516202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e539140d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e54e14ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e53912b50>]}


============================== 08:15:14.519036 | a39b5115-bd9e-436b-94f9-32a279fabe8b ==============================
[0m08:15:14.519036 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:15:14.521363 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run -s dim_customer', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default'}
[0m08:15:14.848627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e52a46e10>]}
[0m08:15:14.936723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e53939810>]}
[0m08:15:14.938547 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:15:14.982666 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:15:15.715152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:15:15.716297 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:15:15.881287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e528ed450>]}
[0m08:15:15.919919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e524c2bd0>]}
[0m08:15:15.921349 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:15:15.923368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e5702ccd0>]}
[0m08:15:15.925969 [info ] [MainThread]: 
[0m08:15:15.928306 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:15:15.930760 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:15:15.947979 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:15:15.950674 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:15:15.952347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:16.822372 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:15:16.831598 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:15:17.058679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:15:17.069524 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:15:17.071068 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:15:17.072536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:15:17.597544 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:15:17.600981 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:15:17.785657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e523c2f50>]}
[0m08:15:17.791357 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:15:17.795680 [info ] [MainThread]: 
[0m08:15:17.804855 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:15:17.807236 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:15:17.809989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:15:17.811842 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:15:17.826080 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:15:17.840592 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:15:17.813447 => 08:15:17.840145
[0m08:15:17.842283 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:15:17.878059 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:15:17.888636 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:15:17.889911 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT Quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:15:17.891140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:18.429610 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a32f-0000-000a-0000-00000f493bb9
[0m08:15:18.431283 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'QUANTITY'
[0m08:15:18.433258 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:15:17.843566 => 08:15:18.432954
[0m08:15:18.434820 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:15:18.628479 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:15:18.632363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a39b5115-bd9e-436b-94f9-32a279fabe8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e52a48b50>]}
[0m08:15:18.635785 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.82s]
[0m08:15:18.639198 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:15:18.645138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:18.647020 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:15:18.648959 [info ] [MainThread]: 
[0m08:15:18.650978 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m08:15:18.653304 [debug] [MainThread]: Command end result
[0m08:15:18.742131 [info ] [MainThread]: 
[0m08:15:18.743290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:15:18.744397 [info ] [MainThread]: 
[0m08:15:18.745497 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:15:18.746559 [info ] [MainThread]: 
[0m08:15:18.747702 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:15:18.749216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.298475, "process_user_time": 2.912965, "process_kernel_time": 0.142592, "process_mem_max_rss": "132748", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:15:18.750566 [debug] [MainThread]: Command `dbt run` failed at 08:15:18.750327 after 4.30 seconds
[0m08:15:18.751695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e5394eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e5394e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e57e8b2d0>]}
[0m08:15:18.752824 [debug] [MainThread]: Flushing usage events
[0m08:16:02.713270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893428a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8934a67650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893424f7d0>]}


============================== 08:16:02.715795 | 6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe ==============================
[0m08:16:02.715795 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:16:02.718098 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_customer', 'indirect_selection': 'eager', 'version_check': 'True'}
[0m08:16:03.037883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893325a3d0>]}
[0m08:16:03.125975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8934275950>]}
[0m08:16:03.127627 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:16:03.170494 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:16:03.929629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:16:03.930530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:16:03.937381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893337d590>]}
[0m08:16:03.976448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893318de90>]}
[0m08:16:03.977957 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:16:03.979668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8933185d50>]}
[0m08:16:03.982101 [info ] [MainThread]: 
[0m08:16:03.984635 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:16:03.987120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:16:04.005695 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:16:04.007633 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:16:04.009388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:04.830614 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:16:04.833240 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:16:05.012107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:16:05.022679 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:16:05.024167 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:16:05.025641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:05.704695 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:16:05.715254 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:16:05.898235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893428c490>]}
[0m08:16:05.901270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:16:05.903083 [info ] [MainThread]: 
[0m08:16:05.906741 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:16:05.908260 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:16:05.910386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:16:05.912166 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:16:05.938640 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:16:05.952091 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:16:05.913520 => 08:16:05.951672
[0m08:16:05.953691 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:16:05.990406 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:16:06.002179 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:16:06.003416 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT Quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:16:06.004667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:06.500837 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a330-0000-000a-0000-00000f493c49
[0m08:16:06.502957 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'QUANTITY'
[0m08:16:06.505376 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:16:05.955409 => 08:16:06.504902
[0m08:16:06.507488 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:16:06.678111 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:16:06.679792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bc41a51-ba6e-40c2-afcc-ce3d5b3753fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8932de2150>]}
[0m08:16:06.681489 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.77s]
[0m08:16:06.683864 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:16:06.687457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:06.688630 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:16:06.689888 [info ] [MainThread]: 
[0m08:16:06.691377 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m08:16:06.693952 [debug] [MainThread]: Command end result
[0m08:16:06.727306 [info ] [MainThread]: 
[0m08:16:06.728948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:16:06.730611 [info ] [MainThread]: 
[0m08:16:06.732624 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:16:06.734615 [info ] [MainThread]: 
[0m08:16:06.736513 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:16:06.739278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.083891, "process_user_time": 2.670043, "process_kernel_time": 0.209219, "process_mem_max_rss": "130808", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:16:06.741301 [debug] [MainThread]: Command `dbt run` failed at 08:16:06.740951 after 4.09 seconds
[0m08:16:06.743158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893428b150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893428a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893428b550>]}
[0m08:16:06.744797 [debug] [MainThread]: Flushing usage events
[0m08:17:00.125335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996a7c7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996b8e1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996a971950>]}


============================== 08:17:00.127714 | 6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2 ==============================
[0m08:17:00.127714 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:17:00.130251 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'static_parser': 'True', 'printer_width': '80', 'invocation_command': 'dbt run -s dim_customer', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m08:17:00.443511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996b494790>]}
[0m08:17:00.529594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996a7dd950>]}
[0m08:17:00.531323 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:17:00.570474 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:17:01.347139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:17:01.348327 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:17:01.510900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9969841e10>]}
[0m08:17:01.546325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99691fed50>]}
[0m08:17:01.547679 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:17:01.549404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996dd74c10>]}
[0m08:17:01.552293 [info ] [MainThread]: 
[0m08:17:01.554696 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:17:01.557076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:17:01.573687 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:17:01.576054 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:17:01.577567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:02.499738 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:17:02.502540 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:17:02.733170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:17:02.763049 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:17:02.765300 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:17:02.767382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:03.384309 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:17:03.389323 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:17:03.619820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996989b890>]}
[0m08:17:03.621782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:17:03.623347 [info ] [MainThread]: 
[0m08:17:03.627162 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:17:03.628810 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:17:03.630816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:17:03.632512 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:17:03.646323 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:17:03.660212 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:17:03.633938 => 08:17:03.659748
[0m08:17:03.661796 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:17:03.695685 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:17:03.707934 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:17:03.709227 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT Quantity as q
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:17:03.710529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:04.420772 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a331-0000-000a-0000-00000f493c55
[0m08:17:04.426115 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'QUANTITY'
[0m08:17:04.431336 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:17:03.662953 => 08:17:04.430347
[0m08:17:04.434880 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:17:04.838739 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:17:04.840340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e55dce7-8ff1-4d78-bd1b-c7a4e37522d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99692aa110>]}
[0m08:17:04.841943 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.21s]
[0m08:17:04.844101 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:17:04.847647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:04.848987 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:17:04.850343 [info ] [MainThread]: 
[0m08:17:04.852197 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m08:17:04.854512 [debug] [MainThread]: Command end result
[0m08:17:04.937934 [info ] [MainThread]: 
[0m08:17:04.939083 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:17:04.940245 [info ] [MainThread]: 
[0m08:17:04.941257 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:17:04.942415 [info ] [MainThread]: 
[0m08:17:04.943473 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:17:04.946767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.8785152, "process_user_time": 2.869388, "process_kernel_time": 0.130426, "process_mem_max_rss": "133056", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:17:04.948181 [debug] [MainThread]: Command `dbt run` failed at 08:17:04.947968 after 4.88 seconds
[0m08:17:04.949430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996a7a2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996ebe3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f996bee85d0>]}
[0m08:17:04.950656 [debug] [MainThread]: Flushing usage events
[0m08:17:41.321364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f7222d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18fd744d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f6eaa90>]}


============================== 08:17:41.323915 | e862021b-a97a-4573-8ccb-22f2b3568039 ==============================
[0m08:17:41.323915 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:17:41.325279 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt run -s dim_customer', 'version_check': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m08:17:41.656029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e6dc990>]}
[0m08:17:41.755038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190fc88d0>]}
[0m08:17:41.756791 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:17:41.799100 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:17:42.605052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:17:42.606595 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:17:42.810597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f748c10>]}
[0m08:17:42.849347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e15e490>]}
[0m08:17:42.850797 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:17:42.852190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f6e7bd0>]}
[0m08:17:42.854558 [info ] [MainThread]: 
[0m08:17:42.856506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:17:42.858605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:17:42.875649 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:17:42.877478 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:17:42.879237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:43.678479 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:17:43.689161 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:17:43.898943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:17:43.913236 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:17:43.914863 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:17:43.916348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:44.430579 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:17:44.434290 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:17:44.599190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e289310>]}
[0m08:17:44.601720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:17:44.603745 [info ] [MainThread]: 
[0m08:17:44.608684 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:17:44.610986 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:17:44.612979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:17:44.614722 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:17:44.629233 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:17:44.640598 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:17:44.616064 => 08:17:44.639933
[0m08:17:44.642153 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:17:44.683866 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:17:44.693750 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:17:44.694923 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT 'Quantity'
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:17:44.696141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:45.387120 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a331-0000-000f-0000-00000f492bf1
[0m08:17:45.388697 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m08:17:45.390506 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:17:44.643294 => 08:17:45.390198
[0m08:17:45.392058 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:17:45.572048 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:17:45.573780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e862021b-a97a-4573-8ccb-22f2b3568039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18e2d40d0>]}
[0m08:17:45.575422 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.96s]
[0m08:17:45.577622 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:17:45.581161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:45.582473 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:17:45.583992 [info ] [MainThread]: 
[0m08:17:45.586092 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m08:17:45.588454 [debug] [MainThread]: Command end result
[0m08:17:45.674302 [info ] [MainThread]: 
[0m08:17:45.675570 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:17:45.676797 [info ] [MainThread]: 
[0m08:17:45.677981 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:17:45.679116 [info ] [MainThread]: 
[0m08:17:45.680327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:17:45.682046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.421346, "process_user_time": 3.081373, "process_kernel_time": 0.159553, "process_mem_max_rss": "132500", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:17:45.683438 [debug] [MainThread]: Command `dbt run` failed at 08:17:45.683216 after 4.42 seconds
[0m08:17:45.684645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd190b8df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f6cebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd18f6cd250>]}
[0m08:17:45.685861 [debug] [MainThread]: Flushing usage events
[0m08:18:41.428614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc714aa4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71658e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc714f34a10>]}


============================== 08:18:41.431231 | 388c8af3-7e98-4e12-b73f-17a7fb95f07a ==============================
[0m08:18:41.431231 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:18:41.433438 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run -s dim_customer', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m08:18:41.744829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7139d6e10>]}
[0m08:18:41.829307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc714ac1690>]}
[0m08:18:41.830800 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:18:41.866359 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:18:42.481767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:18:42.482855 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:18:42.641505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7139c8f50>]}
[0m08:18:42.673121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7134de8d0>]}
[0m08:18:42.674281 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:18:42.675853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc718054c10>]}
[0m08:18:42.678592 [info ] [MainThread]: 
[0m08:18:42.680710 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:18:42.682969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:18:42.702243 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:18:42.704064 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:18:42.706311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:43.553695 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:18:43.557594 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:18:43.762807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:18:43.774233 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:18:43.775876 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:18:43.777375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:18:44.310504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:18:44.320982 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:18:44.508626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7135b5410>]}
[0m08:18:44.510242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:18:44.511965 [info ] [MainThread]: 
[0m08:18:44.516145 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:18:44.517555 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:18:44.519884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:18:44.521690 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:18:44.537765 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:18:44.550868 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:18:44.522773 => 08:18:44.550432
[0m08:18:44.552402 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:18:44.588352 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:18:44.599217 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:18:44.600473 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT ASTRO_SDK_SCHEMA.dim_customer.Quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:18:44.601764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:45.299179 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a332-0000-000f-0000-00000f492bf9
[0m08:18:45.303004 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'ASTRO_SDK_SCHEMA.DIM_CUSTOMER.QUANTITY'
[0m08:18:45.306538 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:18:44.553846 => 08:18:45.305928
[0m08:18:45.309304 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:18:45.503137 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'ASTRO_SDK_SCHEMA.DIM_CUSTOMER.QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:18:45.507178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388c8af3-7e98-4e12-b73f-17a7fb95f07a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71387bbd0>]}
[0m08:18:45.510679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.99s]
[0m08:18:45.514101 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:18:45.520022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:45.521966 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:18:45.523951 [info ] [MainThread]: 
[0m08:18:45.525978 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m08:18:45.528992 [debug] [MainThread]: Command end result
[0m08:18:45.617771 [info ] [MainThread]: 
[0m08:18:45.618973 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:18:45.620126 [info ] [MainThread]: 
[0m08:18:45.621227 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'ASTRO_SDK_SCHEMA.DIM_CUSTOMER.QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:18:45.622353 [info ] [MainThread]: 
[0m08:18:45.623550 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:18:45.625053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.255307, "process_user_time": 2.853521, "process_kernel_time": 0.137756, "process_mem_max_rss": "132648", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:18:45.626310 [debug] [MainThread]: Command `dbt run` failed at 08:18:45.626109 after 4.26 seconds
[0m08:18:45.627289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc714ad5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc714a825d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc718ec3190>]}
[0m08:18:45.628288 [debug] [MainThread]: Flushing usage events
[0m08:19:11.765012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2496bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac25d35ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac24968d50>]}


============================== 08:19:11.771967 | c95091fe-0004-46ff-bd73-f9d284d9539c ==============================
[0m08:19:11.771967 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:19:11.777465 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_customer', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False'}
[0m08:19:12.362097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac23a4f090>]}
[0m08:19:12.504833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac24979ad0>]}
[0m08:19:12.507411 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:19:12.559803 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:19:17.162895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:19:17.167656 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:19:17.522259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac23a669d0>]}
[0m08:19:17.606727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac233ca050>]}
[0m08:19:17.610050 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:19:17.613366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac28074e90>]}
[0m08:19:17.618973 [info ] [MainThread]: 
[0m08:19:17.623332 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:19:17.628514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:19:17.672600 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:19:17.676365 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:19:17.679788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:19:18.656835 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:19:18.667056 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:19:18.896857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:19:18.946593 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:19:18.952183 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:19:18.957562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:19:19.572207 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:19:19.582603 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:19:19.791714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac236f4f90>]}
[0m08:19:19.798497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:19:19.803254 [info ] [MainThread]: 
[0m08:19:19.817374 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:19:19.824018 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:19:19.832055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:19:19.837924 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:19:19.896176 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:19:19.941107 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:19:19.843068 => 08:19:19.939549
[0m08:19:19.946883 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:19:20.062996 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:19:20.080135 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:19:20.082096 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT *
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:19:20.084340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:19:21.785692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m08:19:21.880265 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:19:19.951289 => 08:19:21.879649
[0m08:19:21.883071 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:19:22.052133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c95091fe-0004-46ff-bd73-f9d284d9539c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac2351bbd0>]}
[0m08:19:22.056109 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.22s]
[0m08:19:22.059716 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:19:22.065834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:19:22.067959 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:19:22.070079 [info ] [MainThread]: 
[0m08:19:22.072292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m08:19:22.075166 [debug] [MainThread]: Command end result
[0m08:19:22.198070 [info ] [MainThread]: 
[0m08:19:22.200418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:19:22.202201 [info ] [MainThread]: 
[0m08:19:22.204013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:19:22.206710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.604664, "process_user_time": 5.087971, "process_kernel_time": 0.435546, "process_mem_max_rss": "131900", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m08:19:22.208732 [debug] [MainThread]: Command `dbt run` succeeded at 08:19:22.208435 after 10.61 seconds
[0m08:19:22.210701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac24ed9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac28ed32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac28f672d0>]}
[0m08:19:22.212514 [debug] [MainThread]: Flushing usage events
[0m08:20:39.829516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0b0c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0b0c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac09f9990>]}


============================== 08:20:39.835934 | ea91ae47-7b2c-44ae-8440-ac798eb0613d ==============================
[0m08:20:39.835934 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:20:39.839807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -s dim_customer'}
[0m08:20:40.396031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf7eb410>]}
[0m08:20:40.516012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac049db90>]}
[0m08:20:40.518458 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:20:40.580288 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:20:42.852270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:20:42.857624 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:20:43.166173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf349bd0>]}
[0m08:20:43.283410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf01eb90>]}
[0m08:20:43.288716 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:20:43.293577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf483390>]}
[0m08:20:43.302663 [info ] [MainThread]: 
[0m08:20:43.309208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:43.318756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:20:43.391187 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:20:43.394902 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:20:43.398226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:44.876868 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:20:44.887221 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:20:45.130460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:20:45.176250 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:20:45.182080 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:20:45.187511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:45.973013 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:20:45.983837 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:20:46.179208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf433690>]}
[0m08:20:46.187463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:46.193879 [info ] [MainThread]: 
[0m08:20:46.211199 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:20:46.218057 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:20:46.226374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:20:46.234673 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:20:46.306948 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:20:46.351021 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:20:46.240533 => 08:20:46.349378
[0m08:20:46.357059 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:20:46.502739 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:20:46.523514 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:20:46.525675 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT t.Quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices as t
        );
[0m08:20:46.527643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:47.282881 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a334-0000-000a-0000-00000f493ce1
[0m08:20:47.289392 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'T.QUANTITY'
[0m08:20:47.297136 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:20:46.361825 => 08:20:47.294852
[0m08:20:47.303948 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:20:47.514019 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'T.QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:20:47.520396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea91ae47-7b2c-44ae-8440-ac798eb0613d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3abf390110>]}
[0m08:20:47.527014 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.30s]
[0m08:20:47.534311 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:20:47.552461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:47.558074 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:20:47.563703 [info ] [MainThread]: 
[0m08:20:47.569333 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m08:20:47.577256 [debug] [MainThread]: Command end result
[0m08:20:47.769928 [info ] [MainThread]: 
[0m08:20:47.773316 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:47.776540 [info ] [MainThread]: 
[0m08:20:47.779735 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'T.QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:20:47.783202 [info ] [MainThread]: 
[0m08:20:47.787177 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:20:47.792598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.109228, "process_user_time": 5.125913, "process_kernel_time": 0.270311, "process_mem_max_rss": "132456", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:20:47.796893 [debug] [MainThread]: Command `dbt run` failed at 08:20:47.796384 after 8.11 seconds
[0m08:20:47.800323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac0b0c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac49f7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ac49f72d0>]}
[0m08:20:47.803592 [debug] [MainThread]: Flushing usage events
[0m08:22:05.654459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aaa9e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ac7d5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab071810>]}


============================== 08:22:05.658318 | 6bbde144-63cb-4c9a-8a57-7753b8e64543 ==============================
[0m08:22:05.658318 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:22:05.660582 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_customer', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m08:22:06.267565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aaa65210>]}
[0m08:22:06.452253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aaac4110>]}
[0m08:22:06.455046 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:22:06.535294 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:22:09.206858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:22:09.211470 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m08:22:09.509916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a9a2b090>]}
[0m08:22:09.569653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a9610a10>]}
[0m08:22:09.572999 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:22:09.576157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a9a41b90>]}
[0m08:22:09.581483 [info ] [MainThread]: 
[0m08:22:09.585568 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:22:09.590610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:22:09.634593 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:22:09.638136 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:22:09.641386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:10.696171 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m08:22:10.706090 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:22:10.937354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:22:10.983484 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:22:10.989111 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:22:10.994396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:22:11.786429 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m08:22:11.796968 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:22:12.008694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a9605250>]}
[0m08:22:12.016065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:22:12.021634 [info ] [MainThread]: 
[0m08:22:12.035398 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m08:22:12.041525 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m08:22:12.048864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m08:22:12.054562 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m08:22:12.111823 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m08:22:12.146257 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 08:22:12.059263 => 08:22:12.145053
[0m08:22:12.150352 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m08:22:12.282832 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m08:22:12.309852 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m08:22:12.313431 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m08:22:12.317164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:22:12.961417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a336-0000-000a-0000-00000f493ced
[0m08:22:12.967329 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'QUANTITY'
[0m08:22:12.973901 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 08:22:12.153759 => 08:22:12.972507
[0m08:22:12.979870 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m08:22:13.189554 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:22:13.195603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbde144-63cb-4c9a-8a57-7753b8e64543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a9a79f50>]}
[0m08:22:13.201942 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.15s]
[0m08:22:13.209280 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m08:22:13.225366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:13.231074 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m08:22:13.236822 [info ] [MainThread]: 
[0m08:22:13.243822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m08:22:13.251894 [debug] [MainThread]: Command end result
[0m08:22:13.509354 [info ] [MainThread]: 
[0m08:22:13.515369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:22:13.520343 [info ] [MainThread]: 
[0m08:22:13.526390 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m08:22:13.532558 [info ] [MainThread]: 
[0m08:22:13.541799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:22:13.551075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.058782, "process_user_time": 5.883646, "process_kernel_time": 0.281129, "process_mem_max_rss": "133048", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m08:22:13.557528 [debug] [MainThread]: Command `dbt run` failed at 08:22:13.556671 after 8.07 seconds
[0m08:22:13.562917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aefe32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aaa4bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aaa4bf50>]}
[0m08:22:13.568864 [debug] [MainThread]: Flushing usage events
[0m09:31:03.357521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd1fbb790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd34b95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd1ff2250>]}


============================== 09:31:03.364084 | 14e4ebde-f292-4bf5-925e-580c4c4144ab ==============================
[0m09:31:03.364084 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:31:03.367347 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -s dim_customer', 'log_format': 'default', 'debug': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None'}
[0m09:31:04.083200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0f5b610>]}
[0m09:31:04.249215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd111ecd0>]}
[0m09:31:04.251814 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:31:04.325278 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:31:09.306855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:31:09.311344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:31:09.343839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0e179d0>]}
[0m09:31:09.482271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0ef6150>]}
[0m09:31:09.487373 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:31:09.492657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0ee9f90>]}
[0m09:31:09.502003 [info ] [MainThread]: 
[0m09:31:09.508921 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:31:09.520013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:31:09.598715 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:31:09.602835 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:31:09.606863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:31:10.965715 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:31:10.975879 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:31:11.311706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:31:11.359104 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:31:11.364465 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:31:11.369824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:31:12.322395 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:31:12.333510 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:31:12.710704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0de2f10>]}
[0m09:31:12.717844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:31:12.723377 [info ] [MainThread]: 
[0m09:31:12.741116 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:31:12.748117 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m09:31:12.756130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:31:12.763395 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:31:12.860358 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:31:12.891913 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:31:12.767974 => 09:31:12.890955
[0m09:31:12.895890 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:31:13.000097 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:31:13.027367 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:31:13.030898 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m09:31:13.034613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:31:13.848893 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a37b-0000-000f-0000-00000f492cd5
[0m09:31:13.855502 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'QUANTITY'
[0m09:31:13.862995 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:31:12.898866 => 09:31:13.861315
[0m09:31:13.869098 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:31:14.186658 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:31:14.193350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14e4ebde-f292-4bf5-925e-580c4c4144ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd0b92150>]}
[0m09:31:14.200819 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.44s]
[0m09:31:14.208266 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:31:14.225107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:31:14.231025 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:31:14.237423 [info ] [MainThread]: 
[0m09:31:14.243161 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m09:31:14.252396 [debug] [MainThread]: Command end result
[0m09:31:14.406951 [info ] [MainThread]: 
[0m09:31:14.411389 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:31:14.415654 [info ] [MainThread]: 
[0m09:31:14.421674 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:31:14.426942 [info ] [MainThread]: 
[0m09:31:14.431968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:31:14.438754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.193504, "process_user_time": 5.122634, "process_kernel_time": 0.857094, "process_mem_max_rss": "130772", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:31:14.442746 [debug] [MainThread]: Command `dbt run` failed at 09:31:14.442133 after 11.20 seconds
[0m09:31:14.446228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd1fb73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd1fb4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7bd1f9d110>]}
[0m09:31:14.449707 [debug] [MainThread]: Flushing usage events
[0m09:34:30.738669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009fe6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200b43cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009fe7110>]}


============================== 09:34:30.743509 | 94ffa6a8-e019-4315-bb68-275d49aa3948 ==============================
[0m09:34:30.743509 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:34:30.746061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt run -s dim_customer', 'profiles_dir': '/usr/local/airflow/include/dbt', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m09:34:31.211483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20090eb410>]}
[0m09:34:31.338458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009fd1610>]}
[0m09:34:31.341422 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:34:31.400017 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:34:33.941462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:34:33.945017 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:34:34.275182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009fe5c10>]}
[0m09:34:34.373531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2008d0bbd0>]}
[0m09:34:34.378118 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:34:34.382610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200d6c8cd0>]}
[0m09:34:34.391369 [info ] [MainThread]: 
[0m09:34:34.398092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:34:34.406331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:34:34.475303 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:34:34.480678 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:34:34.485709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:35.768481 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:34:35.778931 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:34:36.080310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:34:36.127291 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:34:36.132935 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:34:36.138226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:36.949272 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:34:36.959802 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:34:37.303432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2008ed59d0>]}
[0m09:34:37.310917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:37.316202 [info ] [MainThread]: 
[0m09:34:37.331248 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:34:37.337905 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m09:34:37.345791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:34:37.352317 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:34:37.409899 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:34:37.456013 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:34:37.357077 => 09:34:37.454289
[0m09:34:37.461581 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:34:37.571272 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:34:37.598222 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:34:37.601974 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT QUANTITY
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m09:34:37.605964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:38.328547 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a37e-0000-000f-0000-00000f492d19
[0m09:34:38.335131 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 7
invalid identifier 'QUANTITY'
[0m09:34:38.342152 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:34:37.466167 => 09:34:38.340706
[0m09:34:38.347919 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:34:38.749651 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:34:38.756049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94ffa6a8-e019-4315-bb68-275d49aa3948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2008e56590>]}
[0m09:34:38.762370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.41s]
[0m09:34:38.769480 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:34:38.784360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:38.789261 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:34:38.794813 [info ] [MainThread]: 
[0m09:34:38.801704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m09:34:38.810312 [debug] [MainThread]: Command end result
[0m09:34:39.004167 [info ] [MainThread]: 
[0m09:34:39.007593 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:34:39.010826 [info ] [MainThread]: 
[0m09:34:39.014265 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:34:39.017913 [info ] [MainThread]: 
[0m09:34:39.021406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:34:39.026808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.385553, "process_user_time": 4.847111, "process_kernel_time": 0.276977, "process_mem_max_rss": "132988", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:34:39.030944 [debug] [MainThread]: Command `dbt run` failed at 09:34:39.030419 after 8.39 seconds
[0m09:34:39.034437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2009f96690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200bd1b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200e5272d0>]}
[0m09:34:39.038278 [debug] [MainThread]: Flushing usage events
[0m09:35:12.224799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7efaeb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7fbf6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7f7c78d0>]}


============================== 09:35:12.228854 | 6c17e623-0342-4584-841f-903eb51ab49a ==============================
[0m09:35:12.228854 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:35:12.231165 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run -s dim_customer', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'write_json': 'True'}
[0m09:35:12.718803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7f57dbd0>]}
[0m09:35:12.915324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7ef9dad0>]}
[0m09:35:12.918073 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:35:12.989595 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:35:17.718756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:35:17.722738 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:35:18.052557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7ef5c790>]}
[0m09:35:18.131118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7db24e10>]}
[0m09:35:18.134393 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:35:18.137587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7de172d0>]}
[0m09:35:18.142744 [info ] [MainThread]: 
[0m09:35:18.146416 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:35:18.151130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:35:18.188508 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:35:18.191403 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:35:18.194665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:35:19.375695 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:35:19.386652 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:35:19.802122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:35:19.853986 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:35:19.859559 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:35:19.867286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:35:20.817771 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:35:20.828003 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:35:21.129287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c82690cd0>]}
[0m09:35:21.136284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:35:21.141937 [info ] [MainThread]: 
[0m09:35:21.157241 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:35:21.163764 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m09:35:21.172451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:35:21.178645 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:35:21.243034 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:35:21.286087 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:35:21.183134 => 09:35:21.285024
[0m09:35:21.289816 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:35:21.393557 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:35:21.424224 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:35:21.428075 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (-- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT *, QUANTITY
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
        );
[0m09:35:21.431835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:35:22.169465 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a37f-0000-000f-0000-00000f492d21
[0m09:35:22.173238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 10
invalid identifier 'QUANTITY'
[0m09:35:22.178307 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:35:21.292997 => 09:35:22.177388
[0m09:35:22.182573 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:35:22.577853 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 10
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:35:22.583776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c17e623-0342-4584-841f-903eb51ab49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7de63b10>]}
[0m09:35:22.591634 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.41s]
[0m09:35:22.598811 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:35:22.614150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:35:22.619227 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:35:22.624397 [info ] [MainThread]: 
[0m09:35:22.630647 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m09:35:22.639205 [debug] [MainThread]: Command end result
[0m09:35:22.839777 [info ] [MainThread]: 
[0m09:35:22.843385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:35:22.846695 [info ] [MainThread]: 
[0m09:35:22.850035 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 16 at position 10
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:35:22.853888 [info ] [MainThread]: 
[0m09:35:22.857238 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:35:22.862131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.776638, "process_user_time": 5.175019, "process_kernel_time": 0.362452, "process_mem_max_rss": "132704", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:35:22.866177 [debug] [MainThread]: Command `dbt run` failed at 09:35:22.865659 after 10.78 seconds
[0m09:35:22.869483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c83595050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7de45a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c7dcfec50>]}
[0m09:35:22.873076 [debug] [MainThread]: Flushing usage events
[0m09:38:23.318758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00890c4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00890a38d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0089d422d0>]}


============================== 09:38:23.322543 | 804b0e6c-5d11-450d-a72e-b8808342edaa ==============================
[0m09:38:23.322543 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:38:23.324765 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run -s dim_customer', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m09:38:23.804956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00880e6910>]}
[0m09:38:23.956960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00890e9950>]}
[0m09:38:23.959528 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:38:24.009168 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:38:24.080351 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:38:24.084841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0087f53710>]}
[0m09:38:29.882889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0087d74c50>]}
[0m09:38:29.939944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00863bf750>]}
[0m09:38:29.942361 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:38:29.944309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0087fa7ed0>]}
[0m09:38:29.947524 [info ] [MainThread]: 
[0m09:38:29.949926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:38:29.953285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:38:29.984976 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:38:29.987680 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:38:29.990633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:31.278037 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:38:31.288217 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:38:31.698616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:38:31.745185 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:38:31.750620 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:38:31.755808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:38:32.977538 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:38:32.988537 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:38:33.356809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00864cba10>]}
[0m09:38:33.363971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:33.369053 [info ] [MainThread]: 
[0m09:38:33.383536 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:38:33.389700 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:38:33.397369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:38:33.403266 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:38:33.462547 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:38:33.507077 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:38:33.407797 => 09:38:33.505441
[0m09:38:33.512410 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:38:33.606402 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:38:33.624448 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:38:33.626724 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    -- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT *, QUANTITY
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  );
[0m09:38:33.628942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:38:34.357987 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a382-0000-000f-0000-00000f492d59
[0m09:38:34.364045 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 10
invalid identifier 'QUANTITY'
[0m09:38:34.370496 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:38:33.516837 => 09:38:34.368969
[0m09:38:34.376043 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:38:34.770327 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 17 at position 10
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:38:34.773667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804b0e6c-5d11-450d-a72e-b8808342edaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0089125810>]}
[0m09:38:34.777253 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.38s]
[0m09:38:34.780468 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:38:34.787134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:34.789483 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:38:34.791766 [info ] [MainThread]: 
[0m09:38:34.794249 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m09:38:34.797512 [debug] [MainThread]: Command end result
[0m09:38:34.850971 [info ] [MainThread]: 
[0m09:38:34.852719 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:38:34.854523 [info ] [MainThread]: 
[0m09:38:34.856339 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 17 at position 10
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:38:34.858384 [info ] [MainThread]: 
[0m09:38:34.860298 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:38:34.862911 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.684544, "process_user_time": 6.872752, "process_kernel_time": 0.261627, "process_mem_max_rss": "135100", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:38:34.864976 [debug] [MainThread]: Command `dbt run` failed at 09:38:34.864725 after 11.69 seconds
[0m09:38:34.866757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00890aa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0089750c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00896c9dd0>]}
[0m09:38:34.868751 [debug] [MainThread]: Flushing usage events
[0m09:38:54.549913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864f121bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864f0eb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864f0e8cd0>]}


============================== 09:38:54.554516 | bdefb8ac-697d-4e50-b4e1-fb77efec0de4 ==============================
[0m09:38:54.554516 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:38:54.557158 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run -s dim_customer', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True'}
[0m09:38:55.030688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864e1e2a10>]}
[0m09:38:55.168972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864f10d710>]}
[0m09:38:55.172009 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:38:55.263809 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:38:59.624904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:38:59.629789 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:38:59.936409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864e208bd0>]}
[0m09:39:00.033692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864dc97850>]}
[0m09:39:00.038384 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:39:00.043091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864e00fd10>]}
[0m09:39:00.051998 [info ] [MainThread]: 
[0m09:39:00.058650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:39:00.066715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:39:00.136086 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:39:00.139926 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:39:00.143656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:39:01.243965 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:39:01.254295 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:39:01.690864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:39:01.737676 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:39:01.742836 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:39:01.747744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:39:02.775896 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:39:02.787632 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:39:03.065036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864dc6f350>]}
[0m09:39:03.072733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:39:03.079222 [info ] [MainThread]: 
[0m09:39:03.094920 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:39:03.101391 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:39:03.108953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:39:03.114536 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:39:03.174448 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:39:03.220324 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:39:03.119101 => 09:39:03.218613
[0m09:39:03.225714 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:39:03.337159 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:39:03.358176 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:39:03.360663 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    -- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT *
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  );
[0m09:39:03.362956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:39:04.246232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:39:04.348703 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:39:03.230288 => 09:39:04.347848
[0m09:39:04.352313 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:39:04.657122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdefb8ac-697d-4e50-b4e1-fb77efec0de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f864dc62c50>]}
[0m09:39:04.664213 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ASTRO_SDK_SCHEMA.dim_customer ................. [[32mSUCCESS 1[0m in 1.55s]
[0m09:39:04.672586 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:39:04.687727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:39:04.693583 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:39:04.699753 [info ] [MainThread]: 
[0m09:39:04.706204 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m09:39:04.714051 [debug] [MainThread]: Command end result
[0m09:39:04.910199 [info ] [MainThread]: 
[0m09:39:04.913771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:39:04.916954 [info ] [MainThread]: 
[0m09:39:04.920451 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:39:04.925587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.51633, "process_user_time": 5.015326, "process_kernel_time": 0.290888, "process_mem_max_rss": "132448", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m09:39:04.929525 [debug] [MainThread]: Command `dbt run` succeeded at 09:39:04.928847 after 10.52 seconds
[0m09:39:04.933362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86536672d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653667410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86537a1e10>]}
[0m09:39:04.937091 [debug] [MainThread]: Flushing usage events
[0m09:40:03.977569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecafb76e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb0f19a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecafb42c50>]}


============================== 09:40:03.984868 | 26000bab-cfe7-4a77-8203-d1503301a97e ==============================
[0m09:40:03.984868 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:40:03.989075 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'write_json': 'True', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s dim_customer', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m09:40:04.521196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaeb63a50>]}
[0m09:40:04.642314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaebbd410>]}
[0m09:40:04.645071 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:40:04.726495 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:40:09.268320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:40:09.273861 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:40:09.562120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecafb7bf10>]}
[0m09:40:09.623906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecae89a350>]}
[0m09:40:09.626906 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:40:09.630063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecae8a3f90>]}
[0m09:40:09.635688 [info ] [MainThread]: 
[0m09:40:09.639860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:40:09.645617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:40:09.690353 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:40:09.693984 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:40:09.697297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:12.461315 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.0 seconds
[0m09:40:12.471823 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:40:13.302206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:40:13.349675 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:40:13.355222 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:40:13.360305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:15.474054 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m09:40:15.480698 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:40:15.874423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecaeb4c290>]}
[0m09:40:15.877961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:15.880404 [info ] [MainThread]: 
[0m09:40:15.885748 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:40:15.888132 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:40:15.890762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:40:15.893115 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:40:15.911674 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:40:15.930360 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:40:15.894877 => 09:40:15.929667
[0m09:40:15.932664 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:40:15.986761 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:40:16.003973 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:40:16.005959 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    -- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT Description
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  );
[0m09:40:16.008258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:17.068330 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a384-0000-000a-0000-00000f493e01
[0m09:40:17.073716 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 7
invalid identifier 'DESCRIPTION'
[0m09:40:17.079592 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:40:15.934475 => 09:40:17.078035
[0m09:40:17.084449 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:40:17.489550 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 17 at position 7
  invalid identifier 'DESCRIPTION'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:40:17.495404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26000bab-cfe7-4a77-8203-d1503301a97e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecae6f70d0>]}
[0m09:40:17.501649 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.60s]
[0m09:40:17.508847 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:40:17.523884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:17.528793 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:40:17.534233 [info ] [MainThread]: 
[0m09:40:17.539867 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m09:40:17.547439 [debug] [MainThread]: Command end result
[0m09:40:17.738004 [info ] [MainThread]: 
[0m09:40:17.741568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:40:17.745156 [info ] [MainThread]: 
[0m09:40:17.748453 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 17 at position 7
  invalid identifier 'DESCRIPTION'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:40:17.753315 [info ] [MainThread]: 
[0m09:40:17.756933 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:40:17.762326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.932028, "process_user_time": 4.759073, "process_kernel_time": 0.356675, "process_mem_max_rss": "132692", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:40:17.766304 [debug] [MainThread]: Command `dbt run` failed at 09:40:17.765775 after 13.94 seconds
[0m09:40:17.769896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecafb26590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb40b72d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb40b7410>]}
[0m09:40:17.773226 [debug] [MainThread]: Flushing usage events
[0m09:43:40.515084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe563f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbebec650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe59a1d0>]}


============================== 09:43:40.521945 | 295110f2-28eb-4d54-bc88-b861ca681934 ==============================
[0m09:43:40.521945 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:43:40.525989 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -s dim_customer', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'printer_width': '80'}
[0m09:43:41.113680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd4e0950>]}
[0m09:43:41.278640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe59a3d0>]}
[0m09:43:41.281473 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:43:41.345859 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:43:45.535389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:43:45.541845 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m09:43:45.546528 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:43:46.081741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd0df510>]}
[0m09:43:46.203232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd116450>]}
[0m09:43:46.208056 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:43:46.213468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd1bccd0>]}
[0m09:43:46.223862 [info ] [MainThread]: 
[0m09:43:46.230789 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:43:46.241022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:43:46.325846 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:43:46.330806 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:43:46.335668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:47.677393 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:43:47.684540 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:43:47.990083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:43:48.036298 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:43:48.041519 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:43:48.046557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:49.289541 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:43:49.301409 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:43:49.627468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbda6fdd0>]}
[0m09:43:49.635456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:43:49.641255 [info ] [MainThread]: 
[0m09:43:49.657166 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:43:49.663867 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:43:49.671875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:43:49.678780 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:43:49.745446 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:43:49.774629 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:43:49.684095 => 09:43:49.773622
[0m09:43:49.778440 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:43:49.869865 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:43:49.905973 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:43:49.911923 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    -- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT Quantity
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  );
[0m09:43:49.918062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:43:50.803182 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a387-0000-000f-0000-00000f492db5
[0m09:43:50.808960 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 7
invalid identifier 'QUANTITY'
[0m09:43:50.815703 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:43:49.781177 => 09:43:50.814283
[0m09:43:50.821289 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:43:51.299891 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 17 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:43:51.306095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '295110f2-28eb-4d54-bc88-b861ca681934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb783c9d0>]}
[0m09:43:51.312502 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.64s]
[0m09:43:51.319758 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:43:51.335278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:51.340596 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:43:51.347541 [info ] [MainThread]: 
[0m09:43:51.353842 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m09:43:51.362129 [debug] [MainThread]: Command end result
[0m09:43:51.487658 [info ] [MainThread]: 
[0m09:43:51.493590 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:43:51.498817 [info ] [MainThread]: 
[0m09:43:51.505758 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 17 at position 7
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:43:51.511431 [info ] [MainThread]: 
[0m09:43:51.517941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:43:51.526308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.162763, "process_user_time": 5.622223, "process_kernel_time": 0.313469, "process_mem_max_rss": "136456", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:43:51.532802 [debug] [MainThread]: Command `dbt run` failed at 09:43:51.531713 after 11.17 seconds
[0m09:43:51.538127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbebeccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc2ae7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd365d10>]}
[0m09:43:51.546989 [debug] [MainThread]: Flushing usage events
[0m09:54:14.738653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0df77d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0df7b6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0df7b6950>]}


============================== 09:54:14.744478 | 3637846a-4068-4580-9428-1eb23efd8e87 ==============================
[0m09:54:14.744478 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:54:14.747830 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'invocation_command': 'dbt run -s dim_customer', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False'}
[0m09:54:15.348274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de76bb90>]}
[0m09:54:15.584870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de88dcd0>]}
[0m09:54:15.587474 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:54:15.639795 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:54:19.156587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:54:19.163198 [debug] [MainThread]: Partial parsing: updated file: retail://models/sources/sources.yml
[0m09:54:19.167935 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:54:19.642130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de2fb050>]}
[0m09:54:19.700465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de358cd0>]}
[0m09:54:19.702503 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:54:19.704411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de3a0d10>]}
[0m09:54:19.707993 [info ] [MainThread]: 
[0m09:54:19.710755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:19.713896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:54:19.737327 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:54:19.739266 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:54:19.741132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:21.555498 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.0 seconds
[0m09:54:21.564208 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:54:21.978083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:54:22.026962 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:54:22.032361 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:54:22.037253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:22.854687 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:54:22.866198 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:54:23.250618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de762090>]}
[0m09:54:23.258010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:23.264697 [info ] [MainThread]: 
[0m09:54:23.284929 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:54:23.291696 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:54:23.300166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:54:23.306677 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:54:23.363556 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:54:23.395048 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:54:23.311413 => 09:54:23.394053
[0m09:54:23.398861 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:54:23.481269 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:54:23.497886 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:54:23.500290 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    -- WITH customer_cte AS (
-- 	SELECT DISTINCT
-- 	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
-- 	    Country AS country
-- 	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
-- 	WHERE CustomerID IS NOT NULL
-- )
-- SELECT
--     t.*,
-- 	cm.iso
-- FROM customer_cte t
-- LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename

SELECT "Quantity"
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  );
[0m09:54:23.502547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:24.635300 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:24.742259 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:54:23.401759 => 09:54:24.741674
[0m09:54:24.745413 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:54:25.202640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3637846a-4068-4580-9428-1eb23efd8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0de4b3ad0>]}
[0m09:54:25.210160 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ASTRO_SDK_SCHEMA.dim_customer ................. [[32mSUCCESS 1[0m in 1.90s]
[0m09:54:25.217947 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:54:25.231368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:25.237038 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:54:25.242503 [info ] [MainThread]: 
[0m09:54:25.248807 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m09:54:25.259528 [debug] [MainThread]: Command end result
[0m09:54:25.382326 [info ] [MainThread]: 
[0m09:54:25.388210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:25.393249 [info ] [MainThread]: 
[0m09:54:25.399109 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:54:25.406401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.8137, "process_user_time": 5.284221, "process_kernel_time": 0.369595, "process_mem_max_rss": "135188", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m09:54:25.412545 [debug] [MainThread]: Command `dbt run` succeeded at 09:54:25.411685 after 10.82 seconds
[0m09:54:25.418070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0df779f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0df778050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0e3d8f2d0>]}
[0m09:54:25.423387 [debug] [MainThread]: Flushing usage events
[0m09:57:32.793161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf27366050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf27351d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf277c4f90>]}


============================== 09:57:32.798914 | 319fd7c5-82ca-4b4a-833a-b6ade44565e6 ==============================
[0m09:57:32.798914 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:57:32.803169 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run -s dim_customer', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m09:57:33.453805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf262593d0>]}
[0m09:57:33.616598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf262593d0>]}
[0m09:57:33.619376 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:57:33.677866 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:57:37.555172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:57:37.559907 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:57:37.843154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf25ecc3d0>]}
[0m09:57:37.889710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2611e0d0>]}
[0m09:57:37.891724 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:57:37.893726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2a8e4c10>]}
[0m09:57:37.897213 [info ] [MainThread]: 
[0m09:57:37.899694 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:57:37.902663 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:57:37.932285 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:57:37.935244 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:57:37.938162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:39.088865 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:57:39.099163 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:57:39.453147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:57:39.506147 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:57:39.511511 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:57:39.516922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:40.475395 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:57:40.486282 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:57:40.843127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf26314510>]}
[0m09:57:40.850172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:40.855136 [info ] [MainThread]: 
[0m09:57:40.869427 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:57:40.875048 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:57:40.883912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:57:40.889434 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:57:40.945947 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:57:40.990759 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:57:40.894146 => 09:57:40.989217
[0m09:57:40.996783 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:57:41.122512 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:57:41.144523 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:57:41.147104 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE CustomerID IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m09:57:41.150042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:41.963846 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a395-0000-000a-0000-00000f493e91
[0m09:57:41.965661 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m09:57:41.967811 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:57:41.001304 => 09:57:41.967325
[0m09:57:41.969541 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:57:42.382404 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:57:42.386492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '319fd7c5-82ca-4b4a-833a-b6ade44565e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf25c64810>]}
[0m09:57:42.390261 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.50s]
[0m09:57:42.394771 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:57:42.403931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:42.406749 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:57:42.409699 [info ] [MainThread]: 
[0m09:57:42.413198 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m09:57:42.418645 [debug] [MainThread]: Command end result
[0m09:57:42.562706 [info ] [MainThread]: 
[0m09:57:42.565046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:57:42.567246 [info ] [MainThread]: 
[0m09:57:42.569441 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:57:42.571695 [info ] [MainThread]: 
[0m09:57:42.573882 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:57:42.576931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.892751, "process_user_time": 4.817874, "process_kernel_time": 0.391452, "process_mem_max_rss": "133140", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:57:42.579439 [debug] [MainThread]: Command `dbt run` failed at 09:57:42.579083 after 9.90 seconds
[0m09:57:42.581797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2b7532d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2b753190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf2608b890>]}
[0m09:57:42.583735 [debug] [MainThread]: Flushing usage events
[0m09:57:59.252138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41dda650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed432a4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41d83790>]}


============================== 09:57:59.256375 | 537aaa11-6bad-47e0-9b30-9fc0dd0963cd ==============================
[0m09:57:59.256375 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:57:59.258841 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'invocation_command': 'dbt run -s dim_customer', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'log_format': 'default'}
[0m09:57:59.799046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41d89150>]}
[0m09:57:59.961760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41dc9990>]}
[0m09:57:59.964499 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:58:00.031441 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:58:04.373838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:58:04.378848 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:58:04.672666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed41d92f50>]}
[0m09:58:04.735599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4081b290>]}
[0m09:58:04.738648 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:58:04.741577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed454bccd0>]}
[0m09:58:04.747693 [info ] [MainThread]: 
[0m09:58:04.751817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:58:04.758020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:58:04.827756 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:58:04.833391 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:58:04.839848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:05.978528 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:58:05.988322 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:58:06.280585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:58:06.326420 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:58:06.331548 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:58:06.336816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:07.108745 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:58:07.119265 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:58:07.481663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40c87910>]}
[0m09:58:07.489010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:07.494349 [info ] [MainThread]: 
[0m09:58:07.508131 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:58:07.514796 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:58:07.522991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:58:07.529139 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:58:07.585678 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:58:07.631144 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:58:07.534212 => 09:58:07.629549
[0m09:58:07.637232 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:58:07.736160 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:58:07.754363 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:58:07.756674 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m09:58:07.759015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:08.592872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a396-0000-000f-0000-00000f492e35
[0m09:58:08.599151 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m09:58:08.605507 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:58:07.641852 => 09:58:08.604131
[0m09:58:08.611061 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:58:08.906615 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:58:08.912509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537aaa11-6bad-47e0-9b30-9fc0dd0963cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed408c67d0>]}
[0m09:58:08.918829 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.39s]
[0m09:58:08.926393 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:58:08.941791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:08.946989 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:58:08.952563 [info ] [MainThread]: 
[0m09:58:08.959056 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m09:58:08.966841 [debug] [MainThread]: Command end result
[0m09:58:09.161181 [info ] [MainThread]: 
[0m09:58:09.163455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:58:09.165535 [info ] [MainThread]: 
[0m09:58:09.167400 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:58:09.169605 [info ] [MainThread]: 
[0m09:58:09.173140 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:58:09.176384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.014687, "process_user_time": 5.018172, "process_kernel_time": 0.32857, "process_mem_max_rss": "132808", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:58:09.178893 [debug] [MainThread]: Command `dbt run` failed at 09:58:09.178552 after 10.02 seconds
[0m09:58:09.181195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4631b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed4631b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed40c877d0>]}
[0m09:58:09.183621 [debug] [MainThread]: Flushing usage events
[0m09:59:21.052660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f40dc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f40ff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f549eb90>]}


============================== 09:59:21.056923 | 4e437077-2318-4bc6-8588-b22364427665 ==============================
[0m09:59:21.056923 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:59:21.059324 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'no_print': 'None', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run -s dim_customer', 'indirect_selection': 'eager', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None'}
[0m09:59:21.585954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f35edd90>]}
[0m09:59:21.720972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f58d2f10>]}
[0m09:59:21.723825 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:59:21.794143 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:59:24.988488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:59:24.992256 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m09:59:25.325821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f40c4a90>]}
[0m09:59:25.403595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2f96350>]}
[0m09:59:25.406560 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:59:25.409012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2faaf50>]}
[0m09:59:25.413923 [info ] [MainThread]: 
[0m09:59:25.417447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:59:25.421895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:59:25.460596 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:59:25.463868 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:59:25.467011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:26.956133 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:59:26.966828 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:59:27.335997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:59:27.382259 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:59:27.387584 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:59:27.392675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:28.181104 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m09:59:28.196142 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:59:28.567540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2f57290>]}
[0m09:59:28.575013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:28.580299 [info ] [MainThread]: 
[0m09:59:28.595247 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m09:59:28.601650 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m09:59:28.609302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m09:59:28.614737 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m09:59:28.669724 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m09:59:28.714005 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 09:59:28.619745 => 09:59:28.712465
[0m09:59:28.719724 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m09:59:28.836503 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m09:59:28.858125 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m09:59:28.861065 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    "md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))" as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m09:59:28.863785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:29.705939 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a397-0000-000a-0000-00000f493e95
[0m09:59:29.717621 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 5
invalid identifier '"md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))"'
[0m09:59:29.724972 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 09:59:28.724544 => 09:59:29.723224
[0m09:59:29.730854 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m09:59:30.143419 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier '"md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))"'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:59:30.149728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e437077-2318-4bc6-8588-b22364427665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2f95f90>]}
[0m09:59:30.156829 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.54s]
[0m09:59:30.164896 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m09:59:30.179234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:30.183891 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m09:59:30.188806 [info ] [MainThread]: 
[0m09:59:30.194616 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.77 seconds (4.77s).
[0m09:59:30.203279 [debug] [MainThread]: Command end result
[0m09:59:30.419103 [info ] [MainThread]: 
[0m09:59:30.423255 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:59:30.429349 [info ] [MainThread]: 
[0m09:59:30.435994 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 5
  invalid identifier '"md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT))"'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m09:59:30.441360 [info ] [MainThread]: 
[0m09:59:30.446496 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:59:30.452233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.493563, "process_user_time": 5.127315, "process_kernel_time": 0.31105, "process_mem_max_rss": "132336", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m09:59:30.457460 [debug] [MainThread]: Command `dbt run` failed at 09:59:30.456790 after 9.50 seconds
[0m09:59:30.461770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f864f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2e7b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21f2e7ab90>]}
[0m09:59:30.466064 [debug] [MainThread]: Flushing usage events
[0m10:00:12.621501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefba2afe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbb907150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefba748390>]}


============================== 10:00:12.625613 | cb632f1e-5339-4e59-afdc-3e26a77e346a ==============================
[0m10:00:12.625613 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:00:12.627888 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'invocation_command': 'dbt run -s dim_customer', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m10:00:13.121382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb929be90>]}
[0m10:00:13.312791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefba2e6890>]}
[0m10:00:13.316797 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m10:00:13.382091 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:00:17.876760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:00:17.881669 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m10:00:18.179396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb8ee6450>]}
[0m10:00:18.229646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb8ceed10>]}
[0m10:00:18.232354 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m10:00:18.235043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb90ea110>]}
[0m10:00:18.239450 [info ] [MainThread]: 
[0m10:00:18.243657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:00:18.249294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m10:00:18.304101 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m10:00:18.308236 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m10:00:18.312473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:19.422110 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m10:00:19.432396 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m10:00:19.783654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m10:00:19.830652 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m10:00:19.835834 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m10:00:19.840999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:20.625971 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m10:00:20.632315 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m10:00:20.984983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb8e1cb90>]}
[0m10:00:20.987369 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:20.988885 [info ] [MainThread]: 
[0m10:00:20.993682 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:00:20.995629 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m10:00:20.998047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m10:00:21.000285 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:00:21.019673 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:00:21.039505 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:00:21.002020 => 10:00:21.038803
[0m10:00:21.041837 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:00:21.101492 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:00:21.119252 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m10:00:21.121455 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    -- md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m10:00:21.123668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:22.084014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:00:22.188742 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:00:21.043785 => 10:00:22.187398
[0m10:00:22.194593 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m10:00:22.526415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb632f1e-5339-4e59-afdc-3e26a77e346a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb90a6510>]}
[0m10:00:22.533068 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ASTRO_SDK_SCHEMA.dim_customer ................. [[32mSUCCESS 1[0m in 1.53s]
[0m10:00:22.540346 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:00:22.553998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:22.559122 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m10:00:22.563914 [info ] [MainThread]: 
[0m10:00:22.569270 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m10:00:22.579062 [debug] [MainThread]: Command end result
[0m10:00:22.754540 [info ] [MainThread]: 
[0m10:00:22.757597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:22.760600 [info ] [MainThread]: 
[0m10:00:22.763747 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:00:22.768462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.232891, "process_user_time": 4.913451, "process_kernel_time": 0.402098, "process_mem_max_rss": "132620", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m10:00:22.772581 [debug] [MainThread]: Command `dbt run` succeeded at 10:00:22.771836 after 10.24 seconds
[0m10:00:22.776257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbe6d32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbe6d3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbe811d90>]}
[0m10:00:22.779384 [debug] [MainThread]: Flushing usage events
[0m10:03:23.990151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1667309a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166730b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1667343410>]}


============================== 10:03:23.997151 | e852143c-97e7-46f3-b401-cd9fb0480b2d ==============================
[0m10:03:23.997151 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:03:24.001122 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s dim_customer', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'partial_parse': 'True', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m10:03:24.593428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16662f2f10>]}
[0m10:03:24.742251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166732dc90>]}
[0m10:03:24.745075 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m10:03:24.800894 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:03:28.198290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:28.200635 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m10:03:28.492906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16662c0dd0>]}
[0m10:03:28.611848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666209250>]}
[0m10:03:28.616531 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m10:03:28.620959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16661f5690>]}
[0m10:03:28.629118 [info ] [MainThread]: 
[0m10:03:28.635645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:03:28.643264 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m10:03:28.706176 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m10:03:28.711001 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m10:03:28.715452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:46.911647 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 18.0 seconds
[0m10:03:46.927037 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m10:03:51.650882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m10:03:51.698591 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m10:03:51.704046 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m10:03:51.709393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:17.178420 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 25.0 seconds
[0m10:04:17.204679 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m10:04:28.611162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166626ae90>]}
[0m10:04:28.622508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:28.629044 [info ] [MainThread]: 
[0m10:04:28.654350 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:04:28.661819 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m10:04:28.670982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m10:04:28.677032 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:04:28.749786 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:04:28.774565 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:04:28.682355 => 10:04:28.773245
[0m10:04:28.777826 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:04:28.863072 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:04:28.885347 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m10:04:28.888499 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m10:04:28.891260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:51.938274 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a39c-0000-000a-0000-00000f493ef9
[0m10:04:51.942877 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 29 unexpected 'as'.
syntax error line 6 at position 98 unexpected 'as'.
[0m10:04:51.947904 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:04:28.780482 => 10:04:51.946819
[0m10:04:51.952300 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m10:05:02.995545 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  syntax error line 6 at position 98 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m10:05:03.002036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e852143c-97e7-46f3-b401-cd9fb0480b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1665e79410>]}
[0m10:05:03.008869 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 34.33s]
[0m10:05:03.016541 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:05:03.035109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:03.041654 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m10:05:03.047535 [info ] [MainThread]: 
[0m10:05:03.053655 [info ] [MainThread]: Finished running 1 view model in 0 hours 1 minutes and 34.41 seconds (94.41s).
[0m10:05:03.062679 [debug] [MainThread]: Command end result
[0m10:05:03.316764 [info ] [MainThread]: 
[0m10:05:03.318978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:05:03.320554 [info ] [MainThread]: 
[0m10:05:03.322447 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  syntax error line 6 at position 98 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m10:05:03.324309 [info ] [MainThread]: 
[0m10:05:03.326369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:05:03.329176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 99.494354, "process_user_time": 5.274181, "process_kernel_time": 0.330261, "process_mem_max_rss": "133104", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m10:05:03.331528 [debug] [MainThread]: Command `dbt run` failed at 10:05:03.331200 after 99.50 seconds
[0m10:05:03.333399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166b72f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166b72f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1666093610>]}
[0m10:05:03.335439 [debug] [MainThread]: Flushing usage events
[0m10:05:09.035388 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:06:09.023512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e8ee18d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e8e5d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e8ee1850>]}


============================== 10:06:09.030003 | 39c31b0a-a878-42d4-b473-714977e840bf ==============================
[0m10:06:09.030003 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:06:09.033933 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt run -s dim_customer', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m10:06:09.504855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e88c3bd0>]}
[0m10:06:09.682560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e912b490>]}
[0m10:06:09.685049 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m10:06:09.758073 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:06:13.192567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:06:13.197973 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m10:06:13.539724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e766be50>]}
[0m10:06:13.654168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e7492f50>]}
[0m10:06:13.658991 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m10:06:13.663537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e78125d0>]}
[0m10:06:13.673044 [info ] [MainThread]: 
[0m10:06:13.679907 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:06:13.688709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m10:06:13.758994 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m10:06:13.764158 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m10:06:13.769078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:35.242999 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 21.0 seconds
[0m10:06:35.254794 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m10:06:48.311173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m10:06:48.363501 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m10:06:48.369114 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m10:06:48.374263 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:08:18.077312 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 90.0 seconds
[0m10:08:18.092446 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m10:08:34.049578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e72cf290>]}
[0m10:08:34.060320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:34.066448 [info ] [MainThread]: 
[0m10:08:34.090471 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m10:08:34.097904 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m10:08:34.106621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m10:08:34.113206 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m10:08:34.177765 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m10:08:34.207624 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 10:08:34.118345 => 10:08:34.206394
[0m10:08:34.211034 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m10:08:34.310073 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m10:08:34.331502 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m10:08:34.333622 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m10:08:34.335928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:08:58.359626 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a3a0-0000-000a-0000-00000f493efd
[0m10:08:58.366301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m10:08:58.373676 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 10:08:34.214103 => 10:08:58.371976
[0m10:08:58.379920 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m10:09:01.723304 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m10:09:01.729984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39c31b0a-a878-42d4-b473-714977e840bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e725c290>]}
[0m10:09:01.736780 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 27.63s]
[0m10:09:01.744408 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m10:09:01.760472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:01.766786 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m10:09:01.772197 [info ] [MainThread]: 
[0m10:09:01.778027 [info ] [MainThread]: Finished running 1 view model in 0 hours 2 minutes and 48.09 seconds (168.09s).
[0m10:09:01.786983 [debug] [MainThread]: Command end result
[0m10:09:01.909192 [info ] [MainThread]: 
[0m10:09:01.915440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:09:01.920974 [info ] [MainThread]: 
[0m10:09:01.927303 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m10:09:01.934443 [info ] [MainThread]: 
[0m10:09:01.941638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:09:01.949731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 173.13634, "process_user_time": 5.361121, "process_kernel_time": 0.339437, "process_mem_max_rss": "134108", "process_in_blocks": "360", "process_out_blocks": "8", "command_success": false}
[0m10:09:01.955728 [debug] [MainThread]: Command `dbt run` failed at 10:09:01.954923 after 173.14 seconds
[0m10:09:01.961501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e9bc5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e88c2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e88c83d0>]}
[0m10:09:01.966885 [debug] [MainThread]: Flushing usage events
[0m10:09:07.484771 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m10:26:24.285217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6d55c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6d57f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6d52d010>]}


============================== 10:26:24.292414 | 53cbe7b4-d287-4107-b09b-121be9ecf47c ==============================
[0m10:26:24.292414 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:26:24.296601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'invocation_command': 'dbt run -s dim_customer', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager'}
[0m10:26:24.890823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53cbe7b4-d287-4107-b09b-121be9ecf47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6c553550>]}
[0m10:26:25.071365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53cbe7b4-d287-4107-b09b-121be9ecf47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6c416350>]}
[0m10:26:25.074571 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m10:26:25.152778 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:26:30.005320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:30.011005 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m10:26:30.340588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53cbe7b4-d287-4107-b09b-121be9ecf47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6c537d50>]}
[0m10:26:30.427149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53cbe7b4-d287-4107-b09b-121be9ecf47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6c0edc90>]}
[0m10:26:30.429348 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m10:26:30.431307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53cbe7b4-d287-4107-b09b-121be9ecf47c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6c4ad150>]}
[0m10:26:30.435386 [info ] [MainThread]: 
[0m10:26:30.438365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:30.442494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m10:26:30.470498 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m10:26:30.472606 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m10:26:30.475200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:35.004552 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m10:28:35.009712 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:28:35.014341 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m10:28:35.018362 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:28:35.022726 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: No close available on handle
[0m10:28:35.032589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:35.036128 [debug] [MainThread]: Connection 'list_ASTRO_SDK_DB' was properly closed.
[0m10:28:35.039675 [info ] [MainThread]: 
[0m10:28:35.043798 [info ] [MainThread]: Finished running  in 0 hours 2 minutes and 4.60 seconds (124.60s).
[0m10:28:35.050280 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ASTRO_SDK_DB"
  Database Error
    250001: Could not connect to Snowflake backend after 1 attempt(s).Aborting
[0m10:28:35.058704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 130.9855, "process_user_time": 4.931706, "process_kernel_time": 0.360124, "process_mem_max_rss": "128976", "process_in_blocks": "16", "command_success": false, "process_out_blocks": "0"}
[0m10:28:35.064931 [debug] [MainThread]: Command `dbt run` failed at 10:28:35.063674 after 130.99 seconds
[0m10:28:35.070402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6d57fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6d5495d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6c10f790>]}
[0m10:28:35.076101 [debug] [MainThread]: Flushing usage events
[0m10:28:40.592033 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m04:26:55.536746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2907f4d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2909240cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2907f2f850>]}


============================== 04:26:55.539565 | 822aa521-4253-4221-916e-4375d24f18f6 ==============================
[0m04:26:55.539565 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:26:55.541613 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_customer', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None'}
[0m04:26:56.050127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906eef190>]}
[0m04:26:56.136131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290707c790>]}
[0m04:26:56.138063 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:26:56.173850 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:26:57.038614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:26:57.039720 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:26:57.205524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906d4aa50>]}
[0m04:26:57.239676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906b0e110>]}
[0m04:26:57.240802 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:26:57.242203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906eb92d0>]}
[0m04:26:57.244662 [info ] [MainThread]: 
[0m04:26:57.246541 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:26:57.248517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:26:57.264768 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:26:57.266512 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:26:57.268034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:26:58.389472 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:26:58.392013 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:26:58.647769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:26:58.658909 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:26:58.660492 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:26:58.662030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:26:59.235633 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:26:59.238457 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:26:59.470151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906e582d0>]}
[0m04:26:59.472251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:26:59.473914 [info ] [MainThread]: 
[0m04:26:59.477216 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:26:59.478815 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:26:59.480699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:26:59.482379 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:26:59.495737 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:26:59.507651 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:26:59.483638 => 04:26:59.506826
[0m04:26:59.508870 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:26:59.543618 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:26:59.556955 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:26:59.558260 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:26:59.559491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:00.124709 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7eb-0000-000f-0000-00000f492ef1
[0m04:27:00.126333 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 29 unexpected 'as'.
syntax error line 6 at position 98 unexpected 'as'.
[0m04:27:00.128031 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:26:59.509759 => 04:27:00.127732
[0m04:27:00.129557 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:27:00.335206 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  syntax error line 6 at position 98 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:27:00.336908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '822aa521-4253-4221-916e-4375d24f18f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906e863d0>]}
[0m04:27:00.338619 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 0.86s]
[0m04:27:00.340994 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:27:00.344893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:00.346191 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:27:00.347436 [info ] [MainThread]: 
[0m04:27:00.349231 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m04:27:00.351593 [debug] [MainThread]: Command end result
[0m04:27:00.435849 [info ] [MainThread]: 
[0m04:27:00.437190 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:27:00.438569 [info ] [MainThread]: 
[0m04:27:00.439861 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  syntax error line 6 at position 98 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:27:00.441303 [info ] [MainThread]: 
[0m04:27:00.442610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:27:00.444407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.9599166, "process_user_time": 2.864462, "process_kernel_time": 0.267614, "process_mem_max_rss": "132472", "process_in_blocks": "75464", "process_out_blocks": "8", "command_success": false}
[0m04:27:00.445728 [debug] [MainThread]: Command `dbt run` failed at 04:27:00.445481 after 4.96 seconds
[0m04:27:00.446762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290c4c7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f290c56d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2906cdbcd0>]}
[0m04:27:00.447835 [debug] [MainThread]: Flushing usage events
[0m04:27:45.523828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10f30a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10f998750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10f9984d0>]}


============================== 04:27:45.526101 | 6a2a866b-ece7-4139-813a-bd4d1279b6dc ==============================
[0m04:27:45.526101 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:27:45.528198 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_customer', 'printer_width': '80', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False'}
[0m04:27:45.855243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10f2ebfd0>]}
[0m04:27:45.939492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10f335390>]}
[0m04:27:45.941242 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:27:45.982382 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:27:46.765900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:27:46.767052 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:27:46.932799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10dea9c10>]}
[0m04:27:46.961756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10df6cfd0>]}
[0m04:27:46.962813 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:27:46.964439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10e179f50>]}
[0m04:27:46.966862 [info ] [MainThread]: 
[0m04:27:46.968876 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:27:46.970825 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:27:46.988585 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:27:46.990295 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:27:46.991717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:47.886455 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:27:47.889008 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:27:48.110946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:27:48.121680 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:27:48.123145 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:27:48.124452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:27:48.690397 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:27:48.693179 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:27:48.904630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10de9f990>]}
[0m04:27:48.906936 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:27:48.908219 [info ] [MainThread]: 
[0m04:27:48.912969 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:27:48.914889 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:27:48.917442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:27:48.919063 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:27:48.937467 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:27:48.947234 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:27:48.920544 => 04:27:48.946766
[0m04:27:48.948416 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:27:48.987797 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:27:48.996282 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:27:48.997417 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) As customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:27:48.998503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:27:49.705573 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7eb-0000-000a-0000-00000f493f79
[0m04:27:49.707184 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 29 unexpected 'as'.
syntax error line 6 at position 98 unexpected 'as'.
[0m04:27:49.709032 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:27:48.949243 => 04:27:49.708516
[0m04:27:49.710726 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:27:49.912373 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  syntax error line 6 at position 98 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:27:49.913758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a2a866b-ece7-4139-813a-bd4d1279b6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10ddcd350>]}
[0m04:27:49.915231 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.00s]
[0m04:27:49.916804 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:27:49.920240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:49.921284 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:27:49.922310 [info ] [MainThread]: 
[0m04:27:49.923503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m04:27:49.925675 [debug] [MainThread]: Command end result
[0m04:27:50.010651 [info ] [MainThread]: 
[0m04:27:50.011907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:27:50.013396 [info ] [MainThread]: 
[0m04:27:50.014891 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  syntax error line 6 at position 98 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:27:50.016336 [info ] [MainThread]: 
[0m04:27:50.017886 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:27:50.020117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.54936, "process_user_time": 2.810462, "process_kernel_time": 0.12956, "process_mem_max_rss": "132812", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:27:50.021409 [debug] [MainThread]: Command `dbt run` failed at 04:27:50.021199 after 4.55 seconds
[0m04:27:50.022603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1139bde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1139bdad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10f2f2650>]}
[0m04:27:50.023619 [debug] [MainThread]: Flushing usage events
[0m04:28:30.826307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ad56fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ad56e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ad5aaf50>]}


============================== 04:28:30.828966 | 199eee4f-3641-4b01-b6f1-9dc7417350ee ==============================
[0m04:28:30.828966 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:28:30.831296 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt run -s dim_customer', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False'}
[0m04:28:31.141762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ac69e350>]}
[0m04:28:31.227739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ac5e9690>]}
[0m04:28:31.229604 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:28:31.269958 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:28:32.001023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:28:32.002109 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:28:32.160272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ac55f210>]}
[0m04:28:32.193942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ac4434d0>]}
[0m04:28:32.195131 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:28:32.196664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ac42efd0>]}
[0m04:28:32.199216 [info ] [MainThread]: 
[0m04:28:32.201237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:28:32.203624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:28:32.224596 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:28:32.226622 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:28:32.228345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:28:33.179238 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:28:33.181847 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:28:33.427583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:28:33.437789 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:28:33.439103 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:28:33.440388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:28:34.013619 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:28:34.016710 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:28:34.224882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ac46f1d0>]}
[0m04:28:34.226675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:28:34.228543 [info ] [MainThread]: 
[0m04:28:34.232698 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:28:34.234192 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:28:34.236612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:28:34.238291 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:28:34.251350 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:28:34.262583 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:28:34.239279 => 04:28:34.261984
[0m04:28:34.263706 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:28:34.300096 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:28:34.310213 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:28:34.311289 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:28:34.312372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:28:34.885254 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7ec-0000-000f-0000-00000f492ef9
[0m04:28:34.886791 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m04:28:34.888395 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:28:34.264438 => 04:28:34.888087
[0m04:28:34.889819 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:28:35.096922 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:28:35.098750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '199eee4f-3641-4b01-b6f1-9dc7417350ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3abee3fd0>]}
[0m04:28:35.100341 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 0.86s]
[0m04:28:35.102477 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:28:35.106108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:28:35.107439 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:28:35.108711 [info ] [MainThread]: 
[0m04:28:35.110407 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m04:28:35.112722 [debug] [MainThread]: Command end result
[0m04:28:35.196105 [info ] [MainThread]: 
[0m04:28:35.197447 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:28:35.198842 [info ] [MainThread]: 
[0m04:28:35.200162 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:28:35.201665 [info ] [MainThread]: 
[0m04:28:35.203170 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:28:35.205292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.433073, "process_user_time": 2.779633, "process_kernel_time": 0.169977, "process_mem_max_rss": "132624", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:28:35.206558 [debug] [MainThread]: Command `dbt run` failed at 04:28:35.206334 after 4.43 seconds
[0m04:28:35.207969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ad5aa7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b1af7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3b1af7310>]}
[0m04:28:35.209400 [debug] [MainThread]: Flushing usage events
[0m04:36:07.456815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c0f36210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c0ef9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c0f10390>]}


============================== 04:36:07.459240 | 2e61884c-d7c2-40c0-b266-530805f0858f ==============================
[0m04:36:07.459240 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:36:07.460745 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run -s dim_customer', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m04:36:07.773906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bff0a490>]}
[0m04:36:07.859497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bff0a490>]}
[0m04:36:07.861231 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:36:07.903139 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:36:08.653698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:36:08.654946 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:36:08.821706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c1505cd0>]}
[0m04:36:08.850525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfe04c10>]}
[0m04:36:08.851483 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:36:08.852777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bff24f90>]}
[0m04:36:08.855142 [info ] [MainThread]: 
[0m04:36:08.856936 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:08.858770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:36:08.875548 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:36:08.877162 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:36:08.878539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:09.851143 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:36:09.855051 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:36:10.084764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:36:10.094984 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:36:10.096385 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:36:10.097658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:10.883375 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:36:10.886497 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:36:11.105590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfc6c0d0>]}
[0m04:36:11.112583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:11.117324 [info ] [MainThread]: 
[0m04:36:11.125053 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:36:11.127844 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:36:11.130861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:36:11.133133 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:36:11.148408 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:36:11.160154 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:36:11.134992 => 04:36:11.159746
[0m04:36:11.161588 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:36:11.197945 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:36:11.210644 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:36:11.212075 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CUSTOMERID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:36:11.213279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:11.803535 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7f4-0000-000f-0000-00000f492f01
[0m04:36:11.805378 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m04:36:11.807163 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:36:11.162982 => 04:36:11.806856
[0m04:36:11.808718 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:36:12.039917 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:36:12.043219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e61884c-d7c2-40c0-b266-530805f0858f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfaa21d0>]}
[0m04:36:12.046240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 0.91s]
[0m04:36:12.049573 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:36:12.055122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:12.057010 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:36:12.058970 [info ] [MainThread]: 
[0m04:36:12.060654 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m04:36:12.062843 [debug] [MainThread]: Command end result
[0m04:36:12.148502 [info ] [MainThread]: 
[0m04:36:12.149722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:36:12.150782 [info ] [MainThread]: 
[0m04:36:12.151915 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:36:12.153096 [info ] [MainThread]: 
[0m04:36:12.154162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:36:12.155712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.763473, "process_user_time": 2.96223, "process_kernel_time": 0.162314, "process_mem_max_rss": "132416", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:36:12.157030 [debug] [MainThread]: Command `dbt run` failed at 04:36:12.156831 after 4.76 seconds
[0m04:36:12.158060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7c5483310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfcac450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfcac0d0>]}
[0m04:36:12.159304 [debug] [MainThread]: Flushing usage events
[0m04:36:26.426007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a87c3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a98cf210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a87ce150>]}


============================== 04:36:26.428644 | 11892c6c-60b5-4ce1-b912-2765d9659df0 ==============================
[0m04:36:26.428644 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:36:26.430803 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s dim_customer', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m04:36:26.738872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a772fb90>]}
[0m04:36:26.824201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a87ce050>]}
[0m04:36:26.825877 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:36:26.861806 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:36:27.615478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:36:27.616656 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:36:27.778502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a7783190>]}
[0m04:36:27.822884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a757b550>]}
[0m04:36:27.824404 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:36:27.826351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a7321cd0>]}
[0m04:36:27.829215 [info ] [MainThread]: 
[0m04:36:27.831761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:27.835418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:36:27.855506 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:36:27.856947 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:36:27.858282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:28.599417 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:36:28.601844 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:36:28.812384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:36:28.845779 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:36:28.847966 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:36:28.849947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:29.433424 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:36:29.437219 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:36:29.641047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a745fd90>]}
[0m04:36:29.642939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:29.644316 [info ] [MainThread]: 
[0m04:36:29.647708 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:36:29.649110 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:36:29.650858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:36:29.652342 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:36:29.664848 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:36:29.674274 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:36:29.653395 => 04:36:29.673794
[0m04:36:29.675464 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:36:29.710326 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:36:29.720541 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:36:29.721640 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:36:29.722749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:30.442417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7f4-0000-000f-0000-00000f492f09
[0m04:36:30.444019 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 29 unexpected 'as'.
[0m04:36:30.445747 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:36:29.676243 => 04:36:30.445434
[0m04:36:30.447222 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:36:30.662944 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:36:30.664481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11892c6c-60b5-4ce1-b912-2765d9659df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a7285410>]}
[0m04:36:30.666073 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 1.01s]
[0m04:36:30.668394 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:36:30.672129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:30.673456 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:36:30.674681 [info ] [MainThread]: 
[0m04:36:30.676468 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m04:36:30.678936 [debug] [MainThread]: Command end result
[0m04:36:30.765836 [info ] [MainThread]: 
[0m04:36:30.767036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:36:30.768312 [info ] [MainThread]: 
[0m04:36:30.769510 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 29 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:36:30.770659 [info ] [MainThread]: 
[0m04:36:30.771858 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:36:30.773666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4061913, "process_user_time": 2.945819, "process_kernel_time": 0.078034, "process_mem_max_rss": "132540", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:36:30.774962 [debug] [MainThread]: Command `dbt run` failed at 04:36:30.774751 after 4.41 seconds
[0m04:36:30.776122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a87aaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10a87a8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10acbd32d0>]}
[0m04:36:30.777153 [debug] [MainThread]: Flushing usage events
[0m04:36:55.438550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945ac1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945ac1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945ac1010>]}


============================== 04:36:55.440978 | 3edcbd1d-a5b4-4772-8d91-a3e6144d6c61 ==============================
[0m04:36:55.440978 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:36:55.443163 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s dim_customer', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m04:36:55.767504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9944ae36d0>]}
[0m04:36:55.855487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945ae5910>]}
[0m04:36:55.857511 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:36:55.904133 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:36:56.649366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:36:56.650611 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:36:56.813924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9944a0a790>]}
[0m04:36:56.845520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9944677ed0>]}
[0m04:36:56.846466 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:36:56.847612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99491d8cd0>]}
[0m04:36:56.849963 [info ] [MainThread]: 
[0m04:36:56.851707 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:56.853595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:36:56.870334 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:36:56.872279 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:36:56.873650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:57.748942 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:36:57.751745 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:36:57.982216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:36:57.993782 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:36:57.995271 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:36:57.996624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:58.694680 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:36:58.704900 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:36:58.910997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99449d1b50>]}
[0m04:36:58.912926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:58.914539 [info ] [MainThread]: 
[0m04:36:58.918781 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:36:58.920329 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:36:58.922484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:36:58.924152 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:36:58.938124 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:36:58.948504 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:36:58.925609 => 04:36:58.948062
[0m04:36:58.949620 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:36:58.985416 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:36:58.996875 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:36:58.998019 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CUSTOMERID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:36:58.999240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:59.597781 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7f5-0000-000a-0000-00000f493f95
[0m04:36:59.599538 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m04:36:59.601609 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:36:58.950344 => 04:36:59.601150
[0m04:36:59.603755 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:36:59.813794 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:36:59.815612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3edcbd1d-a5b4-4772-8d91-a3e6144d6c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9944aa21d0>]}
[0m04:36:59.817111 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 0.89s]
[0m04:36:59.819480 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:36:59.823610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:59.825146 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:36:59.826611 [info ] [MainThread]: 
[0m04:36:59.828402 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m04:36:59.830976 [debug] [MainThread]: Command end result
[0m04:36:59.915683 [info ] [MainThread]: 
[0m04:36:59.916808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:36:59.917931 [info ] [MainThread]: 
[0m04:36:59.918925 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:36:59.919933 [info ] [MainThread]: 
[0m04:36:59.921090 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:36:59.922709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5429263, "process_user_time": 2.874386, "process_kernel_time": 0.121452, "process_mem_max_rss": "132496", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:36:59.924186 [debug] [MainThread]: Command `dbt run` failed at 04:36:59.923925 after 4.54 seconds
[0m04:36:59.925267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f994a0372d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f994a037410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945aa7e90>]}
[0m04:36:59.926349 [debug] [MainThread]: Flushing usage events
[0m04:37:16.834986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6d587850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6d583910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6d5800d0>]}


============================== 04:37:16.837760 | 91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c ==============================
[0m04:37:16.837760 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:37:16.840099 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s dim_customer', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'fail_fast': 'False'}
[0m04:37:17.188993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c58f490>]}
[0m04:37:17.278923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6caac510>]}
[0m04:37:17.280808 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:37:17.318503 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:37:17.953456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:37:17.954552 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m04:37:18.120892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c3ceb10>]}
[0m04:37:18.147843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c4c1ad0>]}
[0m04:37:18.148811 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:37:18.150115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c2db090>]}
[0m04:37:18.152250 [info ] [MainThread]: 
[0m04:37:18.154062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:37:18.156005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:37:18.171966 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:37:18.173540 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:37:18.175300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:19.022864 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:37:19.025396 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:37:19.255942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:37:19.266542 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:37:19.267903 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:37:19.269249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:37:19.861671 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:37:19.865524 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:37:20.091134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c130c10>]}
[0m04:37:20.097529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:20.101984 [info ] [MainThread]: 
[0m04:37:20.109919 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m04:37:20.112789 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_customer ...................... [RUN]
[0m04:37:20.115949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m04:37:20.118273 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m04:37:20.134401 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m04:37:20.146329 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 04:37:20.120022 => 04:37:20.145662
[0m04:37:20.147792 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m04:37:20.182247 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m04:37:20.193084 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m04:37:20.194206 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
  
   as (
    WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
  );
[0m04:37:20.195503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:37:20.777280 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7f5-0000-000a-0000-00000f493f9d
[0m04:37:20.778846 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 28
invalid identifier 'CUSTOMERID'
[0m04:37:20.780463 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 04:37:20.148621 => 04:37:20.780161
[0m04:37:20.781876 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m04:37:20.988734 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:37:20.991674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91deaa4e-e3e2-4c3d-b2eb-64c1eb33482c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c2ce850>]}
[0m04:37:20.994840 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_customer ............. [[31mERROR[0m in 0.88s]
[0m04:37:20.998140 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m04:37:21.005059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:21.007549 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m04:37:21.009939 [info ] [MainThread]: 
[0m04:37:21.012537 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m04:37:21.016221 [debug] [MainThread]: Command end result
[0m04:37:21.102394 [info ] [MainThread]: 
[0m04:37:21.103539 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:37:21.104661 [info ] [MainThread]: 
[0m04:37:21.105766 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 6 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m04:37:21.106835 [info ] [MainThread]: 
[0m04:37:21.107889 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:37:21.109448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.342029, "process_user_time": 2.945004, "process_kernel_time": 0.071579, "process_mem_max_rss": "132324", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:37:21.110792 [debug] [MainThread]: Command `dbt run` failed at 04:37:21.110586 after 4.34 seconds
[0m04:37:21.111888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6d5bdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6d5bfa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6dd93710>]}
[0m04:37:21.112933 [debug] [MainThread]: Flushing usage events
[0m04:40:47.952819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973bb55790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973bb54250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973bb56690>]}


============================== 04:40:47.955312 | 6c20dc1e-f621-47ec-bda2-1de0a70583e0 ==============================
[0m04:40:47.955312 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:40:47.957578 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_datetime', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m04:40:48.277000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973ac82190>]}
[0m04:40:48.364665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973ab77410>]}
[0m04:40:48.366582 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:40:48.404376 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:40:49.156532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:40:49.157634 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m04:40:49.331546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973aa5c350>]}
[0m04:40:49.360317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973aa53150>]}
[0m04:40:49.361262 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:40:49.362683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973f274e90>]}
[0m04:40:49.364893 [info ] [MainThread]: 
[0m04:40:49.367066 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:40:49.369183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:40:49.388879 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:40:49.390442 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:40:49.392278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:40:50.362191 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:40:50.365059 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:40:50.604803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:40:50.617032 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:40:50.618510 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:40:50.619959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:40:51.238185 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:40:51.241404 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:40:51.455441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973ab9c210>]}
[0m04:40:51.457407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:40:51.459111 [info ] [MainThread]: 
[0m04:40:51.463191 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m04:40:51.464717 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_datetime ...................... [RUN]
[0m04:40:51.466843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_datetime)
[0m04:40:51.468737 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m04:40:51.480360 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m04:40:51.493640 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 04:40:51.469946 => 04:40:51.493222
[0m04:40:51.494972 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m04:40:51.533512 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m04:40:51.545180 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m04:40:51.546503 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
  
   as (
    WITH datetime_cte AS (  
  SELECT DISTINCT
    InvoiceDate AS datetime_id,
    CASE
      WHEN LENGTH(InvoiceDate) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)
      WHEN LENGTH(InvoiceDate) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE InvoiceDate IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
  );
[0m04:40:51.547689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:40:52.253773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7f8-0000-000a-0000-00000f493fa5
[0m04:40:52.255492 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 2 unexpected 'FROM'.
[0m04:40:52.257300 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 04:40:51.495924 => 04:40:52.256977
[0m04:40:52.258720 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m04:40:52.479422 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m04:40:52.481136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c20dc1e-f621-47ec-bda2-1de0a70583e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973aa5c090>]}
[0m04:40:52.483008 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_datetime ............. [[31mERROR[0m in 1.01s]
[0m04:40:52.485466 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m04:40:52.489171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:40:52.490402 [debug] [MainThread]: Connection 'model.retail.dim_datetime' was properly closed.
[0m04:40:52.491690 [info ] [MainThread]: 
[0m04:40:52.493483 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m04:40:52.496254 [debug] [MainThread]: Command end result
[0m04:40:52.579339 [info ] [MainThread]: 
[0m04:40:52.580520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:40:52.581603 [info ] [MainThread]: 
[0m04:40:52.582695 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m04:40:52.583733 [info ] [MainThread]: 
[0m04:40:52.584800 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:40:52.586334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.687105, "process_user_time": 2.913017, "process_kernel_time": 0.141115, "process_mem_max_rss": "132540", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:40:52.587533 [debug] [MainThread]: Command `dbt run` failed at 04:40:52.587331 after 4.69 seconds
[0m04:40:52.588518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973ce4ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97400d32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f973a9b0490>]}
[0m04:40:52.589444 [debug] [MainThread]: Flushing usage events
[0m04:41:46.970407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145b251150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145bf00f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145b24ec90>]}


============================== 04:41:46.973043 | 6ec65d17-ef90-4b74-83d9-dad69b130a11 ==============================
[0m04:41:46.973043 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:41:46.975334 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run -s dim_product', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m04:41:47.318604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145a37d6d0>]}
[0m04:41:47.409521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145b271dd0>]}
[0m04:41:47.411373 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:41:47.444154 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:41:48.187174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:41:48.188105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:41:48.195178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145a0ae590>]}
[0m04:41:48.225634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145a18dfd0>]}
[0m04:41:48.226721 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:41:48.227761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145a185d50>]}
[0m04:41:48.229847 [info ] [MainThread]: 
[0m04:41:48.231426 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:41:48.233299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:41:48.252959 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:41:48.254596 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:41:48.255876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:41:49.115123 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:41:49.118865 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:41:49.370648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:41:49.381757 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:41:49.383371 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:41:49.384789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:41:50.171694 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:41:50.182003 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:41:50.400791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145a258090>]}
[0m04:41:50.402844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:41:50.404356 [info ] [MainThread]: 
[0m04:41:50.407763 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m04:41:50.409266 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_product ....................... [RUN]
[0m04:41:50.411125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_product)
[0m04:41:50.412780 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m04:41:50.440528 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m04:41:50.450419 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 04:41:50.414136 => 04:41:50.450001
[0m04:41:50.451534 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m04:41:50.486147 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m04:41:50.496447 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m04:41:50.497670 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
  
   as (
    SELECT DISTINCT
    md5(cast(coalesce(cast(StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
  );
[0m04:41:50.498770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:41:51.062110 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7f9-0000-000a-0000-00000f493fad
[0m04:41:51.063858 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 27
invalid identifier 'STOCKCODE'
[0m04:41:51.065697 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 04:41:50.452456 => 04:41:51.065395
[0m04:41:51.067245 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m04:41:51.298930 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 5 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m04:41:51.300708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ec65d17-ef90-4b74-83d9-dad69b130a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1459e29cd0>]}
[0m04:41:51.302459 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_product .............. [[31mERROR[0m in 0.89s]
[0m04:41:51.304650 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m04:41:51.308302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:41:51.309643 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m04:41:51.310983 [info ] [MainThread]: 
[0m04:41:51.312888 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m04:41:51.315451 [debug] [MainThread]: Command end result
[0m04:41:51.346076 [info ] [MainThread]: 
[0m04:41:51.347209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:41:51.348284 [info ] [MainThread]: 
[0m04:41:51.349294 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 5 at position 27
  invalid identifier 'STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m04:41:51.350354 [info ] [MainThread]: 
[0m04:41:51.351531 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:41:51.353450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.4347196, "process_user_time": 2.665793, "process_kernel_time": 0.200435, "process_mem_max_rss": "131372", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:41:51.354767 [debug] [MainThread]: Command `dbt run` failed at 04:41:51.354527 after 4.44 seconds
[0m04:41:51.355731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145b287710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145b286a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f145b24c190>]}
[0m04:41:51.356626 [debug] [MainThread]: Flushing usage events
[0m04:42:55.960715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27b423d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d28e31210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27b1fc90>]}


============================== 04:42:55.963102 | 443c0dae-4dc2-4020-8f17-a2107271cc3c ==============================
[0m04:42:55.963102 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:42:55.965298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt run -s dim_product', 'cache_selected_only': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'version_check': 'True'}
[0m04:42:56.276986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26b63490>]}
[0m04:42:56.363427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27b65810>]}
[0m04:42:56.365068 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:42:56.400492 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:42:57.185372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:42:57.186850 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m04:42:57.377610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26c60ed0>]}
[0m04:42:57.409625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d266e5310>]}
[0m04:42:57.411413 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:42:57.413184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26a3fc50>]}
[0m04:42:57.415858 [info ] [MainThread]: 
[0m04:42:57.417755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:42:57.420003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:42:57.437837 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:42:57.439389 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:42:57.440749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:42:58.379948 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:42:58.382594 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:42:58.628509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:42:58.639294 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:42:58.640884 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:42:58.642236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:42:59.249191 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:42:59.259152 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:42:59.477138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26a66290>]}
[0m04:42:59.479205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:42:59.480906 [info ] [MainThread]: 
[0m04:42:59.484903 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m04:42:59.486267 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_product ....................... [RUN]
[0m04:42:59.488751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_product)
[0m04:42:59.491497 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m04:42:59.507227 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 04:42:59.493544 => 04:42:59.506796
[0m04:42:59.514689 [debug] [Thread-1 (]: Compilation Error in model dim_product (models/transform/dim_product.sql)
  'ASTRO_SDK_SCHEMA' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:42:59.517180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '443c0dae-4dc2-4020-8f17-a2107271cc3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d26a486d0>]}
[0m04:42:59.519112 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_product .............. [[31mERROR[0m in 0.03s]
[0m04:42:59.521464 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m04:42:59.527013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:42:59.528667 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m04:42:59.530025 [info ] [MainThread]: 
[0m04:42:59.531772 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m04:42:59.534543 [debug] [MainThread]: Command end result
[0m04:42:59.620131 [info ] [MainThread]: 
[0m04:42:59.621329 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:42:59.622389 [info ] [MainThread]: 
[0m04:42:59.623422 [error] [MainThread]:   Compilation Error in model dim_product (models/transform/dim_product.sql)
  'ASTRO_SDK_SCHEMA' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:42:59.624450 [info ] [MainThread]: 
[0m04:42:59.625488 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:42:59.627013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.7200844, "process_user_time": 2.708086, "process_kernel_time": 0.199123, "process_mem_max_rss": "131544", "process_in_blocks": "200", "process_out_blocks": "8", "command_success": false}
[0m04:42:59.628204 [debug] [MainThread]: Command `dbt run` failed at 04:42:59.628012 after 3.72 seconds
[0m04:42:59.629174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d28fede50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d2c1650d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d27d4d6d0>]}
[0m04:42:59.630098 [debug] [MainThread]: Flushing usage events
[0m04:43:21.534714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fb877f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fbd10a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fb853790>]}


============================== 04:43:21.537200 | 75374dec-d6e2-4a76-9c0f-9b589d26b432 ==============================
[0m04:43:21.537200 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:43:21.539322 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt run -s dim_product', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m04:43:21.850339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fa877ad0>]}
[0m04:43:21.938968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fa7bd510>]}
[0m04:43:21.941921 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:43:21.989332 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:43:22.731154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:43:22.732343 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m04:43:22.893214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fa792c10>]}
[0m04:43:22.923393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fa404c90>]}
[0m04:43:22.924478 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:43:22.925918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fee2cc10>]}
[0m04:43:22.928285 [info ] [MainThread]: 
[0m04:43:22.930195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:43:22.932041 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:43:22.948910 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:43:22.950678 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:43:22.952519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:43:23.708549 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:43:23.712829 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:43:23.921992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:43:23.932564 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:43:23.934072 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:43:23.935598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:43:24.522625 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:43:24.526759 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:43:24.728670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fa73bd10>]}
[0m04:43:24.730545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:43:24.731936 [info ] [MainThread]: 
[0m04:43:24.736438 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m04:43:24.737981 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_product ....................... [RUN]
[0m04:43:24.740450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_product)
[0m04:43:24.742127 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m04:43:24.757321 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m04:43:24.769548 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 04:43:24.743305 => 04:43:24.769130
[0m04:43:24.770665 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m04:43:24.805767 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m04:43:24.818375 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m04:43:24.819658 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
  
   as (
    SELECT DISTINCT
    md5(cast(coalesce(cast(ASTRO_SDK_SCHEMA.dim_product.StockCode as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
  );
[0m04:43:24.820782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:25.405285 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7fb-0000-000f-0000-00000f492f25
[0m04:43:25.407583 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 27
invalid identifier 'ASTRO_SDK_SCHEMA.DIM_PRODUCT.STOCKCODE'
[0m04:43:25.409822 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 04:43:24.771526 => 04:43:25.409517
[0m04:43:25.411384 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m04:43:25.628298 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 5 at position 27
  invalid identifier 'ASTRO_SDK_SCHEMA.DIM_PRODUCT.STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m04:43:25.630063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75374dec-d6e2-4a76-9c0f-9b589d26b432', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fa84e210>]}
[0m04:43:25.631868 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_product .............. [[31mERROR[0m in 0.89s]
[0m04:43:25.634339 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m04:43:25.638448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:43:25.639755 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m04:43:25.641062 [info ] [MainThread]: 
[0m04:43:25.642890 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m04:43:25.645330 [debug] [MainThread]: Command end result
[0m04:43:25.729915 [info ] [MainThread]: 
[0m04:43:25.731104 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:43:25.732193 [info ] [MainThread]: 
[0m04:43:25.733308 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 5 at position 27
  invalid identifier 'ASTRO_SDK_SCHEMA.DIM_PRODUCT.STOCKCODE'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m04:43:25.734439 [info ] [MainThread]: 
[0m04:43:25.735618 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:43:25.737482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.2617946, "process_user_time": 2.811405, "process_kernel_time": 0.217784, "process_mem_max_rss": "132344", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:43:25.738753 [debug] [MainThread]: Command `dbt run` failed at 04:43:25.738540 after 4.26 seconds
[0m04:43:25.739980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ffc9b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0ffc9b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0fb859e90>]}
[0m04:43:25.741377 [debug] [MainThread]: Flushing usage events
[0m04:43:49.608159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fc804650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fd017890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fc347650>]}


============================== 04:43:49.610536 | 171c4881-7e47-40e6-8e99-fd9143cd9244 ==============================
[0m04:43:49.610536 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:43:49.612595 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_product', 'quiet': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False'}
[0m04:43:49.947440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fb32ea10>]}
[0m04:43:50.038184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fc3c8c90>]}
[0m04:43:50.039985 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:43:50.073617 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:43:50.820597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:43:50.821683 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m04:43:50.984818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fb13a450>]}
[0m04:43:51.013217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fadabed0>]}
[0m04:43:51.014150 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:43:51.015623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fb36ba90>]}
[0m04:43:51.017803 [info ] [MainThread]: 
[0m04:43:51.019612 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:43:51.021440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:43:51.040064 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:43:51.041682 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:43:51.043200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:43:51.986281 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:43:51.988910 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:43:52.319470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:43:52.330007 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:43:52.331424 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:43:52.332887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:43:53.137131 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:43:53.141102 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:43:53.370267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fb356f90>]}
[0m04:43:53.372079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:43:53.373748 [info ] [MainThread]: 
[0m04:43:53.377871 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m04:43:53.379366 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_product ....................... [RUN]
[0m04:43:53.381752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_product)
[0m04:43:53.383629 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m04:43:53.396815 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m04:43:53.408155 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 04:43:53.384982 => 04:43:53.407625
[0m04:43:53.410293 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m04:43:53.446988 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m04:43:53.456189 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m04:43:53.457358 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
  
   as (
    SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
  );
[0m04:43:53.458425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:54.095967 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a7fb-0000-000a-0000-00000f493fb5
[0m04:43:54.097691 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 107
invalid identifier 'DESCRIPTION'
[0m04:43:54.099417 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 04:43:53.411111 => 04:43:54.099104
[0m04:43:54.100884 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m04:43:54.316918 [debug] [Thread-1 (]: Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 5 at position 107
  invalid identifier 'DESCRIPTION'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m04:43:54.318653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171c4881-7e47-40e6-8e99-fd9143cd9244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fb0b0290>]}
[0m04:43:54.320315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model ASTRO_SDK_SCHEMA.dim_product .............. [[31mERROR[0m in 0.94s]
[0m04:43:54.322383 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m04:43:54.325997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:43:54.327412 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m04:43:54.328733 [info ] [MainThread]: 
[0m04:43:54.330328 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m04:43:54.332393 [debug] [MainThread]: Command end result
[0m04:43:54.417175 [info ] [MainThread]: 
[0m04:43:54.418456 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:43:54.419742 [info ] [MainThread]: 
[0m04:43:54.420810 [error] [MainThread]:   Database Error in model dim_product (models/transform/dim_product.sql)
  000904 (42000): SQL compilation error: error line 5 at position 107
  invalid identifier 'DESCRIPTION'
  compiled Code at target/run/retail/models/transform/dim_product.sql
[0m04:43:54.421958 [info ] [MainThread]: 
[0m04:43:54.422989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:43:54.424659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.871864, "process_user_time": 2.877616, "process_kernel_time": 0.131259, "process_mem_max_rss": "132376", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m04:43:54.425790 [debug] [MainThread]: Command `dbt run` failed at 04:43:54.425575 after 4.87 seconds
[0m04:43:54.426824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21fc34e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2200839110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22008cdd90>]}
[0m04:43:54.427728 [debug] [MainThread]: Flushing usage events
[0m04:44:17.114892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fbec59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fbec7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fbec5ad0>]}


============================== 04:44:17.117665 | f04c52ef-e62f-490a-a256-b774c2abafd8 ==============================
[0m04:44:17.117665 [info ] [MainThread]: Running with dbt=1.7.11
[0m04:44:17.119715 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'write_json': 'True', 'invocation_command': 'dbt run -s dim_product', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m04:44:17.479007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29faeae9d0>]}
[0m04:44:17.568265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fbee9b90>]}
[0m04:44:17.569997 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m04:44:17.609410 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m04:44:18.340036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:44:18.341304 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m04:44:18.507709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fbec3bd0>]}
[0m04:44:18.538016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fa907790>]}
[0m04:44:18.539063 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m04:44:18.540597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ff47cc10>]}
[0m04:44:18.542857 [info ] [MainThread]: 
[0m04:44:18.544679 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:44:18.546718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m04:44:18.563159 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m04:44:18.565454 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m04:44:18.567052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:19.421346 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:44:19.431565 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m04:44:19.662868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m04:44:19.678484 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m04:44:19.680362 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m04:44:19.682129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:44:20.413986 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:44:20.424279 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m04:44:20.644325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fa950850>]}
[0m04:44:20.646115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:20.648010 [info ] [MainThread]: 
[0m04:44:20.652131 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m04:44:20.653687 [info ] [Thread-1 (]: 1 of 1 START sql view model ASTRO_SDK_SCHEMA.dim_product ....................... [RUN]
[0m04:44:20.655545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_product)
[0m04:44:20.657047 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m04:44:20.670951 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m04:44:20.683222 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 04:44:20.658215 => 04:44:20.682595
[0m04:44:20.684926 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m04:44:20.720927 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m04:44:20.731469 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m04:44:20.732534 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace   view ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
  
   as (
    SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
  );
[0m04:44:20.733690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:44:21.440307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:44:21.464067 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 04:44:20.686178 => 04:44:21.463778
[0m04:44:21.465691 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m04:44:21.673741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04c52ef-e62f-490a-a256-b774c2abafd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29fad468d0>]}
[0m04:44:21.675989 [info ] [Thread-1 (]: 1 of 1 OK created sql view model ASTRO_SDK_SCHEMA.dim_product .................. [[32mSUCCESS 1[0m in 1.02s]
[0m04:44:21.678786 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m04:44:21.681871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:21.683129 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m04:44:21.684357 [info ] [MainThread]: 
[0m04:44:21.685940 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.14 seconds (3.14s).
[0m04:44:21.688024 [debug] [MainThread]: Command end result
[0m04:44:21.774456 [info ] [MainThread]: 
[0m04:44:21.775533 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:44:21.776604 [info ] [MainThread]: 
[0m04:44:21.777732 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:44:21.779141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7242007, "process_user_time": 2.925417, "process_kernel_time": 0.199687, "process_mem_max_rss": "131588", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m04:44:21.780240 [debug] [MainThread]: Command `dbt run` succeeded at 04:44:21.780062 after 4.73 seconds
[0m04:44:21.781194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a002eb190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a002eb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a00428fd0>]}
[0m04:44:21.782116 [debug] [MainThread]: Flushing usage events
[0m05:40:22.476868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123677c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236764810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1236765d50>]}


============================== 05:40:22.481077 | fcaec61c-7a60-4fe5-bc03-7fd564f84c15 ==============================
[0m05:40:22.481077 [info ] [MainThread]: Running with dbt=1.7.11
[0m05:40:22.483660 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m05:40:23.090130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123574bb90>]}
[0m05:40:23.299195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12357dd710>]}
[0m05:40:23.302068 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m05:40:23.372306 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m05:40:23.455086 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m05:40:23.458694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12355ea6d0>]}
[0m05:40:30.282163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12352fbcd0>]}
[0m05:40:30.340975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12354e3c90>]}
[0m05:40:30.343339 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:40:30.345364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1235309250>]}
[0m05:40:30.349786 [info ] [MainThread]: 
[0m05:40:30.352793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:40:30.357257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m05:40:30.383678 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m05:40:30.385700 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m05:40:30.387658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:40:31.465965 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m05:40:31.471526 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m05:40:31.828933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m05:40:31.844580 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m05:40:31.846685 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m05:40:31.848574 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:40:32.429812 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m05:40:32.439639 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m05:40:32.677352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f123547a910>]}
[0m05:40:32.682074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:40:32.685660 [info ] [MainThread]: 
[0m05:40:32.696030 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m05:40:32.699990 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m05:40:32.704696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m05:40:32.708167 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m05:40:32.731838 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m05:40:32.749905 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 05:40:32.710750 => 05:40:32.749334
[0m05:40:32.752087 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m05:40:32.801015 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m05:40:32.824748 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m05:40:32.828617 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m05:40:32.832372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:35.360976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m05:40:35.392343 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 05:40:32.753797 => 05:40:35.391886
[0m05:40:35.394472 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m05:40:35.609251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122f8a8b10>]}
[0m05:40:35.611289 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.91s]
[0m05:40:35.613697 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m05:40:35.615841 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m05:40:35.617816 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m05:40:35.620050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m05:40:35.621982 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m05:40:35.628441 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m05:40:35.644516 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 05:40:35.623568 => 05:40:35.644030
[0m05:40:35.646437 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m05:40:35.653081 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m05:40:35.671543 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m05:40:35.673724 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    "InvoiceDate" AS datetime_id,
    CASE
      WHEN LENGTH("InvoiceDate") = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', "InvoiceDate")
      WHEN LENGTH("InvoiceDate") <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', "InvoiceDate")
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE "InvoiceDate" IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m05:40:35.675688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:36.265964 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a834-0000-000a-0000-00000f494029
[0m05:40:36.268131 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m05:40:36.270275 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 05:40:35.648079 => 05:40:36.269766
[0m05:40:36.272290 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m05:40:36.484426 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m05:40:36.486415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122f8dcb10>]}
[0m05:40:36.488369 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 0.87s]
[0m05:40:36.490615 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m05:40:36.492527 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m05:40:36.494971 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m05:40:36.497292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m05:40:36.499065 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m05:40:36.509888 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m05:40:36.527704 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 05:40:36.500688 => 05:40:36.527174
[0m05:40:36.529746 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m05:40:36.536961 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m05:40:36.555995 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m05:40:36.558290 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
        );
[0m05:40:36.560532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:40:39.099142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m05:40:39.111676 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 05:40:36.531627 => 05:40:39.110674
[0m05:40:39.116083 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m05:40:39.332899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcaec61c-7a60-4fe5-bc03-7fd564f84c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122f8c2c10>]}
[0m05:40:39.335175 [info ] [Thread-1 (]: 3 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_product ................. [[32mSUCCESS 1[0m in 2.84s]
[0m05:40:39.337539 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m05:40:39.340221 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m05:40:39.342122 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m05:40:39.344109 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m05:40:39.348194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:40:39.349896 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m05:40:39.351770 [info ] [MainThread]: 
[0m05:40:39.353596 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.00 seconds (9.00s).
[0m05:40:39.357110 [debug] [MainThread]: Command end result
[0m05:40:39.404127 [info ] [MainThread]: 
[0m05:40:39.406217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:40:39.408252 [info ] [MainThread]: 
[0m05:40:39.410119 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m05:40:39.411853 [info ] [MainThread]: 
[0m05:40:39.413839 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:40:39.416545 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 17.108198, "process_user_time": 7.167121, "process_kernel_time": 0.603123, "process_mem_max_rss": "137208", "process_in_blocks": "200", "process_out_blocks": "8", "command_success": false}
[0m05:40:39.418642 [debug] [MainThread]: Command `dbt run` failed at 05:40:39.418362 after 17.11 seconds
[0m05:40:39.420375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1237c55210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12367bab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f122f9cce50>]}
[0m05:40:39.422363 [debug] [MainThread]: Flushing usage events
[0m05:43:18.624196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6e67e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6ea1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6ea1a10>]}


============================== 05:43:18.628569 | f8ef61a6-70c6-40f3-b91d-9c889e27c056 ==============================
[0m05:43:18.628569 [info ] [MainThread]: Running with dbt=1.7.11
[0m05:43:18.631122 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m05:43:19.147216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6ea18d0>]}
[0m05:43:19.326739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6ec92d0>]}
[0m05:43:19.329025 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m05:43:19.386511 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m05:43:23.511781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:43:23.514679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:43:23.534074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5c80a90>]}
[0m05:43:23.614546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5d9d610>]}
[0m05:43:23.618118 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:43:23.622091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5d33dd0>]}
[0m05:43:23.630269 [info ] [MainThread]: 
[0m05:43:23.636144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:43:23.644161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m05:43:23.701420 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m05:43:23.705830 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m05:43:23.710006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:43:24.967385 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m05:43:24.977687 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m05:43:25.267992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m05:43:25.320791 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m05:43:25.325757 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m05:43:25.332655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:43:26.188226 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m05:43:26.199677 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m05:43:26.538099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5e2c410>]}
[0m05:43:26.544734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:43:26.549404 [info ] [MainThread]: 
[0m05:43:26.565283 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m05:43:26.571243 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m05:43:26.579088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m05:43:26.585370 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m05:43:26.686863 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m05:43:26.712901 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 05:43:26.589769 => 05:43:26.712075
[0m05:43:26.716286 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m05:43:26.803950 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m05:43:26.825553 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m05:43:26.828035 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m05:43:26.830403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:43:28.063330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:43:28.175366 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 05:43:26.718503 => 05:43:28.174648
[0m05:43:28.178695 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m05:43:28.476621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5cc3150>]}
[0m05:43:28.484045 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 1.90s]
[0m05:43:28.492039 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m05:43:28.498892 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m05:43:28.505142 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m05:43:28.512893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m05:43:28.519555 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m05:43:28.543742 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m05:43:28.588831 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 05:43:28.524903 => 05:43:28.587249
[0m05:43:28.594225 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m05:43:28.613937 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m05:43:28.661986 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m05:43:28.667789 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    "InvoiceDate" AS datetime_id,
    CASE
      WHEN LENGTH("InvoiceDate") = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', "InvoiceDate")
      WHEN LENGTH("InvoiceDate") <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', "InvoiceDate")
      ELSE
        NULL
    END AS date_part,
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE "InvoiceDate" IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m05:43:28.673619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:43:29.343561 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a837-0000-000f-0000-00000f492fa9
[0m05:43:29.349872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 2 unexpected 'FROM'.
[0m05:43:29.356649 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 05:43:28.598604 => 05:43:29.355124
[0m05:43:29.362454 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m05:43:29.623121 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m05:43:29.630393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5be5610>]}
[0m05:43:29.636974 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.12s]
[0m05:43:29.644698 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m05:43:29.650323 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m05:43:29.659570 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m05:43:29.669298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m05:43:29.676783 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m05:43:29.713472 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m05:43:29.760018 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 05:43:29.681540 => 05:43:29.757893
[0m05:43:29.765797 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m05:43:29.791407 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m05:43:29.837981 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m05:43:29.843958 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
        );
[0m05:43:29.849951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:43:31.024967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:43:31.031269 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 05:43:29.770464 => 05:43:31.030853
[0m05:43:31.033798 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m05:43:31.260639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ef61a6-70c6-40f3-b91d-9c889e27c056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c5bc0310>]}
[0m05:43:31.265789 [info ] [Thread-1 (]: 3 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_product ................. [[32mSUCCESS 1[0m in 1.59s]
[0m05:43:31.271605 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m05:43:31.278389 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m05:43:31.282858 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m05:43:31.287982 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m05:43:31.298089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:43:31.301432 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m05:43:31.304897 [info ] [MainThread]: 
[0m05:43:31.310004 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m05:43:31.320185 [debug] [MainThread]: Command end result
[0m05:43:31.387520 [info ] [MainThread]: 
[0m05:43:31.389856 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:43:31.392048 [info ] [MainThread]: 
[0m05:43:31.393747 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 2 unexpected 'FROM'.
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m05:43:31.395495 [info ] [MainThread]: 
[0m05:43:31.397654 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:43:31.400033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.875012, "process_user_time": 5.138342, "process_kernel_time": 0.398321, "process_mem_max_rss": "131456", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m05:43:31.401949 [debug] [MainThread]: Command `dbt run` failed at 05:43:31.401655 after 12.88 seconds
[0m05:43:31.403639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6ea2b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c6e4e4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99cb3df1d0>]}
[0m05:43:31.405186 [debug] [MainThread]: Flushing usage events
[0m05:57:55.743850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd43180c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd431e05e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd431e30290>]}


============================== 05:57:55.750766 | 87965155-ed33-4b78-8b7c-471f0fc44065 ==============================
[0m05:57:55.750766 [info ] [MainThread]: Running with dbt=1.7.11
[0m05:57:55.754715 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'write_json': 'True'}
[0m05:57:56.287974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4311e2b50>]}
[0m05:57:56.447848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd430278790>]}
[0m05:57:56.450513 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m05:57:56.522256 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m05:57:59.226708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:57:59.228464 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m05:57:59.458101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd430082590>]}
[0m05:57:59.550193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42ffdbd50>]}
[0m05:57:59.553868 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m05:57:59.557270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4300cd490>]}
[0m05:57:59.564208 [info ] [MainThread]: 
[0m05:57:59.568457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:57:59.574894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m05:57:59.627187 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m05:57:59.631589 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m05:57:59.635851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:58:00.809903 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m05:58:00.820897 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m05:58:01.081720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m05:58:01.127102 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m05:58:01.132257 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m05:58:01.137158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:58:01.840271 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m05:58:01.851659 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m05:58:02.104754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42e3e8a90>]}
[0m05:58:02.112895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:58:02.118291 [info ] [MainThread]: 
[0m05:58:02.133795 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m05:58:02.140722 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m05:58:02.148872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m05:58:02.155363 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m05:58:02.279271 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m05:58:02.324283 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 05:58:02.161036 => 05:58:02.322735
[0m05:58:02.329955 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m05:58:02.450790 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m05:58:02.483178 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m05:58:02.487031 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m05:58:02.491092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:58:04.303551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m05:58:04.409585 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 05:58:02.334704 => 05:58:04.408763
[0m05:58:04.413317 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m05:58:04.642267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42e477ed0>]}
[0m05:58:04.648924 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.50s]
[0m05:58:04.656916 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m05:58:04.663953 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m05:58:04.670678 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m05:58:04.683132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m05:58:04.689400 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m05:58:04.866386 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m05:58:04.901418 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 05:58:04.695518 => 05:58:04.900329
[0m05:58:04.905533 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m05:58:04.922798 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m05:58:04.969003 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m05:58:04.974800 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    "InvoiceDate" AS datetime_id,
    CASE
      WHEN LENGTH("InvoiceDate") = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', "InvoiceDate")
      WHEN LENGTH("InvoiceDate") <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', "InvoiceDate")
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE "InvoiceDate" IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m05:58:04.980689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:58:05.672052 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a846-0000-000a-0000-00000f494045
[0m05:58:05.678236 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown functions PARSE_DATETIME, PARSE_DATETIME
[0m05:58:05.685315 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 05:58:04.908870 => 05:58:05.683719
[0m05:58:05.690952 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m05:58:05.927671 [debug] [Thread-1 (]: Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  002140 (42601): SQL compilation error:
  Unknown functions PARSE_DATETIME, PARSE_DATETIME
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m05:58:05.931652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42e473210>]}
[0m05:58:05.935868 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_datetime ............ [[31mERROR[0m in 1.25s]
[0m05:58:05.940405 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m05:58:05.944171 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m05:58:05.949351 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m05:58:05.954629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m05:58:05.958249 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m05:58:05.977678 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m05:58:06.007269 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 05:58:05.960796 => 05:58:06.006307
[0m05:58:06.010789 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m05:58:06.023095 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m05:58:06.053432 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m05:58:06.057561 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
        );
[0m05:58:06.061367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:58:07.274001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:58:07.294960 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 05:58:06.013820 => 05:58:07.293434
[0m05:58:07.300897 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m05:58:07.533722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87965155-ed33-4b78-8b7c-471f0fc44065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd42e48b950>]}
[0m05:58:07.540726 [info ] [Thread-1 (]: 3 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_product ................. [[32mSUCCESS 1[0m in 1.58s]
[0m05:58:07.547786 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m05:58:07.555885 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m05:58:07.561513 [info ] [Thread-1 (]: 4 of 4 SKIP relation ASTRO_SDK_SCHEMA.fct_invoices ............................. [[33mSKIP[0m]
[0m05:58:07.567472 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m05:58:07.580674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:58:07.586264 [debug] [MainThread]: Connection 'model.retail.dim_product' was properly closed.
[0m05:58:07.591774 [info ] [MainThread]: 
[0m05:58:07.597755 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m05:58:07.610531 [debug] [MainThread]: Command end result
[0m05:58:07.723223 [info ] [MainThread]: 
[0m05:58:07.725930 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:58:07.728304 [info ] [MainThread]: 
[0m05:58:07.730851 [error] [MainThread]:   Database Error in model dim_datetime (models/transform/dim_datetime.sql)
  002140 (42601): SQL compilation error:
  Unknown functions PARSE_DATETIME, PARSE_DATETIME
  compiled Code at target/run/retail/models/transform/dim_datetime.sql
[0m05:58:07.733646 [info ] [MainThread]: 
[0m05:58:07.735960 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m05:58:07.738761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.152196, "process_user_time": 5.549495, "process_kernel_time": 0.366572, "process_mem_max_rss": "133332", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m05:58:07.740884 [debug] [MainThread]: Command `dbt run` failed at 05:58:07.740563 after 12.15 seconds
[0m05:58:07.742816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4356f71d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4356f7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd43115ffd0>]}
[0m05:58:07.744991 [debug] [MainThread]: Flushing usage events
[0m06:00:16.363296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a9a77a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a9a76890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aa128550>]}


============================== 06:00:16.370455 | 2a08c2ff-a19e-4ff2-a215-3301a2b3f415 ==============================
[0m06:00:16.370455 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:00:16.374365 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True'}
[0m06:00:16.974596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a8bd1c10>]}
[0m06:00:17.117644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a9abd790>]}
[0m06:00:17.122009 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m06:00:17.224374 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m06:00:20.877517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:00:20.882865 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_datetime.sql
[0m06:00:21.145916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a862b2d0>]}
[0m06:00:21.238713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a88ecb10>]}
[0m06:00:21.243891 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m06:00:21.249195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a8ac2b10>]}
[0m06:00:21.259641 [info ] [MainThread]: 
[0m06:00:21.267236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:21.276300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m06:00:21.343527 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m06:00:21.348350 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m06:00:21.353306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:22.529161 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:00:22.539205 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m06:00:22.861263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m06:00:22.911693 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m06:00:22.916873 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m06:00:22.922093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:23.837345 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:00:23.848648 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m06:00:24.084764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a89a1750>]}
[0m06:00:24.091833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:24.097207 [info ] [MainThread]: 
[0m06:00:24.113484 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m06:00:24.119759 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m06:00:24.127575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m06:00:24.133662 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m06:00:24.226007 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m06:00:24.250637 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 06:00:24.138230 => 06:00:24.249629
[0m06:00:24.254314 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m06:00:24.328767 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m06:00:24.345043 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m06:00:24.347091 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m06:00:24.349283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:25.718769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:25.835971 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 06:00:24.257434 => 06:00:25.835231
[0m06:00:25.839695 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m06:00:26.067138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a8653bd0>]}
[0m06:00:26.076200 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 1.94s]
[0m06:00:26.086019 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m06:00:26.092892 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m06:00:26.099335 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m06:00:26.108535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m06:00:26.114684 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m06:00:26.243181 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m06:00:26.263947 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 06:00:26.119491 => 06:00:26.263194
[0m06:00:26.266560 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m06:00:26.276160 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m06:00:26.300188 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m06:00:26.303042 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    "InvoiceDate" AS datetime_id,
    CASE
      WHEN LENGTH("InvoiceDate") = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        TO_TIMESTAMP("InvoiceDate", 'DD/MM/YYYY HH24:MI')
      WHEN LENGTH("InvoiceDate") <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        TO_TIMESTAMP("InvoiceDate", 'MM/DD/YY HH24:MI')
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE "InvoiceDate" IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m06:00:26.305825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:27.352091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:27.358497 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 06:00:26.268605 => 06:00:27.357978
[0m06:00:27.360693 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m06:00:27.561248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a8b3b710>]}
[0m06:00:27.563501 [info ] [Thread-1 (]: 2 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_datetime ................ [[32mSUCCESS 1[0m in 1.46s]
[0m06:00:27.566086 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m06:00:27.568284 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m06:00:27.570499 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m06:00:27.572891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m06:00:27.574746 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m06:00:27.584518 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m06:00:27.601403 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 06:00:27.576156 => 06:00:27.600835
[0m06:00:27.603417 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m06:00:27.609951 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m06:00:27.627437 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m06:00:27.629611 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
        );
[0m06:00:27.631735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:28.683346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:28.689301 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 06:00:27.604967 => 06:00:28.688885
[0m06:00:28.691246 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m06:00:28.892708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08aa744a50>]}
[0m06:00:28.894994 [info ] [Thread-1 (]: 3 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_product ................. [[32mSUCCESS 1[0m in 1.32s]
[0m06:00:28.897348 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m06:00:28.900357 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m06:00:28.902528 [info ] [Thread-1 (]: 4 of 4 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m06:00:28.904840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m06:00:28.906898 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m06:00:28.920902 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m06:00:28.938533 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 06:00:28.908572 => 06:00:28.937942
[0m06:00:28.940786 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m06:00:28.948623 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m06:00:28.975112 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m06:00:28.978334 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity" AS quantity,
        "Quantity" * UnitPrice AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
        );
[0m06:00:28.981264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:29.674602 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a848-0000-000f-0000-00000f492fd5
[0m06:00:29.676662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 21
invalid identifier 'UNITPRICE'
[0m06:00:29.678863 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 06:00:28.942627 => 06:00:29.678432
[0m06:00:29.680790 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m06:00:29.890886 [debug] [Thread-1 (]: Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000904 (42000): SQL compilation error: error line 10 at position 21
  invalid identifier 'UNITPRICE'
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m06:00:29.893019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a08c2ff-a19e-4ff2-a215-3301a2b3f415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a2d8b8d0>]}
[0m06:00:29.895167 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model ASTRO_SDK_SCHEMA.fct_invoices ............ [[31mERROR[0m in 0.99s]
[0m06:00:29.897451 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m06:00:29.902273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:29.904076 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m06:00:29.905857 [info ] [MainThread]: 
[0m06:00:29.907796 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m06:00:29.911169 [debug] [MainThread]: Command end result
[0m06:00:29.955246 [info ] [MainThread]: 
[0m06:00:29.957008 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:00:29.958719 [info ] [MainThread]: 
[0m06:00:29.960458 [error] [MainThread]:   Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000904 (42000): SQL compilation error: error line 10 at position 21
  invalid identifier 'UNITPRICE'
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m06:00:29.962282 [info ] [MainThread]: 
[0m06:00:29.964410 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:00:29.967024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.778722, "process_user_time": 6.210721, "process_kernel_time": 0.383128, "process_mem_max_rss": "134908", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m06:00:29.969146 [debug] [MainThread]: Command `dbt run` failed at 06:00:29.968884 after 13.78 seconds
[0m06:00:29.971093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a9a7e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08a9a7c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ae01f350>]}
[0m06:00:29.973146 [debug] [MainThread]: Flushing usage events
[0m06:01:07.978960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2813a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb28cbfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb280670d0>]}


============================== 06:01:07.985874 | f55cd247-c149-4340-9b01-32b6e04db269 ==============================
[0m06:01:07.985874 [info ] [MainThread]: Running with dbt=1.7.11
[0m06:01:07.989994 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/', 'debug': 'False'}
[0m06:01:08.493953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26faf690>]}
[0m06:01:08.660357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb280519d0>]}
[0m06:01:08.662866 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m06:01:08.746715 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m06:01:12.482514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:01:12.484527 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m06:01:12.719249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26e45a90>]}
[0m06:01:12.771511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26d8dad0>]}
[0m06:01:12.773556 [info ] [MainThread]: Found 4 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m06:01:12.775351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26f8a2d0>]}
[0m06:01:12.779239 [info ] [MainThread]: 
[0m06:01:12.781881 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:01:12.785475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m06:01:12.811366 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m06:01:12.813473 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m06:01:12.815446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:13.783089 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:01:13.791065 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m06:01:14.053025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m06:01:14.077176 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m06:01:14.080085 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m06:01:14.082769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:14.915604 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m06:01:14.919054 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m06:01:15.177396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26eb3c90>]}
[0m06:01:15.179830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:01:15.181442 [info ] [MainThread]: 
[0m06:01:15.185820 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m06:01:15.187806 [info ] [Thread-1 (]: 1 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m06:01:15.190081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m06:01:15.191981 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m06:01:15.209137 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m06:01:15.229516 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 06:01:15.193587 => 06:01:15.228775
[0m06:01:15.231909 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m06:01:15.285009 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m06:01:15.304160 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m06:01:15.306167 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m06:01:15.308151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:16.431520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:01:16.537467 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 06:01:15.233662 => 06:01:16.536929
[0m06:01:16.539932 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m06:01:16.758408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2713cb50>]}
[0m06:01:16.764659 [info ] [Thread-1 (]: 1 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 1.57s]
[0m06:01:16.771780 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m06:01:16.777857 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m06:01:16.783874 [info ] [Thread-1 (]: 2 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m06:01:16.791395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m06:01:16.797940 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m06:01:16.820140 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m06:01:16.865425 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 06:01:16.803653 => 06:01:16.863395
[0m06:01:16.871334 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m06:01:16.891495 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m06:01:16.952599 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m06:01:16.958353 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    "InvoiceDate" AS datetime_id,
    CASE
      WHEN LENGTH("InvoiceDate") = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        TO_TIMESTAMP("InvoiceDate", 'DD/MM/YYYY HH24:MI')
      WHEN LENGTH("InvoiceDate") <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        TO_TIMESTAMP("InvoiceDate", 'MM/DD/YY HH24:MI')
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE "InvoiceDate" IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m06:01:16.964068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:18.006280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:01:18.023623 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 06:01:16.876171 => 06:01:18.022311
[0m06:01:18.028735 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m06:01:18.258933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26f404d0>]}
[0m06:01:18.264843 [info ] [Thread-1 (]: 2 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_datetime ................ [[32mSUCCESS 1[0m in 1.47s]
[0m06:01:18.271785 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m06:01:18.277388 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m06:01:18.283249 [info ] [Thread-1 (]: 3 of 4 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m06:01:18.290163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m06:01:18.295001 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m06:01:18.329861 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m06:01:18.361021 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 06:01:18.298842 => 06:01:18.359835
[0m06:01:18.364859 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m06:01:18.378585 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m06:01:18.409206 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m06:01:18.413319 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
        );
[0m06:01:18.417539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:19.475667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:01:19.481566 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 06:01:18.367860 => 06:01:19.481154
[0m06:01:19.483484 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m06:01:19.685769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb27191590>]}
[0m06:01:19.689096 [info ] [Thread-1 (]: 3 of 4 OK created sql table model ASTRO_SDK_SCHEMA.dim_product ................. [[32mSUCCESS 1[0m in 1.40s]
[0m06:01:19.692110 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m06:01:19.695169 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m06:01:19.698027 [info ] [Thread-1 (]: 4 of 4 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m06:01:19.701245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m06:01:19.703664 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m06:01:19.726203 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m06:01:19.749684 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 06:01:19.706156 => 06:01:19.748715
[0m06:01:19.752366 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m06:01:19.762898 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m06:01:19.788989 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m06:01:19.792077 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity" AS quantity,
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
        );
[0m06:01:19.794991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:18:48.062850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1048.0 seconds
[0m06:18:48.097055 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 06:01:19.754618 => 06:18:48.095281
[0m06:18:48.103224 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m06:18:48.370969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f55cd247-c149-4340-9b01-32b6e04db269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb26b4fad0>]}
[0m06:18:48.376108 [info ] [Thread-1 (]: 4 of 4 OK created sql table model ASTRO_SDK_SCHEMA.fct_invoices ................ [[32mSUCCESS 1[0m in 1048.67s]
[0m06:18:48.381519 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m06:18:48.393685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:18:48.396982 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m06:18:48.400755 [info ] [MainThread]: 
[0m06:18:48.404674 [info ] [MainThread]: Finished running 4 table models in 0 hours 17 minutes and 35.62 seconds (1055.62s).
[0m06:18:48.414071 [debug] [MainThread]: Command end result
[0m06:18:48.493942 [info ] [MainThread]: 
[0m06:18:48.496615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:18:48.499002 [info ] [MainThread]: 
[0m06:18:48.501476 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:18:48.507325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1060.8505, "process_user_time": 5.170021, "process_kernel_time": 0.320095, "process_mem_max_rss": "131916", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m06:18:48.511175 [debug] [MainThread]: Command `dbt run` succeeded at 06:18:48.510553 after 1060.85 seconds
[0m06:18:48.514450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2c63f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2c6e4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb2c6e4f50>]}
[0m06:18:48.516963 [debug] [MainThread]: Flushing usage events
[0m08:40:16.433747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e95816bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e95817150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e957dd7d0>]}


============================== 08:40:16.436431 | 18963118-a238-4d66-bb3d-e220c4ce6dcd ==============================
[0m08:40:16.436431 [info ] [MainThread]: Running with dbt=1.7.11
[0m08:40:16.438646 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None'}
[0m08:40:16.795857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e949456d0>]}
[0m08:40:16.888797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e95801d50>]}
[0m08:40:16.890796 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m08:40:16.935307 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m08:40:17.724468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m08:40:17.725592 [debug] [MainThread]: Partial parsing: added file: retail://models/report/report_year_invoices.sql
[0m08:40:17.726477 [debug] [MainThread]: Partial parsing: added file: retail://models/report/report_product_invoices.sql
[0m08:40:17.727470 [debug] [MainThread]: Partial parsing: added file: retail://models/report/report_customer_invoices.sql
[0m08:40:17.886478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e947618d0>]}
[0m08:40:17.923708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e94430490>]}
[0m08:40:17.924851 [info ] [MainThread]: Found 7 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m08:40:17.926518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e946c7cd0>]}
[0m08:40:17.931627 [info ] [MainThread]: 
[0m08:40:17.933974 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:40:17.937431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m08:40:17.957088 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m08:40:17.958702 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m08:40:17.960164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:21.592449 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m08:40:21.595074 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m08:40:22.661019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m08:40:22.672625 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m08:40:22.674262 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m08:40:22.675828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:25.047862 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m08:40:25.051495 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m08:40:26.124727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e946a9190>]}
[0m08:40:26.126851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:40:26.128555 [info ] [MainThread]: 
[0m08:40:26.132828 [debug] [Thread-1 (]: Began running node model.retail.report_customer_invoices
[0m08:40:26.134417 [info ] [Thread-1 (]: 1 of 3 START sql table model ASTRO_SDK_SCHEMA.report_customer_invoices ......... [RUN]
[0m08:40:26.136762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.report_customer_invoices)
[0m08:40:26.138842 [debug] [Thread-1 (]: Began compiling node model.retail.report_customer_invoices
[0m08:40:26.150731 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_customer_invoices"
[0m08:40:26.166185 [debug] [Thread-1 (]: Timing info for model.retail.report_customer_invoices (compile): 08:40:26.140619 => 08:40:26.165458
[0m08:40:26.167542 [debug] [Thread-1 (]: Began executing node model.retail.report_customer_invoices
[0m08:40:26.212032 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_customer_invoices"
[0m08:40:26.226757 [debug] [Thread-1 (]: Using snowflake connection "model.retail.report_customer_invoices"
[0m08:40:26.227814 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_customer_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_customer_invoices
         as
        (SELECT
  c.country,
  c.iso,
  COUNT(fi.invoice_id) AS total_invoices,
  SUM(fi.total) AS total_revenue
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi
JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer c ON fi.customer_id = c.customer_id
GROUP BY c.country, c.iso
ORDER BY total_revenue DESC
LIMIT 10
        );
[0m08:40:26.228780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:41.525335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 435.0 seconds
[0m08:47:41.553232 [debug] [Thread-1 (]: Timing info for model.retail.report_customer_invoices (execute): 08:40:26.168374 => 08:47:41.552803
[0m08:47:41.554818 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: Close
[0m08:47:43.456037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18963118-a238-4d66-bb3d-e220c4ce6dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e9454c990>]}
[0m08:47:43.457753 [info ] [Thread-1 (]: 1 of 3 OK created sql table model ASTRO_SDK_SCHEMA.report_customer_invoices .... [[32mSUCCESS 1[0m in 437.32s]
[0m08:47:43.459584 [debug] [Thread-1 (]: Finished running node model.retail.report_customer_invoices
[0m08:47:43.461114 [debug] [Thread-1 (]: Began running node model.retail.report_product_invoices
[0m08:47:43.462702 [info ] [Thread-1 (]: 2 of 3 START sql table model ASTRO_SDK_SCHEMA.report_product_invoices .......... [RUN]
[0m08:47:43.464415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_customer_invoices, now model.retail.report_product_invoices)
[0m08:47:43.465704 [debug] [Thread-1 (]: Began compiling node model.retail.report_product_invoices
[0m08:47:43.473847 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_product_invoices"
[0m08:47:43.481965 [debug] [Thread-1 (]: Timing info for model.retail.report_product_invoices (compile): 08:47:43.466750 => 08:47:43.481483
[0m08:47:43.483090 [debug] [Thread-1 (]: Began executing node model.retail.report_product_invoices
[0m08:47:43.574732 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_product_invoices"
[0m08:47:43.587651 [debug] [Thread-1 (]: Using snowflake connection "model.retail.report_product_invoices"
[0m08:47:43.588955 [debug] [Thread-1 (]: On model.retail.report_product_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_product_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_product_invoices
         as
        (SELECT
  p.product_id,
  p.stock_code,
  p.description,
  SUM(fi.quantity) AS total_quantity_sold
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi
JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product p ON fi.product_id = p.product_id
GROUP BY p.product_id, p.stock_code, p.description
ORDER BY total_quantity_sold DESC
LIMIT 10
        );
[0m08:47:43.590244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:38.677231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472331f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47246bd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4723970ad0>]}


============================== 09:40:38.683669 | 2fd2ec75-77e6-4e70-8257-47c45ceee996 ==============================
[0m09:40:38.683669 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:40:38.687678 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run --select path:models/report --profiles-dir /usr/local/airflow/include/dbt/', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m09:40:39.218082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472242c5d0>]}
[0m09:40:39.394086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4722307dd0>]}
[0m09:40:39.396796 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:40:39.451001 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:40:43.621840 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m09:40:43.623443 [debug] [MainThread]: Partial parsing: deleted file: retail://models/report/report_product_invoices.sql
[0m09:40:43.656186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472233f290>]}
[0m09:40:43.706228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47220d9450>]}
[0m09:40:43.708103 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m09:40:43.709917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47223df0d0>]}
[0m09:40:43.717082 [info ] [MainThread]: 
[0m09:40:43.719380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:40:43.722329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m09:40:43.748282 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m09:40:43.750679 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m09:40:43.752861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:44.965298 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:40:44.975455 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m09:40:45.303688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m09:40:45.350392 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m09:40:45.355800 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m09:40:45.361029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:46.280069 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m09:40:46.291160 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m09:40:46.538917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472205ff90>]}
[0m09:40:46.545780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:46.551650 [info ] [MainThread]: 
[0m09:40:46.567115 [debug] [Thread-1 (]: Began running node model.retail.report_customer_invoices
[0m09:40:46.573323 [info ] [Thread-1 (]: 1 of 2 START sql table model ASTRO_SDK_SCHEMA.report_customer_invoices ......... [RUN]
[0m09:40:46.581654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.report_customer_invoices)
[0m09:40:46.587716 [debug] [Thread-1 (]: Began compiling node model.retail.report_customer_invoices
[0m09:40:46.636779 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_customer_invoices"
[0m09:40:46.681532 [debug] [Thread-1 (]: Timing info for model.retail.report_customer_invoices (compile): 09:40:46.592340 => 09:40:46.679679
[0m09:40:46.687467 [debug] [Thread-1 (]: Began executing node model.retail.report_customer_invoices
[0m09:40:46.820389 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_customer_invoices"
[0m09:40:46.835739 [debug] [Thread-1 (]: Using snowflake connection "model.retail.report_customer_invoices"
[0m09:40:46.837706 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_customer_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_customer_invoices
         as
        (SELECT
  c.country,
  c.iso,
  COUNT(fi.invoice_id) AS total_invoices,
  SUM(fi.total) AS total_revenue
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi
JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer c ON fi.customer_id = c.customer_id
GROUP BY c.country, c.iso
ORDER BY total_revenue DESC
LIMIT 10
        );
[0m09:40:46.839938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:14.474818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 868.0 seconds
[0m09:55:14.516350 [debug] [Thread-1 (]: Timing info for model.retail.report_customer_invoices (execute): 09:40:46.694227 => 09:55:14.515533
[0m09:55:14.518349 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: Close
[0m09:55:14.781149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4721ec49d0>]}
[0m09:55:14.784018 [info ] [Thread-1 (]: 1 of 2 OK created sql table model ASTRO_SDK_SCHEMA.report_customer_invoices .... [[32mSUCCESS 1[0m in 868.20s]
[0m09:55:14.786641 [debug] [Thread-1 (]: Finished running node model.retail.report_customer_invoices
[0m09:55:14.788848 [debug] [Thread-1 (]: Began running node model.retail.report_year_invoices
[0m09:55:14.791135 [info ] [Thread-1 (]: 2 of 2 START sql table model ASTRO_SDK_SCHEMA.report_year_invoices ............. [RUN]
[0m09:55:14.793999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_customer_invoices, now model.retail.report_year_invoices)
[0m09:55:14.796413 [debug] [Thread-1 (]: Began compiling node model.retail.report_year_invoices
[0m09:55:14.808750 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_year_invoices"
[0m09:55:14.825809 [debug] [Thread-1 (]: Timing info for model.retail.report_year_invoices (compile): 09:55:14.798062 => 09:55:14.825128
[0m09:55:14.828324 [debug] [Thread-1 (]: Began executing node model.retail.report_year_invoices
[0m09:55:14.839526 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_year_invoices"
[0m09:55:14.859120 [debug] [Thread-1 (]: Using snowflake connection "model.retail.report_year_invoices"
[0m09:55:14.862327 [debug] [Thread-1 (]: On model.retail.report_year_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_year_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_year_invoices
         as
        (SELECT
  dt.year,
  dt.month,
  COUNT(DISTINCT fi.invoice_id) AS num_invoices,
  SUM(fi.total) AS total_revenue
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi
JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
GROUP BY dt.year, dt.month
ORDER BY dt.year, dt.month
        );
[0m09:55:14.865070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:56:13.542448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 59.0 seconds
[0m09:56:13.548866 [debug] [Thread-1 (]: Timing info for model.retail.report_year_invoices (execute): 09:55:14.830169 => 09:56:13.548319
[0m09:56:13.550811 [debug] [Thread-1 (]: On model.retail.report_year_invoices: Close
[0m09:56:13.774388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fd2ec75-77e6-4e70-8257-47c45ceee996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4725ef5710>]}
[0m09:56:13.776865 [info ] [Thread-1 (]: 2 of 2 OK created sql table model ASTRO_SDK_SCHEMA.report_year_invoices ........ [[32mSUCCESS 1[0m in 58.98s]
[0m09:56:13.779807 [debug] [Thread-1 (]: Finished running node model.retail.report_year_invoices
[0m09:56:13.785755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:13.787513 [debug] [MainThread]: Connection 'model.retail.report_year_invoices' was properly closed.
[0m09:56:13.789518 [info ] [MainThread]: 
[0m09:56:13.791763 [info ] [MainThread]: Finished running 2 table models in 0 hours 15 minutes and 30.07 seconds (930.07s).
[0m09:56:13.795199 [debug] [MainThread]: Command end result
[0m09:56:13.842298 [info ] [MainThread]: 
[0m09:56:13.844392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:13.846472 [info ] [MainThread]: 
[0m09:56:13.848756 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:56:13.852666 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 935.469, "process_user_time": 4.983536, "process_kernel_time": 0.622942, "process_mem_max_rss": "130328", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m09:56:13.854996 [debug] [MainThread]: Command `dbt run` succeeded at 09:56:13.854541 after 935.47 seconds
[0m09:56:13.856741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4727873410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47278734d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47279adf10>]}
[0m09:56:13.858346 [debug] [MainThread]: Flushing usage events
[0m11:38:05.941743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c948c8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c94909d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9491eb10>]}


============================== 11:38:05.945303 | 9b504113-a4b4-46bc-b39b-c0d4efe63d58 ==============================
[0m11:38:05.945303 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:38:05.947179 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run -s fct_invoices', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt'}
[0m11:38:06.511046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c948f9310>]}
[0m11:38:06.631864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c94d6ff10>]}
[0m11:38:06.634163 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m11:38:06.683550 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:38:08.817264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:08.819079 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m11:38:09.063076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c93619890>]}
[0m11:38:09.114960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c936d1050>]}
[0m11:38:09.116726 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m11:38:09.118574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c93403950>]}
[0m11:38:09.122190 [info ] [MainThread]: 
[0m11:38:09.124890 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:09.128544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m11:38:09.154280 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m11:38:09.156636 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m11:38:09.158614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:10.197621 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:38:10.202321 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m11:38:10.409155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m11:38:10.423636 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m11:38:10.425423 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m11:38:10.427172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:10.995407 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:38:10.998710 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m11:38:11.211047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c937abd10>]}
[0m11:38:11.215718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:11.218853 [info ] [MainThread]: 
[0m11:38:11.227045 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m11:38:11.230438 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m11:38:11.235067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m11:38:11.238518 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m11:38:11.282463 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m11:38:11.303665 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 11:38:11.241080 => 11:38:11.302926
[0m11:38:11.306438 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m11:38:11.377116 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m11:38:11.401794 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m11:38:11.404714 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity",
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
),
filtered_invoices AS (
    SELECT DISTINCT
        invoice_id,
        datetime_id,
        product_id,
        customer_id,
        "Quantity",
        total
    FROM fct_invoices_cte
),
final_result AS (
    SELECT
        fi.invoice_id,
        dt.datetime_id,
        dp.product_id,
        dc.customer_id,
        fi.quantity,
        fi.total
    FROM filtered_invoices fi
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
)
SELECT * FROM final_result;
[0m11:38:11.407624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:12.325689 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3af3a-0000-000a-0000-00000f49481d
[0m11:38:12.329450 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 26 unexpected ';'.
[0m11:38:12.333321 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 11:38:11.308430 => 11:38:12.332494
[0m11:38:12.337060 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m11:38:12.560321 [debug] [Thread-1 (]: Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 26 unexpected ';'.
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m11:38:12.565492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b504113-a4b4-46bc-b39b-c0d4efe63d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c93371050>]}
[0m11:38:12.571729 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.fct_invoices ............ [[31mERROR[0m in 1.33s]
[0m11:38:12.576989 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m11:38:12.591131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:12.594939 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m11:38:12.598283 [info ] [MainThread]: 
[0m11:38:12.602758 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m11:38:12.608692 [debug] [MainThread]: Command end result
[0m11:38:12.687347 [info ] [MainThread]: 
[0m11:38:12.689597 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:38:12.691874 [info ] [MainThread]: 
[0m11:38:12.693982 [error] [MainThread]:   Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 26 unexpected ';'.
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m11:38:12.696066 [info ] [MainThread]: 
[0m11:38:12.698638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:38:12.703111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.839424, "process_user_time": 4.501773, "process_kernel_time": 0.743596, "process_mem_max_rss": "132516", "process_in_blocks": "416", "process_out_blocks": "8", "command_success": false}
[0m11:38:12.706030 [debug] [MainThread]: Command `dbt run` failed at 11:38:12.705647 after 6.84 seconds
[0m11:38:12.708423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c95cfd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c98d0b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c937fefd0>]}
[0m11:38:12.710825 [debug] [MainThread]: Flushing usage events
[0m11:38:58.776000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9f32fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9f31ae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9f31bad0>]}


============================== 11:38:58.780682 | b7126dbf-f3fb-4419-b6b1-8640293773a3 ==============================
[0m11:38:58.780682 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:38:58.783219 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run -s fct_invoices', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'introspect': 'True'}
[0m11:38:59.315005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e83dd90>]}
[0m11:38:59.438565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e83dd90>]}
[0m11:38:59.440825 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m11:38:59.493773 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:39:01.194815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:39:01.196714 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m11:39:01.459239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e046190>]}
[0m11:39:01.508455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e280590>]}
[0m11:39:01.510633 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m11:39:01.512789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ffcc9d0>]}
[0m11:39:01.516345 [info ] [MainThread]: 
[0m11:39:01.519114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:39:01.523066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m11:39:01.551129 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m11:39:01.553283 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m11:39:01.555491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:02.423069 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:39:02.429640 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m11:39:02.673669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m11:39:02.703800 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m11:39:02.707151 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m11:39:02.710475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:03.485020 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:39:03.491951 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m11:39:03.720942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e239050>]}
[0m11:39:03.725429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:39:03.728789 [info ] [MainThread]: 
[0m11:39:03.738174 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m11:39:03.741868 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m11:39:03.746824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m11:39:03.750494 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m11:39:03.785427 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m11:39:03.807302 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 11:39:03.753649 => 11:39:03.806483
[0m11:39:03.810131 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m11:39:03.878286 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m11:39:03.903362 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m11:39:03.906236 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity",
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
),
filtered_invoices AS (
    SELECT DISTINCT
        invoice_id,
        datetime_id,
        product_id,
        customer_id,
        "Quantity",
        total
    FROM fct_invoices_cte
),
final_result AS (
    SELECT
        fi.invoice_id,
        dt.datetime_id,
        dp.product_id,
        dc.customer_id,
        fi.quantity,
        fi.total
    FROM filtered_invoices fi
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
)
SELECT * FROM final_result
        );
[0m11:39:03.909176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:04.604344 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3af3b-0000-000a-0000-00000f494821
[0m11:39:04.606255 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 30 at position 8
invalid identifier 'FI.QUANTITY'
[0m11:39:04.608410 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 11:39:03.812169 => 11:39:04.607940
[0m11:39:04.610315 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m11:39:04.815503 [debug] [Thread-1 (]: Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000904 (42000): SQL compilation error: error line 30 at position 8
  invalid identifier 'FI.QUANTITY'
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m11:39:04.817711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7126dbf-f3fb-4419-b6b1-8640293773a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9de277d0>]}
[0m11:39:04.820198 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.fct_invoices ............ [[31mERROR[0m in 1.07s]
[0m11:39:04.822696 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m11:39:04.827986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:04.829818 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m11:39:04.831948 [info ] [MainThread]: 
[0m11:39:04.834087 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m11:39:04.836902 [debug] [MainThread]: Command end result
[0m11:39:04.878988 [info ] [MainThread]: 
[0m11:39:04.880920 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:39:04.882810 [info ] [MainThread]: 
[0m11:39:04.884730 [error] [MainThread]:   Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000904 (42000): SQL compilation error: error line 30 at position 8
  invalid identifier 'FI.QUANTITY'
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m11:39:04.886851 [info ] [MainThread]: 
[0m11:39:04.889371 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:39:04.892245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.249843, "process_user_time": 4.356353, "process_kernel_time": 0.372841, "process_mem_max_rss": "132812", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m11:39:04.894563 [debug] [MainThread]: Command `dbt run` failed at 11:39:04.894154 after 6.25 seconds
[0m11:39:04.896648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ffcce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7da389f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9dec5390>]}
[0m11:39:04.898566 [debug] [MainThread]: Flushing usage events
[0m11:40:08.687752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3237acf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3238edd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3237acc610>]}


============================== 11:40:08.693002 | 584ac121-356f-42e7-8a31-9d6687fed780 ==============================
[0m11:40:08.693002 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:40:08.696059 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt run -s fct_invoices', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True'}
[0m11:40:09.252231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3236bd4a10>]}
[0m11:40:09.402787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3237ae9650>]}
[0m11:40:09.406111 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m11:40:09.464409 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:40:11.673635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:40:11.675451 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m11:40:11.905200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32367ff510>]}
[0m11:40:11.953001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323677fb10>]}
[0m11:40:11.954899 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m11:40:11.956588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3236988450>]}
[0m11:40:11.959694 [info ] [MainThread]: 
[0m11:40:11.961918 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:40:11.964586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m11:40:11.987408 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m11:40:11.989309 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m11:40:11.991131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:12.997362 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:40:13.007460 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m11:40:13.270860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m11:40:13.318145 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m11:40:13.323557 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m11:40:13.329314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:14.014866 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:40:14.025737 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m11:40:14.279413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3236ac7cd0>]}
[0m11:40:14.286785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:14.291954 [info ] [MainThread]: 
[0m11:40:14.306509 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m11:40:14.313775 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m11:40:14.320932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m11:40:14.326712 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m11:40:14.395266 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m11:40:14.440647 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 11:40:14.331538 => 11:40:14.439128
[0m11:40:14.446362 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m11:40:14.556147 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m11:40:14.575720 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m11:40:14.578210 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity",
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
),
filtered_invoices AS (
    SELECT DISTINCT
        invoice_id,
        datetime_id,
        product_id,
        customer_id,
        quantity,
        total
    FROM fct_invoices_cte
),
final_result AS (
    SELECT
        fi.invoice_id,
        dt.datetime_id,
        dp.product_id,
        dc.customer_id,
        fi.quantity,
        fi.total
    FROM filtered_invoices fi
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
)
SELECT * FROM final_result
        );
[0m11:40:14.581090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:15.470209 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3af3c-0000-000a-0000-00000f49482d
[0m11:40:15.476811 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'QUANTITY'
[0m11:40:15.483071 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 11:40:14.450892 => 11:40:15.481674
[0m11:40:15.488272 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m11:40:15.734237 [debug] [Thread-1 (]: Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m11:40:15.740255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584ac121-356f-42e7-8a31-9d6687fed780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32365c47d0>]}
[0m11:40:15.746568 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.fct_invoices ............ [[31mERROR[0m in 1.42s]
[0m11:40:15.753366 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m11:40:15.769508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:15.774851 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m11:40:15.780297 [info ] [MainThread]: 
[0m11:40:15.786272 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m11:40:15.794433 [debug] [MainThread]: Command end result
[0m11:40:15.916841 [info ] [MainThread]: 
[0m11:40:15.922519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:40:15.927681 [info ] [MainThread]: 
[0m11:40:15.933538 [error] [MainThread]:   Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'QUANTITY'
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m11:40:15.939655 [info ] [MainThread]: 
[0m11:40:15.946011 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:40:15.953859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.370559, "process_user_time": 4.970996, "process_kernel_time": 0.340068, "process_mem_max_rss": "132444", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m11:40:15.960547 [debug] [MainThread]: Command `dbt run` failed at 11:40:15.959576 after 7.38 seconds
[0m11:40:15.966222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3237aaa4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3237ac31d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323beeb190>]}
[0m11:40:15.971366 [debug] [MainThread]: Flushing usage events
[0m11:40:59.044059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532160ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05320d9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532f64f10>]}


============================== 11:40:59.049109 | b9830b1d-4fcc-48d3-a166-989f766a277e ==============================
[0m11:40:59.049109 [info ] [MainThread]: Running with dbt=1.7.11
[0m11:40:59.051874 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s fct_invoices', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True'}
[0m11:40:59.586239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530a4b350>]}
[0m11:40:59.736626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531af9290>]}
[0m11:40:59.739023 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m11:40:59.793247 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m11:41:01.363307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:01.364917 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m11:41:01.608990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053099e1d0>]}
[0m11:41:01.669324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530634c50>]}
[0m11:41:01.671640 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m11:41:01.673648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530656910>]}
[0m11:41:01.677217 [info ] [MainThread]: 
[0m11:41:01.679753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:01.682899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m11:41:01.709668 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m11:41:01.711890 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m11:41:01.713886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:02.629081 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:41:02.636722 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m11:41:02.869336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m11:41:02.915410 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m11:41:02.920951 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m11:41:02.926226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:03.638854 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m11:41:03.649840 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m11:41:03.901077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530649810>]}
[0m11:41:03.908138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:03.913552 [info ] [MainThread]: 
[0m11:41:03.927885 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m11:41:03.934371 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m11:41:03.942029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m11:41:03.947636 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m11:41:04.016517 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m11:41:04.062776 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 11:41:03.952148 => 11:41:04.061203
[0m11:41:04.068276 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m11:41:04.182254 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m11:41:04.202413 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m11:41:04.205064 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity" as quantity,
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
),
filtered_invoices AS (
    SELECT DISTINCT
        invoice_id,
        datetime_id,
        product_id,
        customer_id,
        quantity,
        total
    FROM fct_invoices_cte
),
final_result AS (
    SELECT
        fi.invoice_id,
        dt.datetime_id,
        dp.product_id,
        dc.customer_id,
        fi.quantity,
        fi.total
    FROM filtered_invoices fi
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
    INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
)
SELECT * FROM final_result
        );
[0m11:41:04.208016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:59:08.030475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1084.0 seconds
[0m11:59:08.091563 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 11:41:04.072605 => 11:59:08.090935
[0m11:59:08.093664 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m11:59:08.336284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9830b1d-4fcc-48d3-a166-989f766a277e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531ad1290>]}
[0m11:59:08.338645 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.fct_invoices ................ [[32mSUCCESS 1[0m in 1084.40s]
[0m11:59:08.340885 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m11:59:08.346706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:08.348435 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m11:59:08.350368 [info ] [MainThread]: 
[0m11:59:08.352244 [info ] [MainThread]: Finished running 1 table model in 0 hours 18 minutes and 6.67 seconds (1086.67s).
[0m11:59:08.355144 [debug] [MainThread]: Command end result
[0m11:59:08.411980 [info ] [MainThread]: 
[0m11:59:08.414355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:08.416670 [info ] [MainThread]: 
[0m11:59:08.419012 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:08.422896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1089.6675, "process_user_time": 4.738845, "process_kernel_time": 0.438966, "process_mem_max_rss": "131940", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m11:59:08.425305 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:08.424976 after 1089.67 seconds
[0m11:59:08.427650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05360f1050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053604b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0536185e10>]}
[0m11:59:08.430042 [debug] [MainThread]: Flushing usage events
[0m12:49:46.912481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bba18c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bc021fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bba18c10>]}


============================== 12:49:46.916797 | 8b5420cc-e515-4074-810d-7bafb9e8fa21 ==============================
[0m12:49:46.916797 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:49:46.919086 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run -s fct_invoices', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m12:49:47.505166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4baa20e10>]}
[0m12:49:47.669188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bab12e10>]}
[0m12:49:47.672438 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:49:47.741508 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:49:50.571944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:50.573393 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m12:49:50.867052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ba8693d0>]}
[0m12:49:50.984211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ba77a5d0>]}
[0m12:49:50.989156 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m12:49:50.993842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ba5b04d0>]}
[0m12:49:51.002091 [info ] [MainThread]: 
[0m12:49:51.008515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:51.016947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m12:49:51.079903 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m12:49:51.085180 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m12:49:51.089649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:52.246956 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:49:52.257230 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m12:49:52.505425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m12:49:52.552554 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m12:49:52.557997 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m12:49:52.563159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:53.314151 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:49:53.325195 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m12:49:53.583522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ba9448d0>]}
[0m12:49:53.590755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:53.596276 [info ] [MainThread]: 
[0m12:49:53.612939 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m12:49:53.618950 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m12:49:53.626358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m12:49:53.632365 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m12:49:53.700394 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m12:49:53.748308 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 12:49:53.636963 => 12:49:53.746532
[0m12:49:53.754337 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m12:49:53.870573 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m12:49:53.891066 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m12:49:53.893760 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity" AS quantity,
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
        );
[0m12:49:53.896177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:11.953183 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.retail.fct_invoices' (256451993)
[0m12:50:11.958934 [debug] [MainThread]: Using snowflake connection "master"
[0m12:50:11.964033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "master"} */
select system$cancel_all_queries(256451993)
[0m12:50:11.970032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:50:12.794071 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:50:12.798106 [debug] [MainThread]: Snowflake adapter: Cancel query 'model.retail.fct_invoices': ('1 cancelled. ',)
[0m12:50:12.800272 [error] [MainThread]: CANCEL query model.retail.fct_invoices ......................................... [[31mCANCEL[0m]
[0m12:50:12.802376 [debug] [MainThread]: On master: Close
[0m12:50:12.953758 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3af81-0000-000f-0000-00000f4958e1
[0m12:50:12.956073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000604 (57014): SQL execution canceled
[0m12:50:12.958816 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 12:49:53.758860 => 12:50:12.958274
[0m12:50:12.961018 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m12:50:13.289506 [debug] [Thread-1 (]: Database Error in model fct_invoices (models/transform/fct_invoices.sql)
  000604 (57014): SQL execution canceled
  compiled Code at target/run/retail/models/transform/fct_invoices.sql
[0m12:50:13.293353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b5420cc-e515-4074-810d-7bafb9e8fa21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ba5375d0>]}
[0m12:50:13.297327 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.fct_invoices ............ [[31mERROR[0m in 19.67s]
[0m12:50:13.302375 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m12:50:13.306675 [info ] [MainThread]: 
[0m12:50:13.310095 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m12:50:13.314329 [info ] [MainThread]: 
[0m12:50:13.318089 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m12:50:13.321723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:13.324855 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m12:50:13.328252 [info ] [MainThread]: 
[0m12:50:13.331845 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 22.32 seconds (22.32s).
[0m12:50:13.335948 [error] [MainThread]: Encountered an error:

[0m12:50:13.347531 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 502, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 463, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 387, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 319, in run_queue
    self.job_queue.join()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m12:50:13.353765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 26.535227, "process_user_time": 5.572644, "process_kernel_time": 0.694065, "process_mem_max_rss": "130992", "process_in_blocks": "24", "process_out_blocks": "8", "command_success": false}
[0m12:50:13.358408 [debug] [MainThread]: Command `dbt run` failed at 12:50:13.357461 after 26.54 seconds
[0m12:50:13.362018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ba82a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bff9f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4bba78610>]}
[0m12:50:13.365506 [debug] [MainThread]: Flushing usage events
[0m12:50:41.613551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c55da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c55f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c507a10>]}


============================== 12:50:41.618557 | 45a05ba3-b54a-49ad-b9ed-5d6785852a3c ==============================
[0m12:50:41.618557 [info ] [MainThread]: Running with dbt=1.7.11
[0m12:50:41.621171 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run -s fct_invoices', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None'}
[0m12:50:42.199468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c507a10>]}
[0m12:50:42.388804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c54d990>]}
[0m12:50:42.391554 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m12:50:42.454036 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m12:50:47.458490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:47.461701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:47.480900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53b378950>]}
[0m12:50:47.575092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53b4575d0>]}
[0m12:50:47.578659 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m12:50:47.582278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53b31f510>]}
[0m12:50:47.588366 [info ] [MainThread]: 
[0m12:50:47.593008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:47.598463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m12:50:47.648264 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m12:50:47.651718 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m12:50:47.654965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:48.794232 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:50:48.805819 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m12:50:49.071908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m12:50:49.121367 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m12:50:49.126372 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m12:50:49.131579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:50:50.091837 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m12:50:50.102637 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m12:50:50.342017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53b3c2d10>]}
[0m12:50:50.346351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:50.350368 [info ] [MainThread]: 
[0m12:50:50.362249 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m12:50:50.369135 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m12:50:50.377261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.fct_invoices)
[0m12:50:50.382831 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m12:50:50.512293 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m12:50:50.557896 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 12:50:50.387238 => 12:50:50.556236
[0m12:50:50.563538 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m12:50:50.728497 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m12:50:50.779844 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m12:50:50.786244 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast('StockCode' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Description' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('UnitPrice' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity" AS quantity,
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
        );
[0m12:50:50.793052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:55.440514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a75726d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a7570150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a7571350>]}


============================== 13:18:55.444486 | 471fd260-6cd0-47b9-96b7-0df98d117fee ==============================
[0m13:18:55.444486 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:18:55.448586 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s dim_customer', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs'}
[0m13:18:56.044145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a64d3590>]}
[0m13:18:56.181999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a7595b50>]}
[0m13:18:56.184603 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:18:56.267560 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:19:00.368933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:00.372876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:00.401273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a63187d0>]}
[0m13:19:00.497597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a6287910>]}
[0m13:19:00.500618 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:19:00.503480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a6683b90>]}
[0m13:19:00.509236 [info ] [MainThread]: 
[0m13:19:00.513430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:00.519117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:19:00.565712 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:19:00.569164 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:19:00.572359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:01.758166 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:19:01.766162 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:19:02.123966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:19:02.175904 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:19:02.182273 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:19:02.188236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:02.894066 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:19:02.904690 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:19:03.148895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a63e8990>]}
[0m13:19:03.156356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:03.161750 [info ] [MainThread]: 
[0m13:19:03.176814 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:19:03.183245 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:19:03.190935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:19:03.196861 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:19:03.308980 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:19:03.334096 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:19:03.201849 => 13:19:03.333130
[0m13:19:03.337475 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:19:03.426367 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:19:03.454645 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:19:03.457912 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast('Country' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:19:03.461270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:04.774267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:19:04.881395 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:19:03.339984 => 13:19:04.880424
[0m13:19:04.885687 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:19:05.187367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '471fd260-6cd0-47b9-96b7-0df98d117fee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a62cd0d0>]}
[0m13:19:05.194801 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.00s]
[0m13:19:05.203325 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:19:05.218016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:05.223708 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m13:19:05.229057 [info ] [MainThread]: 
[0m13:19:05.234661 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m13:19:05.242972 [debug] [MainThread]: Command end result
[0m13:19:05.368769 [info ] [MainThread]: 
[0m13:19:05.374513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:05.380037 [info ] [MainThread]: 
[0m13:19:05.389872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:05.418977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.074823, "process_user_time": 6.070448, "process_kernel_time": 0.567521, "process_mem_max_rss": "130492", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:19:05.426663 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:05.425363 after 10.08 seconds
[0m13:19:05.432516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a913a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a75abd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4ab9972d0>]}
[0m13:19:05.438513 [debug] [MainThread]: Flushing usage events
[0m13:20:03.421169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd4f15250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd4f14a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd4f15f90>]}


============================== 13:20:03.428454 | 2a43c1f8-7539-483d-95b7-9ca09154ff72 ==============================
[0m13:20:03.428454 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:20:03.432731 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s dim_customer'}
[0m13:20:04.027612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd4f50610>]}
[0m13:20:04.199757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd4f3de50>]}
[0m13:20:04.203746 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:20:04.309200 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:20:08.615840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:08.617567 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m13:20:08.913475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd3f60a90>]}
[0m13:20:09.035742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd3ac5c50>]}
[0m13:20:09.040598 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:20:09.045604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd4f50610>]}
[0m13:20:09.054152 [info ] [MainThread]: 
[0m13:20:09.061900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:20:09.076976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:20:09.144101 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:20:09.148585 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:20:09.152181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:10.373382 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:20:10.383838 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:20:10.732144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:20:10.780581 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:20:10.785969 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:20:10.791148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:11.493835 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:20:11.507770 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:20:11.755538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd3eb74d0>]}
[0m13:20:11.762861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:11.768525 [info ] [MainThread]: 
[0m13:20:11.784004 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:20:11.791136 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:20:11.800166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:20:11.808746 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:20:11.871030 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:20:11.917920 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:20:11.814604 => 13:20:11.916352
[0m13:20:11.923658 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:20:12.036622 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:20:12.061484 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:20:12.064540 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast('CustomerID' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:20:12.067131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:13.955913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:20:14.071663 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:20:11.928456 => 13:20:14.070862
[0m13:20:14.074990 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:20:14.304091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a43c1f8-7539-483d-95b7-9ca09154ff72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd5917590>]}
[0m13:20:14.311620 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.51s]
[0m13:20:14.320131 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:20:14.333314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:14.338007 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m13:20:14.343465 [info ] [MainThread]: 
[0m13:20:14.351330 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.28 seconds (5.28s).
[0m13:20:14.362282 [debug] [MainThread]: Command end result
[0m13:20:14.481913 [info ] [MainThread]: 
[0m13:20:14.487730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:14.493777 [info ] [MainThread]: 
[0m13:20:14.500127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:20:14.509226 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.254823, "process_user_time": 5.830413, "process_kernel_time": 0.669709, "process_mem_max_rss": "131824", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:20:14.515695 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:14.514677 after 11.26 seconds
[0m13:20:14.521155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd953d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd94972d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcd9497410>]}
[0m13:20:14.526467 [debug] [MainThread]: Flushing usage events
[0m13:21:06.337664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325ae2e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325b47c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325ae2dd90>]}


============================== 13:21:06.344554 | e7f945f1-fb4b-45e6-baf5-2be93ddf525f ==============================
[0m13:21:06.344554 [info ] [MainThread]: Running with dbt=1.7.11
[0m13:21:06.348639 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run -s dim_customer', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True'}
[0m13:21:07.115252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3259dfed50>]}
[0m13:21:07.287232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3259f493d0>]}
[0m13:21:07.290671 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m13:21:07.391189 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m13:21:11.623566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:11.629380 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m13:21:12.083502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3259b5e210>]}
[0m13:21:12.206830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3259a5c410>]}
[0m13:21:12.211436 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m13:21:12.215733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3259dde310>]}
[0m13:21:12.224069 [info ] [MainThread]: 
[0m13:21:12.231092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:12.240233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m13:21:12.299651 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m13:21:12.304110 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m13:21:12.308920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:13.442431 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:21:13.451258 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m13:21:13.706906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m13:21:13.733386 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m13:21:13.736783 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m13:21:13.739674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:14.466371 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:21:14.478821 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m13:21:14.711266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3259b48190>]}
[0m13:21:14.716536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:14.720363 [info ] [MainThread]: 
[0m13:21:14.730875 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m13:21:14.736246 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m13:21:14.742629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m13:21:14.747030 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m13:21:14.781554 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m13:21:14.827895 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 13:21:14.750488 => 13:21:14.826135
[0m13:21:14.833565 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m13:21:14.940203 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m13:21:14.967684 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m13:21:14.971295 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    "CustomerID" as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m13:21:14.974920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:16.355699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:21:16.430169 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 13:21:14.838131 => 13:21:16.429228
[0m13:21:16.434128 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m13:21:16.660791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f945f1-fb4b-45e6-baf5-2be93ddf525f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325820e710>]}
[0m13:21:16.667824 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 1.92s]
[0m13:21:16.674255 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m13:21:16.685043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:16.689204 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m13:21:16.693050 [info ] [MainThread]: 
[0m13:21:16.702469 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m13:21:16.711330 [debug] [MainThread]: Command end result
[0m13:21:16.916887 [info ] [MainThread]: 
[0m13:21:16.921066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:16.924764 [info ] [MainThread]: 
[0m13:21:16.929338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:16.937676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.741065, "process_user_time": 5.95222, "process_kernel_time": 0.582173, "process_mem_max_rss": "134680", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:21:16.942861 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:16.941911 after 10.75 seconds
[0m13:21:16.947204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325b47c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325b47c450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f325f36b2d0>]}
[0m13:21:16.953517 [debug] [MainThread]: Flushing usage events
[0m13:25:47.444244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2097.0 seconds
[0m13:25:47.481211 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 12:50:50.568376 => 13:25:47.480168
[0m13:25:47.483339 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m13:25:47.701805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a05ba3-b54a-49ad-b9ed-5d6785852a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53b3c0090>]}
[0m13:25:47.704921 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.fct_invoices ................ [[32mSUCCESS 1[0m in 2097.33s]
[0m13:25:47.707525 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m13:25:47.713314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:47.714695 [debug] [MainThread]: Connection 'model.retail.fct_invoices' was properly closed.
[0m13:25:47.716521 [info ] [MainThread]: 
[0m13:25:47.718200 [info ] [MainThread]: Finished running 1 table model in 0 hours 35 minutes and 0.12 seconds (2100.12s).
[0m13:25:47.721020 [debug] [MainThread]: Command end result
[0m13:25:47.760844 [info ] [MainThread]: 
[0m13:25:47.762626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:47.764317 [info ] [MainThread]: 
[0m13:25:47.766386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:25:47.769709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2106.5542, "process_user_time": 5.251033, "process_kernel_time": 0.443465, "process_mem_max_rss": "130048", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m13:25:47.771736 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:47.771397 after 2106.56 seconds
[0m13:25:47.773482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c55de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb53c55e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb540aaf310>]}
[0m13:25:47.775298 [debug] [MainThread]: Flushing usage events
[0m14:16:47.428937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812a571210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812a5a5a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812a5a5b50>]}


============================== 14:16:47.431487 | 3939ca4b-2c95-4e02-9e66-dd0c716f867a ==============================
[0m14:16:47.431487 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:16:47.433455 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run -s dim_customer', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:16:47.754812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812966ae90>]}
[0m14:16:47.841191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812a5d31d0>]}
[0m14:16:47.842861 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:16:47.876735 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:16:48.658748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:48.659931 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:16:48.832183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812949edd0>]}
[0m14:16:48.866079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81291d84d0>]}
[0m14:16:48.867192 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:16:48.868767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8129537a50>]}
[0m14:16:48.870976 [info ] [MainThread]: 
[0m14:16:48.872942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:16:48.874792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:16:48.891141 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:16:48.892714 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:16:48.894111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:49.873400 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:16:49.875827 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:16:50.108329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:16:50.121404 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:16:50.122948 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:16:50.124345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:50.712222 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:16:50.715595 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:16:50.929009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8129107190>]}
[0m14:16:50.930806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:50.932550 [info ] [MainThread]: 
[0m14:16:50.936780 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:16:50.938312 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:16:50.940411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:16:50.942318 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:16:50.955392 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:16:50.968649 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:16:50.943576 => 14:16:50.968217
[0m14:16:50.970304 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:16:51.008198 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:16:51.020215 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:16:51.021535 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:16:51.022760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:51.641277 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3afd8-0000-000a-0000-00000f494c11
[0m14:16:51.642886 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:16:51.644542 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:16:50.971717 => 14:16:51.644237
[0m14:16:51.645895 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:16:51.861218 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:16:51.863021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3939ca4b-2c95-4e02-9e66-dd0c716f867a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812961c150>]}
[0m14:16:51.864741 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.92s]
[0m14:16:51.866496 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:16:51.869969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:51.871218 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:16:51.872367 [info ] [MainThread]: 
[0m14:16:51.873719 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m14:16:51.875662 [debug] [MainThread]: Command end result
[0m14:16:51.904333 [info ] [MainThread]: 
[0m14:16:51.905506 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:51.906618 [info ] [MainThread]: 
[0m14:16:51.907682 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:16:51.908787 [info ] [MainThread]: 
[0m14:16:51.909976 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:51.911792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5443935, "process_user_time": 2.938656, "process_kernel_time": 0.158311, "process_mem_max_rss": "133172", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:16:51.913292 [debug] [MainThread]: Command `dbt run` failed at 14:16:51.913060 after 4.55 seconds
[0m14:16:51.914455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812b1edf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812eb8d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f812ec21e10>]}
[0m14:16:51.915503 [debug] [MainThread]: Flushing usage events
[0m14:17:44.471909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dfda4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e218bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dfda5810>]}


============================== 14:17:44.474628 | d99fe6f0-3b37-47f8-a644-4d3461aaefc6 ==============================
[0m14:17:44.474628 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:17:44.477048 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -s dim_customer', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m14:17:44.789484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dedcad90>]}
[0m14:17:44.874553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dfdd1e90>]}
[0m14:17:44.876474 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:17:44.921853 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:17:45.736709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:45.737863 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:17:45.902649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1dedd2fd0>]}
[0m14:17:45.937460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1deaeaf90>]}
[0m14:17:45.938776 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:17:45.940474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1deefd490>]}
[0m14:17:45.942990 [info ] [MainThread]: 
[0m14:17:45.945228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:45.947364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:17:45.964214 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:17:45.965958 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:17:45.967349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:46.931401 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:17:46.937087 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:17:47.175199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:17:47.193200 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:17:47.194710 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:17:47.196216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:47.917998 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:17:47.922215 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:17:48.163563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1deea3610>]}
[0m14:17:48.165555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:48.167082 [info ] [MainThread]: 
[0m14:17:48.170849 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:17:48.172415 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:17:48.174582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:17:48.176514 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:17:48.188900 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:17:48.203278 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:17:48.178037 => 14:17:48.202451
[0m14:17:48.205907 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:17:48.247524 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:17:48.260605 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:17:48.262019 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CUSTOMERID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:17:48.263442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:48.931894 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3afd9-0000-000a-0000-00000f494c1d
[0m14:17:48.933776 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:17:48.935603 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:17:48.207168 => 14:17:48.935245
[0m14:17:48.937240 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:17:49.174932 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:17:49.176966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd99fe6f0-3b37-47f8-a644-4d3461aaefc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1de906950>]}
[0m14:17:49.178921 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.00s]
[0m14:17:49.181748 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:17:49.187421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:49.188998 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:17:49.190202 [info ] [MainThread]: 
[0m14:17:49.191973 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m14:17:49.194638 [debug] [MainThread]: Command end result
[0m14:17:49.230592 [info ] [MainThread]: 
[0m14:17:49.232129 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:17:49.233474 [info ] [MainThread]: 
[0m14:17:49.234933 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:17:49.236400 [info ] [MainThread]: 
[0m14:17:49.237962 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:49.240181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.8250318, "process_user_time": 2.855586, "process_kernel_time": 0.161446, "process_mem_max_rss": "132444", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:17:49.241908 [debug] [MainThread]: Command `dbt run` failed at 14:17:49.241609 after 4.83 seconds
[0m14:17:49.243565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e45b0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1e03299d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1debdf0d0>]}
[0m14:17:49.245352 [debug] [MainThread]: Flushing usage events
[0m14:18:07.849577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7f187190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7f789e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7f1b3c90>]}


============================== 14:18:07.852395 | fe2b4fb0-78ba-4b7b-9037-e4b26557403d ==============================
[0m14:18:07.852395 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:18:07.855972 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'invocation_command': 'dbt run -s dim_customer', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default'}
[0m14:18:08.194859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7e0f0f50>]}
[0m14:18:08.283335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7f1a16d0>]}
[0m14:18:08.285093 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:18:08.331520 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:18:09.117330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:09.118547 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:18:09.317409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7e05c810>]}
[0m14:18:09.348505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7dbfd1d0>]}
[0m14:18:09.349703 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:18:09.351070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7ddd74d0>]}
[0m14:18:09.353818 [info ] [MainThread]: 
[0m14:18:09.356079 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:09.358388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:18:09.378490 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:18:09.379840 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:18:09.381172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:10.150419 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:18:10.153327 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:18:10.371176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:18:10.381815 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:18:10.383381 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:18:10.384745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:10.936149 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:18:10.939262 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:18:11.151136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7e13dd50>]}
[0m14:18:11.158019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:11.162683 [info ] [MainThread]: 
[0m14:18:11.171583 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:18:11.174531 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:18:11.177819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:18:11.180030 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:18:11.195230 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:18:11.205840 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:18:11.181754 => 14:18:11.205187
[0m14:18:11.207456 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:18:11.244958 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:18:11.255600 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:18:11.256670 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast( as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:18:11.257781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:12.038156 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3afda-0000-000a-0000-00000f494c25
[0m14:18:12.040040 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 29 unexpected 'as'.
[0m14:18:12.041994 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:18:11.208303 => 14:18:12.041642
[0m14:18:12.043688 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:18:12.245521 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 29 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:18:12.247069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe2b4fb0-78ba-4b7b-9037-e4b26557403d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7dcd8650>]}
[0m14:18:12.248870 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 1.07s]
[0m14:18:12.251001 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:18:12.254687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:12.255962 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:18:12.257300 [info ] [MainThread]: 
[0m14:18:12.258756 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m14:18:12.261491 [debug] [MainThread]: Command end result
[0m14:18:12.290061 [info ] [MainThread]: 
[0m14:18:12.292212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:12.294124 [info ] [MainThread]: 
[0m14:18:12.295793 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 29 unexpected 'as'.
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:18:12.297395 [info ] [MainThread]: 
[0m14:18:12.299439 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:18:12.302001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5085797, "process_user_time": 2.903501, "process_kernel_time": 0.200934, "process_mem_max_rss": "132960", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:18:12.303389 [debug] [MainThread]: Command `dbt run` failed at 14:18:12.303207 after 4.51 seconds
[0m14:18:12.304830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7f1b1c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7f162710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a7dd33250>]}
[0m14:18:12.307058 [debug] [MainThread]: Flushing usage events
[0m14:19:24.783723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc7f7cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc9419690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc7f5aed0>]}


============================== 14:19:24.786238 | 9fa64b3c-0f0e-4595-b5aa-613b08deb3ed ==============================
[0m14:19:24.786238 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:19:24.788653 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run -s dim_customer', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:19:25.111179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc6f93b10>]}
[0m14:19:25.197746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc7fa1b90>]}
[0m14:19:25.199485 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:19:25.239796 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:19:26.006474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:26.007577 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:19:26.168123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc6e1ae10>]}
[0m14:19:26.197695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc6f65490>]}
[0m14:19:26.198671 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:19:26.200290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc7fb3bd0>]}
[0m14:19:26.202453 [info ] [MainThread]: 
[0m14:19:26.204522 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:26.206505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:19:26.224309 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:19:26.226244 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:19:26.228256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:27.163836 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:19:27.166561 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:19:27.411682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:19:27.422988 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:19:27.424212 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:19:27.425408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:28.053499 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:19:28.057471 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:19:28.266759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc7076e10>]}
[0m14:19:28.268520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:28.270032 [info ] [MainThread]: 
[0m14:19:28.273557 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:19:28.274959 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:19:28.276821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:19:28.278513 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:19:28.290807 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:19:28.302411 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:19:28.279629 => 14:19:28.301992
[0m14:19:28.303648 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:19:28.340814 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:19:28.351694 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:19:28.352868 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:19:28.354116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:28.992767 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3afdb-0000-000a-0000-00000f494c2d
[0m14:19:28.994482 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 28
invalid identifier 'CUSTOMERID'
[0m14:19:28.996339 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:19:28.304538 => 14:19:28.995999
[0m14:19:28.997841 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:19:29.206979 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:19:29.209121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fa64b3c-0f0e-4595-b5aa-613b08deb3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbcb694cd0>]}
[0m14:19:29.211025 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.93s]
[0m14:19:29.213294 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:19:29.218014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:29.219508 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:19:29.221235 [info ] [MainThread]: 
[0m14:19:29.222584 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m14:19:29.224717 [debug] [MainThread]: Command end result
[0m14:19:29.261670 [info ] [MainThread]: 
[0m14:19:29.263052 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:29.264847 [info ] [MainThread]: 
[0m14:19:29.266495 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 28
  invalid identifier 'CUSTOMERID'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:19:29.267776 [info ] [MainThread]: 
[0m14:19:29.269360 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:29.271405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5476227, "process_user_time": 2.872343, "process_kernel_time": 0.128317, "process_mem_max_rss": "132344", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:19:29.272990 [debug] [MainThread]: Command `dbt run` failed at 14:19:29.272753 after 4.55 seconds
[0m14:19:29.274554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbcc4f3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbcc4f32d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbc7f6ae90>]}
[0m14:19:29.276400 [debug] [MainThread]: Flushing usage events
[0m14:20:19.532362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576b067d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576b06f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576acd2d0>]}


============================== 14:20:19.535171 | 22b6881d-717e-49e4-8401-137f83e91e52 ==============================
[0m14:20:19.535171 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:20:19.536792 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run -s dim_customer', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'debug': 'False'}
[0m14:20:19.854587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd575a55450>]}
[0m14:20:19.940909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576af53d0>]}
[0m14:20:19.942575 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:20:19.978426 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:20:20.769310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:20.770512 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:20:20.937624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd575a1b4d0>]}
[0m14:20:20.967161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57581bd90>]}
[0m14:20:20.968182 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:20:20.969807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd575974550>]}
[0m14:20:20.972444 [info ] [MainThread]: 
[0m14:20:20.974386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:20.976479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:20:20.994599 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:20:20.996016 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:20:20.997587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:21.888958 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:20:21.891745 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:20:22.140122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:20:22.150487 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:20:22.151904 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:20:22.153235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:22.753456 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:20:22.756918 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:20:22.983576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd575650bd0>]}
[0m14:20:22.985329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:22.986900 [info ] [MainThread]: 
[0m14:20:22.991152 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:20:22.992592 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:20:22.994933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:20:22.996869 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:20:23.008768 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:20:22.998355 => 14:20:23.008406
[0m14:20:23.014872 [debug] [Thread-1 (]: Compilation Error in model dim_customer (models/transform/dim_customer.sql)
  's' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:20:23.016584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b6881d-717e-49e4-8401-137f83e91e52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd575676e50>]}
[0m14:20:23.018276 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.02s]
[0m14:20:23.020967 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:20:23.025800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:23.027202 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:20:23.028550 [info ] [MainThread]: 
[0m14:20:23.029796 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:20:23.031570 [debug] [MainThread]: Command end result
[0m14:20:23.114755 [info ] [MainThread]: 
[0m14:20:23.115921 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:20:23.117035 [info ] [MainThread]: 
[0m14:20:23.118130 [error] [MainThread]:   Compilation Error in model dim_customer (models/transform/dim_customer.sql)
  's' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:20:23.119134 [info ] [MainThread]: 
[0m14:20:23.120206 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:20:23.121733 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6495285, "process_user_time": 2.778416, "process_kernel_time": 0.161653, "process_mem_max_rss": "132332", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:20:23.123040 [debug] [MainThread]: Command `dbt run` failed at 14:20:23.122786 after 3.65 seconds
[0m14:20:23.124148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd577158450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd577158290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd57b0472d0>]}
[0m14:20:23.125292 [debug] [MainThread]: Flushing usage events
[0m14:20:54.556826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367ea77ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367ea75550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367ea74d10>]}


============================== 14:20:54.559412 | 1af9ccd3-e290-4e50-a14d-accb81e29a76 ==============================
[0m14:20:54.559412 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:20:54.561557 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt run -s dim_customer', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m14:20:54.886039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367db6eb10>]}
[0m14:20:54.975127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367eb29a50>]}
[0m14:20:54.976854 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:20:55.011278 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:20:55.816858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:55.817989 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:20:55.985085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367dacdb90>]}
[0m14:20:56.020692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d7d4310>]}
[0m14:20:56.021924 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:20:56.023507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d621010>]}
[0m14:20:56.025804 [info ] [MainThread]: 
[0m14:20:56.027695 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:56.029590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:20:56.045742 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:20:56.047479 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:20:56.049049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:56.967863 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:20:56.970310 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:20:57.218222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:20:57.235407 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:20:57.236833 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:20:57.238123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:58.004910 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:20:58.007896 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:20:58.221258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d9988d0>]}
[0m14:20:58.223100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:58.224583 [info ] [MainThread]: 
[0m14:20:58.228246 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:20:58.229891 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:20:58.231828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:20:58.233617 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:20:58.245312 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:20:58.234962 => 14:20:58.244777
[0m14:20:58.249274 [debug] [Thread-1 (]: Compilation Error in model dim_customer (models/transform/dim_customer.sql)
  's' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:20:58.250956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1af9ccd3-e290-4e50-a14d-accb81e29a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d63a590>]}
[0m14:20:58.253050 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.02s]
[0m14:20:58.255903 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:20:58.260599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:58.262094 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:20:58.263451 [info ] [MainThread]: 
[0m14:20:58.265329 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m14:20:58.267999 [debug] [MainThread]: Command end result
[0m14:20:58.354435 [info ] [MainThread]: 
[0m14:20:58.355556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:20:58.356714 [info ] [MainThread]: 
[0m14:20:58.357767 [error] [MainThread]:   Compilation Error in model dim_customer (models/transform/dim_customer.sql)
  's' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:20:58.358913 [info ] [MainThread]: 
[0m14:20:58.360058 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:20:58.361683 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8646064, "process_user_time": 2.728649, "process_kernel_time": 0.177955, "process_mem_max_rss": "132308", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:20:58.363023 [debug] [MainThread]: Command `dbt run` failed at 14:20:58.362815 after 3.87 seconds
[0m14:20:58.364088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d7efb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d7ed210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f367d7efd90>]}
[0m14:20:58.365086 [debug] [MainThread]: Flushing usage events
[0m14:21:41.440357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c053190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c019510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c053210>]}


============================== 14:21:41.443033 | 5450eab6-6295-4709-bc16-53fd0447e611 ==============================
[0m14:21:41.443033 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:21:41.445363 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run -s dim_customer', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True'}
[0m14:21:41.781049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c0576d0>]}
[0m14:21:41.888242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604b0ab250>]}
[0m14:21:41.889850 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:21:41.922728 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:21:42.759279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:42.760457 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:21:42.921495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604acd3510>]}
[0m14:21:42.952130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604ab94dd0>]}
[0m14:21:42.953205 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:21:42.954510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604aa47950>]}
[0m14:21:42.956830 [info ] [MainThread]: 
[0m14:21:42.958549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:42.960420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:21:42.978058 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:21:42.979668 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:21:42.981034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:43.816118 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:21:43.818796 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:21:44.056008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:21:44.067013 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:21:44.068487 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:21:44.069986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:44.782574 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:21:44.787233 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:21:45.003307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604aefe190>]}
[0m14:21:45.005243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:45.007135 [info ] [MainThread]: 
[0m14:21:45.011067 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:21:45.012618 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:21:45.015159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:21:45.017107 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:21:45.030283 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:21:45.039599 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:21:45.018273 => 14:21:45.039065
[0m14:21:45.041158 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:21:45.077993 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:21:45.089741 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:21:45.091165 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast("CustomerID" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:21:45.092495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:45.747790 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3afdd-0000-000a-0000-00000f494c39
[0m14:21:45.749775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 109
invalid identifier 'COUNTRY'
[0m14:21:45.751955 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:21:45.041971 => 14:21:45.751617
[0m14:21:45.753602 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:21:45.978553 [debug] [Thread-1 (]: Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 109
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:21:45.982539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5450eab6-6295-4709-bc16-53fd0447e611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604b0ebdd0>]}
[0m14:21:45.985926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model ASTRO_SDK_SCHEMA.dim_customer ............ [[31mERROR[0m in 0.97s]
[0m14:21:45.989365 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:21:45.994929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:45.996715 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:21:45.998568 [info ] [MainThread]: 
[0m14:21:46.000198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m14:21:46.002772 [debug] [MainThread]: Command end result
[0m14:21:46.030854 [info ] [MainThread]: 
[0m14:21:46.032119 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:21:46.033308 [info ] [MainThread]: 
[0m14:21:46.034495 [error] [MainThread]:   Database Error in model dim_customer (models/transform/dim_customer.sql)
  000904 (42000): SQL compilation error: error line 5 at position 109
  invalid identifier 'COUNTRY'
  compiled Code at target/run/retail/models/transform/dim_customer.sql
[0m14:21:46.035711 [info ] [MainThread]: 
[0m14:21:46.036816 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:21:46.038627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6610236, "process_user_time": 3.139122, "process_kernel_time": 0.161498, "process_mem_max_rss": "132576", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m14:21:46.039890 [debug] [MainThread]: Command `dbt run` failed at 14:21:46.039698 after 4.66 seconds
[0m14:21:46.041093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c6774d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c019510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c4b4450>]}
[0m14:21:46.042166 [debug] [MainThread]: Flushing usage events
[0m14:22:00.268707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f7c160d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f7c11090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f7c118d0>]}


============================== 14:22:00.271302 | c83db8b2-da5f-412d-a891-9bef75767ead ==============================
[0m14:22:00.271302 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:22:00.273411 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s dim_customer', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'write_json': 'True'}
[0m14:22:00.597467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f6bdad10>]}
[0m14:22:00.685652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f71394d0>]}
[0m14:22:00.687667 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:22:00.737321 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:22:01.495098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:01.496417 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_customer.sql
[0m14:22:01.668534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f6c5eed0>]}
[0m14:22:01.699976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f697cd90>]}
[0m14:22:01.701032 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:22:01.702834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f6677ad0>]}
[0m14:22:01.705497 [info ] [MainThread]: 
[0m14:22:01.707720 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:01.710014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:22:01.729142 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:22:01.730641 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:22:01.732203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:02.567645 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:22:02.570591 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:22:02.777838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:22:02.788379 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:22:02.789860 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:22:02.791215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:03.515185 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m14:22:03.525425 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:22:03.733555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fb32ccd0>]}
[0m14:22:03.735584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:03.737212 [info ] [MainThread]: 
[0m14:22:03.740703 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:22:03.742117 [info ] [Thread-1 (]: 1 of 1 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:22:03.744324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:22:03.746492 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:22:03.759493 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:22:03.771773 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:22:03.748273 => 14:22:03.771221
[0m14:22:03.773302 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:22:03.809928 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:22:03.821003 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:22:03.822239 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast("CustomerID" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("Country" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:22:03.823435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.552369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:22:05.578259 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:22:03.774130 => 14:22:05.577957
[0m14:22:05.579789 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:22:05.783197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c83db8b2-da5f-412d-a891-9bef75767ead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f6c0dad0>]}
[0m14:22:05.788487 [info ] [Thread-1 (]: 1 of 1 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.04s]
[0m14:22:05.794025 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:22:05.803602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:05.806589 [debug] [MainThread]: Connection 'model.retail.dim_customer' was properly closed.
[0m14:22:05.809289 [info ] [MainThread]: 
[0m14:22:05.811849 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m14:22:05.815050 [debug] [MainThread]: Command end result
[0m14:22:05.845326 [info ] [MainThread]: 
[0m14:22:05.847114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:05.848948 [info ] [MainThread]: 
[0m14:22:05.850367 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:22:05.852266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.638697, "process_user_time": 2.951976, "process_kernel_time": 0.175945, "process_mem_max_rss": "132128", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:22:05.853607 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:05.853355 after 5.64 seconds
[0m14:22:05.855161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33f7c13b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fc18b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33fc21f290>]}
[0m14:22:05.856116 [debug] [MainThread]: Flushing usage events
[0m14:45:23.610600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03559e5e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03559c7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03559c6fd0>]}


============================== 14:45:23.615016 | 3a8e5b92-aeba-4382-9101-cedd108ffe33 ==============================
[0m14:45:23.615016 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:45:23.617429 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /usr/local/airflow/include/dbt/'}
[0m14:45:24.168658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0356074950>]}
[0m14:45:24.398071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0355a4aa10>]}
[0m14:45:24.401103 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m14:45:24.463576 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:45:28.931906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:45:28.937333 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/dim_product.sql
[0m14:45:28.942672 [debug] [MainThread]: Partial parsing: updated file: retail://models/transform/fct_invoices.sql
[0m14:45:29.264379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03547af610>]}
[0m14:45:29.326379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03545b4f90>]}
[0m14:45:29.329075 [info ] [MainThread]: Found 6 models, 2 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m14:45:29.331307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0354b03890>]}
[0m14:45:29.335737 [info ] [MainThread]: 
[0m14:45:29.338386 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:29.342153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ASTRO_SDK_DB'
[0m14:45:29.373154 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB"
[0m14:45:29.376087 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB"} */
show terse schemas in database ASTRO_SDK_DB
    limit 10000
[0m14:45:29.378808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:30.505949 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m14:45:30.516490 [debug] [ThreadPool]: On list_ASTRO_SDK_DB: Close
[0m14:45:30.856234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB, now list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA)
[0m14:45:30.875256 [debug] [ThreadPool]: Using snowflake connection "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"
[0m14:45:30.877708 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "connection_name": "list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA"} */
show terse objects in ASTRO_SDK_DB.ASTRO_SDK_SCHEMA limit 10000
[0m14:45:30.879879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:31.715859 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m14:45:31.727270 [debug] [ThreadPool]: On list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA: Close
[0m14:45:31.963773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03548768d0>]}
[0m14:45:31.971254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:31.976411 [info ] [MainThread]: 
[0m14:45:31.992372 [debug] [Thread-1 (]: Began running node model.retail.dim_customer
[0m14:45:31.998578 [info ] [Thread-1 (]: 1 of 6 START sql table model ASTRO_SDK_SCHEMA.dim_customer ..................... [RUN]
[0m14:45:32.006568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ASTRO_SDK_DB_ASTRO_SDK_SCHEMA, now model.retail.dim_customer)
[0m14:45:32.013063 [debug] [Thread-1 (]: Began compiling node model.retail.dim_customer
[0m14:45:32.069438 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_customer"
[0m14:45:32.116436 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (compile): 14:45:32.019451 => 14:45:32.114788
[0m14:45:32.122339 [debug] [Thread-1 (]: Began executing node model.retail.dim_customer
[0m14:45:32.321177 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_customer"
[0m14:45:32.343699 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_customer"
[0m14:45:32.346379 [debug] [Thread-1 (]: On model.retail.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_customer"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer
         as
        (WITH customer_cte AS (
	SELECT DISTINCT
	    md5(cast(coalesce(cast("CustomerID" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("Country" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
	    "Country" AS country
	FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
	WHERE "CustomerID" IS NOT NULL
)
SELECT
    t.*,
	cm.iso
FROM customer_cte t
LEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename
        );
[0m14:45:32.349162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:33.828269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:45:33.933576 [debug] [Thread-1 (]: Timing info for model.retail.dim_customer (execute): 14:45:32.126884 => 14:45:33.932603
[0m14:45:33.937859 [debug] [Thread-1 (]: On model.retail.dim_customer: Close
[0m14:45:34.163622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03545fe750>]}
[0m14:45:34.170904 [info ] [Thread-1 (]: 1 of 6 OK created sql table model ASTRO_SDK_SCHEMA.dim_customer ................ [[32mSUCCESS 1[0m in 2.16s]
[0m14:45:34.179288 [debug] [Thread-1 (]: Finished running node model.retail.dim_customer
[0m14:45:34.186357 [debug] [Thread-1 (]: Began running node model.retail.dim_datetime
[0m14:45:34.192501 [info ] [Thread-1 (]: 2 of 6 START sql table model ASTRO_SDK_SCHEMA.dim_datetime ..................... [RUN]
[0m14:45:34.200231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_customer, now model.retail.dim_datetime)
[0m14:45:34.206177 [debug] [Thread-1 (]: Began compiling node model.retail.dim_datetime
[0m14:45:34.227448 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_datetime"
[0m14:45:34.274139 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (compile): 14:45:34.211133 => 14:45:34.272415
[0m14:45:34.279815 [debug] [Thread-1 (]: Began executing node model.retail.dim_datetime
[0m14:45:34.300966 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_datetime"
[0m14:45:34.352492 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_datetime"
[0m14:45:34.358451 [debug] [Thread-1 (]: On model.retail.dim_datetime: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_datetime"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime
         as
        (WITH datetime_cte AS (  
  SELECT DISTINCT
    "InvoiceDate" AS datetime_id,
    CASE
      WHEN LENGTH("InvoiceDate") = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        TO_TIMESTAMP("InvoiceDate", 'DD/MM/YYYY HH24:MI')
      WHEN LENGTH("InvoiceDate") <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        TO_TIMESTAMP("InvoiceDate", 'MM/DD/YY HH24:MI')
      ELSE
        NULL
    END AS date_part
  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
  WHERE "InvoiceDate" IS NOT NULL
)
SELECT
  datetime_id,
  date_part as datetime,
  EXTRACT(YEAR FROM date_part) AS year,
  EXTRACT(MONTH FROM date_part) AS month,
  EXTRACT(DAY FROM date_part) AS day,
  EXTRACT(HOUR FROM date_part) AS hour,
  EXTRACT(MINUTE FROM date_part) AS minute,
  EXTRACT(DAYOFWEEK FROM date_part) AS weekday
FROM datetime_cte
        );
[0m14:45:34.364524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:35.671160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:45:35.689081 [debug] [Thread-1 (]: Timing info for model.retail.dim_datetime (execute): 14:45:34.284872 => 14:45:35.687517
[0m14:45:35.695592 [debug] [Thread-1 (]: On model.retail.dim_datetime: Close
[0m14:45:35.927454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03548fd150>]}
[0m14:45:35.935221 [info ] [Thread-1 (]: 2 of 6 OK created sql table model ASTRO_SDK_SCHEMA.dim_datetime ................ [[32mSUCCESS 1[0m in 1.73s]
[0m14:45:35.943323 [debug] [Thread-1 (]: Finished running node model.retail.dim_datetime
[0m14:45:35.950105 [debug] [Thread-1 (]: Began running node model.retail.dim_product
[0m14:45:35.956944 [info ] [Thread-1 (]: 3 of 6 START sql table model ASTRO_SDK_SCHEMA.dim_product ...................... [RUN]
[0m14:45:35.965671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_datetime, now model.retail.dim_product)
[0m14:45:35.971598 [debug] [Thread-1 (]: Began compiling node model.retail.dim_product
[0m14:45:36.005476 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.dim_product"
[0m14:45:36.053425 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (compile): 14:45:35.977221 => 14:45:36.051773
[0m14:45:36.059199 [debug] [Thread-1 (]: Began executing node model.retail.dim_product
[0m14:45:36.079441 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.dim_product"
[0m14:45:36.127680 [debug] [Thread-1 (]: Using snowflake connection "model.retail.dim_product"
[0m14:45:36.134015 [debug] [Thread-1 (]: On model.retail.dim_product: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.dim_product"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product
         as
        (SELECT DISTINCT
    md5(cast(coalesce(cast("StockCode" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("Description" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("UnitPrice" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
		"StockCode" AS stock_code,
    "Description" AS description,
    "UnitPrice" AS price
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
WHERE "StockCode" IS NOT NULL
AND "UnitPrice" > 0
        );
[0m14:45:36.140841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:37.927755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:45:37.946536 [debug] [Thread-1 (]: Timing info for model.retail.dim_product (execute): 14:45:36.063959 => 14:45:37.944812
[0m14:45:37.952848 [debug] [Thread-1 (]: On model.retail.dim_product: Close
[0m14:45:38.190786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0354a96f50>]}
[0m14:45:38.197389 [info ] [Thread-1 (]: 3 of 6 OK created sql table model ASTRO_SDK_SCHEMA.dim_product ................. [[32mSUCCESS 1[0m in 2.23s]
[0m14:45:38.204619 [debug] [Thread-1 (]: Finished running node model.retail.dim_product
[0m14:45:38.213841 [debug] [Thread-1 (]: Began running node model.retail.fct_invoices
[0m14:45:38.220303 [info ] [Thread-1 (]: 4 of 6 START sql table model ASTRO_SDK_SCHEMA.fct_invoices ..................... [RUN]
[0m14:45:38.228596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.dim_product, now model.retail.fct_invoices)
[0m14:45:38.234341 [debug] [Thread-1 (]: Began compiling node model.retail.fct_invoices
[0m14:45:38.281408 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.fct_invoices"
[0m14:45:38.327442 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (compile): 14:45:38.238565 => 14:45:38.325761
[0m14:45:38.332883 [debug] [Thread-1 (]: Began executing node model.retail.fct_invoices
[0m14:45:38.353035 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.fct_invoices"
[0m14:45:38.404284 [debug] [Thread-1 (]: Using snowflake connection "model.retail.fct_invoices"
[0m14:45:38.410626 [debug] [Thread-1 (]: On model.retail.fct_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.fct_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices
         as
        (WITH fct_invoices_cte AS (
    SELECT
        "InvoiceNo" AS invoice_id,
        "InvoiceDate" AS datetime_id,
        md5(cast(coalesce(cast("StockCode" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("Description" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("UnitPrice" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,
        md5(cast(coalesce(cast("CustomerID" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast("Country" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,
        "Quantity" AS quantity,
        "Quantity" * "UnitPrice" AS total
    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices
    WHERE "Quantity" > 0
)
SELECT
    invoice_id,
    dt.datetime_id,
    dp.product_id,
    dc.customer_id,
    quantity,
    total
FROM fct_invoices_cte fi
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id
INNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id
        );
[0m14:45:38.416664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:40.279602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:45:40.298102 [debug] [Thread-1 (]: Timing info for model.retail.fct_invoices (execute): 14:45:38.337584 => 14:45:40.296607
[0m14:45:40.304297 [debug] [Thread-1 (]: On model.retail.fct_invoices: Close
[0m14:45:40.546578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0354353310>]}
[0m14:45:40.553025 [info ] [Thread-1 (]: 4 of 6 OK created sql table model ASTRO_SDK_SCHEMA.fct_invoices ................ [[32mSUCCESS 1[0m in 2.32s]
[0m14:45:40.560864 [debug] [Thread-1 (]: Finished running node model.retail.fct_invoices
[0m14:45:40.570129 [debug] [Thread-1 (]: Began running node model.retail.report_customer_invoices
[0m14:45:40.576233 [info ] [Thread-1 (]: 5 of 6 START sql table model ASTRO_SDK_SCHEMA.report_customer_invoices ......... [RUN]
[0m14:45:40.585726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.fct_invoices, now model.retail.report_customer_invoices)
[0m14:45:40.591950 [debug] [Thread-1 (]: Began compiling node model.retail.report_customer_invoices
[0m14:45:40.617710 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_customer_invoices"
[0m14:45:40.663316 [debug] [Thread-1 (]: Timing info for model.retail.report_customer_invoices (compile): 14:45:40.596681 => 14:45:40.661615
[0m14:45:40.668904 [debug] [Thread-1 (]: Began executing node model.retail.report_customer_invoices
[0m14:45:40.691516 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_customer_invoices"
[0m14:45:40.740525 [debug] [Thread-1 (]: Using snowflake connection "model.retail.report_customer_invoices"
[0m14:45:40.746608 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_customer_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_customer_invoices
         as
        (SELECT
  c.country,
  c.iso,
  COUNT(fi.invoice_id) AS total_invoices,
  SUM(fi.total) AS total_revenue
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi
JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer c ON fi.customer_id = c.customer_id
GROUP BY c.country, c.iso
ORDER BY total_revenue DESC
LIMIT 10
        );
[0m14:45:40.751365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:42.272139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:45:42.290102 [debug] [Thread-1 (]: Timing info for model.retail.report_customer_invoices (execute): 14:45:40.675066 => 14:45:42.287971
[0m14:45:42.296733 [debug] [Thread-1 (]: On model.retail.report_customer_invoices: Close
[0m14:45:42.525837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03547d3b90>]}
[0m14:45:42.532797 [info ] [Thread-1 (]: 5 of 6 OK created sql table model ASTRO_SDK_SCHEMA.report_customer_invoices .... [[32mSUCCESS 1[0m in 1.94s]
[0m14:45:42.540217 [debug] [Thread-1 (]: Finished running node model.retail.report_customer_invoices
[0m14:45:42.546444 [debug] [Thread-1 (]: Began running node model.retail.report_year_invoices
[0m14:45:42.552110 [info ] [Thread-1 (]: 6 of 6 START sql table model ASTRO_SDK_SCHEMA.report_year_invoices ............. [RUN]
[0m14:45:42.559536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail.report_customer_invoices, now model.retail.report_year_invoices)
[0m14:45:42.565011 [debug] [Thread-1 (]: Began compiling node model.retail.report_year_invoices
[0m14:45:42.585826 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail.report_year_invoices"
[0m14:45:42.632732 [debug] [Thread-1 (]: Timing info for model.retail.report_year_invoices (compile): 14:45:42.569830 => 14:45:42.631036
[0m14:45:42.638379 [debug] [Thread-1 (]: Began executing node model.retail.report_year_invoices
[0m14:45:42.658561 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail.report_year_invoices"
[0m14:45:42.706484 [debug] [Thread-1 (]: Using snowflake connection "model.retail.report_year_invoices"
[0m14:45:42.712321 [debug] [Thread-1 (]: On model.retail.report_year_invoices: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "retail", "target_name": "dev", "node_id": "model.retail.report_year_invoices"} */
create or replace transient table ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_year_invoices
         as
        (SELECT
  dt.year,
  dt.month,
  COUNT(DISTINCT fi.invoice_id) AS num_invoices,
  SUM(fi.total) AS total_revenue
FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi
JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id
GROUP BY dt.year, dt.month
ORDER BY dt.year, dt.month
        );
[0m14:45:42.718391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:45.091519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:45:45.103056 [debug] [Thread-1 (]: Timing info for model.retail.report_year_invoices (execute): 14:45:42.643087 => 14:45:45.102028
[0m14:45:45.106960 [debug] [Thread-1 (]: On model.retail.report_year_invoices: Close
[0m14:45:45.494722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a8e5b92-aeba-4382-9101-cedd108ffe33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0354877950>]}
[0m14:45:45.498840 [info ] [Thread-1 (]: 6 of 6 OK created sql table model ASTRO_SDK_SCHEMA.report_year_invoices ........ [[32mSUCCESS 1[0m in 2.94s]
[0m14:45:45.503440 [debug] [Thread-1 (]: Finished running node model.retail.report_year_invoices
[0m14:45:45.511308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:45.514474 [debug] [MainThread]: Connection 'model.retail.report_year_invoices' was properly closed.
[0m14:45:45.517726 [info ] [MainThread]: 
[0m14:45:45.521074 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 16.18 seconds (16.18s).
[0m14:45:45.528664 [debug] [MainThread]: Command end result
[0m14:45:45.584470 [info ] [MainThread]: 
[0m14:45:45.586833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:45.588963 [info ] [MainThread]: 
[0m14:45:45.591164 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m14:45:45.594645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.13284, "process_user_time": 6.581169, "process_kernel_time": 0.507023, "process_mem_max_rss": "131968", "process_out_blocks": "8", "process_in_blocks": "0"}
[0m14:45:45.597533 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:45.597142 after 22.14 seconds
[0m14:45:45.599941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f035a009010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0359ff7210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03559d42d0>]}
[0m14:45:45.602336 [debug] [MainThread]: Flushing usage events
