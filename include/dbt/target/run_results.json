{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2024-04-15T14:45:45.524090Z", "invocation_id": "3a8e5b92-aeba-4382-9101-cedd108ffe33", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-15T14:45:32.019451Z", "completed_at": "2024-04-15T14:45:32.114788Z"}, {"name": "execute", "started_at": "2024-04-15T14:45:32.126884Z", "completed_at": "2024-04-15T14:45:33.932603Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.158475637435913, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3aff5-0000-000a-0000-00000f494ce5"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.retail.dim_customer", "compiled": true, "compiled_code": "WITH customer_cte AS (\n\tSELECT DISTINCT\n\t    md5(cast(coalesce(cast(\"CustomerID\" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"Country\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,\n\t    \"Country\" AS country\n\tFROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices\n\tWHERE \"CustomerID\" IS NOT NULL\n)\nSELECT\n    t.*,\n\tcm.iso\nFROM customer_cte t\nLEFT JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.country cm ON t.country = cm.nicename", "relation_name": "ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-15T14:45:34.211133Z", "completed_at": "2024-04-15T14:45:34.272415Z"}, {"name": "execute", "started_at": "2024-04-15T14:45:34.284872Z", "completed_at": "2024-04-15T14:45:35.687517Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7282109260559082, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3aff5-0000-000a-0000-00000f494ce9"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.retail.dim_datetime", "compiled": true, "compiled_code": "WITH datetime_cte AS (  \n  SELECT DISTINCT\n    \"InvoiceDate\" AS datetime_id,\n    CASE\n      WHEN LENGTH(\"InvoiceDate\") = 16 THEN\n        -- Date format: \"DD/MM/YYYY HH:MM\"\n        TO_TIMESTAMP(\"InvoiceDate\", 'DD/MM/YYYY HH24:MI')\n      WHEN LENGTH(\"InvoiceDate\") <= 14 THEN\n        -- Date format: \"MM/DD/YY HH:MM\"\n        TO_TIMESTAMP(\"InvoiceDate\", 'MM/DD/YY HH24:MI')\n      ELSE\n        NULL\n    END AS date_part\n  FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices\n  WHERE \"InvoiceDate\" IS NOT NULL\n)\nSELECT\n  datetime_id,\n  date_part as datetime,\n  EXTRACT(YEAR FROM date_part) AS year,\n  EXTRACT(MONTH FROM date_part) AS month,\n  EXTRACT(DAY FROM date_part) AS day,\n  EXTRACT(HOUR FROM date_part) AS hour,\n  EXTRACT(MINUTE FROM date_part) AS minute,\n  EXTRACT(DAYOFWEEK FROM date_part) AS weekday\nFROM datetime_cte", "relation_name": "ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-15T14:45:35.977221Z", "completed_at": "2024-04-15T14:45:36.051773Z"}, {"name": "execute", "started_at": "2024-04-15T14:45:36.063959Z", "completed_at": "2024-04-15T14:45:37.944812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.227525234222412, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3aff5-0000-000f-0000-00000f495c1d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.retail.dim_product", "compiled": true, "compiled_code": "SELECT DISTINCT\n    md5(cast(coalesce(cast(\"StockCode\" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"Description\" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"UnitPrice\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n\t\t\"StockCode\" AS stock_code,\n    \"Description\" AS description,\n    \"UnitPrice\" AS price\nFROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices\nWHERE \"StockCode\" IS NOT NULL\nAND \"UnitPrice\" > 0", "relation_name": "ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-15T14:45:38.238565Z", "completed_at": "2024-04-15T14:45:38.325761Z"}, {"name": "execute", "started_at": "2024-04-15T14:45:38.337584Z", "completed_at": "2024-04-15T14:45:40.296607Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.319634199142456, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3aff5-0000-000a-0000-00000f494ced"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.retail.fct_invoices", "compiled": true, "compiled_code": "WITH fct_invoices_cte AS (\n    SELECT\n        \"InvoiceNo\" AS invoice_id,\n        \"InvoiceDate\" AS datetime_id,\n        md5(cast(coalesce(cast(\"StockCode\" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"Description\" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"UnitPrice\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_id,\n        md5(cast(coalesce(cast(\"CustomerID\" as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(\"Country\" as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_id,\n        \"Quantity\" AS quantity,\n        \"Quantity\" * \"UnitPrice\" AS total\n    FROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.raw_invoices\n    WHERE \"Quantity\" > 0\n)\nSELECT\n    invoice_id,\n    dt.datetime_id,\n    dp.product_id,\n    dc.customer_id,\n    quantity,\n    total\nFROM fct_invoices_cte fi\nINNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id\nINNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_product dp ON fi.product_id = dp.product_id\nINNER JOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer dc ON fi.customer_id = dc.customer_id", "relation_name": "ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-15T14:45:40.596681Z", "completed_at": "2024-04-15T14:45:40.661615Z"}, {"name": "execute", "started_at": "2024-04-15T14:45:40.675066Z", "completed_at": "2024-04-15T14:45:42.287971Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.942331075668335, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3aff5-0000-000a-0000-00000f494cf1"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.retail.report_customer_invoices", "compiled": true, "compiled_code": "SELECT\n  c.country,\n  c.iso,\n  COUNT(fi.invoice_id) AS total_invoices,\n  SUM(fi.total) AS total_revenue\nFROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi\nJOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_customer c ON fi.customer_id = c.customer_id\nGROUP BY c.country, c.iso\nORDER BY total_revenue DESC\nLIMIT 10", "relation_name": "ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_customer_invoices"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-15T14:45:42.569830Z", "completed_at": "2024-04-15T14:45:42.631036Z"}, {"name": "execute", "started_at": "2024-04-15T14:45:42.643087Z", "completed_at": "2024-04-15T14:45:45.102028Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.937039852142334, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b3aff5-0000-000f-0000-00000f495c21"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.retail.report_year_invoices", "compiled": true, "compiled_code": "SELECT\n  dt.year,\n  dt.month,\n  COUNT(DISTINCT fi.invoice_id) AS num_invoices,\n  SUM(fi.total) AS total_revenue\nFROM ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.fct_invoices fi\nJOIN ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.dim_datetime dt ON fi.datetime_id = dt.datetime_id\nGROUP BY dt.year, dt.month\nORDER BY dt.year, dt.month", "relation_name": "ASTRO_SDK_DB.ASTRO_SDK_SCHEMA.report_year_invoices"}], "elapsed_time": 16.179935932159424, "args": {"log_level": "info", "send_anonymous_usage_stats": true, "enable_legacy_logger": false, "log_level_file": "debug", "log_file_max_bytes": 10485760, "strict_mode": false, "warn_error_options": {"include": [], "exclude": []}, "vars": {}, "macro_debugging": false, "populate_cache": true, "partial_parse": true, "log_format_file": "debug", "introspect": true, "version_check": true, "write_json": true, "profiles_dir": "/usr/local/airflow/include/dbt/", "use_colors": true, "exclude": [], "indirect_selection": "eager", "static_parser": true, "select": [], "defer": false, "cache_selected_only": false, "log_format": "default", "use_colors_file": true, "which": "run", "quiet": false, "log_path": "/usr/local/airflow/include/dbt/logs", "printer_width": 80, "show_resource_report": false, "favor_state": false, "partial_parse_file_diff": true, "print": true, "invocation_command": "dbt run --profiles-dir /usr/local/airflow/include/dbt/", "project_dir": "/usr/local/airflow/include/dbt"}}